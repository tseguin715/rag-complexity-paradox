<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Trevor Seguin">
<meta name="dcterms.date" content="2026-01-05">
<meta name="keywords" content="RAG, retrieval-augmented generation, agentic RAG, RAG evaluation, reranking, cross-encoder reranker, query rewriting, document grading, hybrid search, vector search, embeddings, recall@k, MRR, pareto frontier, latency, token cost, quantization, 2-bit quantization, 4-bit quantization, local LLM, LLMOps">
<meta name="description" content="After evaluating 96 RAG configurations across 4 architectures, 6 LLMs, and 4 embedding models on a 100-question TMDB benchmark, there seems to be no reliable improvement from highly complex agentic systems. The top configurations clustered around ~70% correctness (the practical ceiling for the testing conditions), and several very different configurations tie for best. Moderate agentic control (System C: query rewriting + doc grading) consistently lands on the efficiency frontier of latency and accuracy (e.g.&nbsp;~70% at 1s with GPT-4o + OpenAI-large embeddings). The most complex architecture – System D God Mode – can achieve high performance in correctness and retrieval recall, but turned out to be especially brittle with heavily-quantized models. A follow-up study of God Mode degradation for 2-bit compression showed it’s model dependent: Qwen 32B appears to show no substantial degradation from 4-bit to 2-bit, while Llama 3.1 70B degrades much more. All code + raw outputs are in the repo (link).">

<title>The RAG Complexity Paradox</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="index_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-813c323200a87c37e262811031999de4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="index_files/libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="index_files/libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="index_files/libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<style>html{ scroll-behavior: smooth; }</style>
<script src="index_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="index_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="index_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script defer="" src="https://cloud.umami.is/script.js" data-website-id="915382e1-9b49-4bc2-848d-365a7baba5b7"></script>
<style>
  /* Force tables to scroll on mobile instead of squishing */
  .cell-output-display {
    overflow-x: auto;
    display: block;
  }
  /* Ensure Plotly charts take full width */
  .plotly-graph-div {
    width: 100% !important;
  }
</style>


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-this-is" id="toc-what-this-is" class="nav-link active" data-scroll-target="#what-this-is">What this is</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions">Questions</a></li>
  <li><a href="#rag-architectures" id="toc-rag-architectures" class="nav-link" data-scroll-target="#rag-architectures">RAG Architectures</a></li>
  <li><a href="#llms" id="toc-llms" class="nav-link" data-scroll-target="#llms">LLMs</a></li>
  <li><a href="#embeddings" id="toc-embeddings" class="nav-link" data-scroll-target="#embeddings">Embeddings</a></li>
  <li><a href="#llm-as-judge-scoring" id="toc-llm-as-judge-scoring" class="nav-link" data-scroll-target="#llm-as-judge-scoring">LLM-as-judge scoring</a></li>
  </ul></li>
  <li><a href="#results-and-discussion" id="toc-results-and-discussion" class="nav-link" data-scroll-target="#results-and-discussion">Results and Discussion</a>
  <ul class="collapse">
  <li><a href="#top-configurations" id="toc-top-configurations" class="nav-link" data-scroll-target="#top-configurations">Top Configurations</a></li>
  <li><a href="#correctness-cost-and-latency" id="toc-correctness-cost-and-latency" class="nav-link" data-scroll-target="#correctness-cost-and-latency">Correctness, Cost, and Latency</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  </ul>
</nav>
</div>
<main class="content page-columns page-full column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">The RAG Complexity Paradox</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Why 20× more spend didn’t beat a ~70% ceiling</p>
</div>

<div>
  <div class="description">
    After evaluating 96 RAG configurations across 4 architectures, 6 LLMs, and 4 embedding models on a 100-question TMDB benchmark, there seems to be no reliable improvement from highly complex agentic systems. The top configurations clustered around ~70% correctness (the practical ceiling for the testing conditions), and several very different configurations tie for best. Moderate agentic control (System C: query rewriting + doc grading) consistently lands on the efficiency frontier of latency and accuracy (e.g.&nbsp;~70% at 1s with GPT-4o + OpenAI-large embeddings). The most complex architecture – System D God Mode – can achieve high performance in correctness and retrieval recall, but turned out to be especially brittle with heavily-quantized models. A follow-up study of God Mode degradation for 2-bit compression showed it’s model dependent: Qwen 32B appears to show no substantial degradation from 4-bit to 2-bit, while Llama 3.1 70B degrades much more. All code + raw outputs are in the repo (link).
  </div>
</div>


<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Trevor Seguin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 5, 2026</p>
    </div>
  </div>
  
    
  </div>
  

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>RAG, retrieval-augmented generation, agentic RAG, RAG evaluation, reranking, cross-encoder reranker, query rewriting, document grading, hybrid search, vector search, embeddings, recall@k, MRR, pareto frontier, latency, token cost, quantization, 2-bit quantization, 4-bit quantization, local LLM, LLMOps</p>
  </div>
</div>

</header>


<p><a href="abstract_long.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="abstract_long.png" class="img-fluid" style="width:100.0%"></a></p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key takeaways (for builders)
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Complexity does not necessarily equal accuracy</strong>: Top configs cluster around ~70% correctness, with no improvement from the most complex pipelines.</li>
<li><strong>Cost gap is real</strong>: Lack of substantial improvement from highly complex RAG architecture despite a 20x increase in compute and tokens.</li>
<li><strong>System C is the sweet spot</strong>: Moderate agentic workflows (grading + rewriting) sit right on the efficiency frontier for latency, cost and accuracy.</li>
<li><strong>Complex pipelines amplify model weakness.</strong>: Heavy reranking in “God Mode” (System D) caused degradation in aggressively quantized models.</li>
</ul>
</div>
</div>
<section id="what-this-is" class="level1">
<h1>What this is</h1>
<p>96 RAG configurations were benchmarked on a fixed TMDB QA task to understand how architecture complexity affects correctness, latency, and cost. The focus was practical tradeoffs and failure modes that could occur in real RAG pipelines.</p>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Retrieval Augmented Generation (RAG) has been a standard in external data retrieval for LLMs since approximately the early 2020s. The approach was popularized by Lewis et al.&nbsp;in 2020 and has since been widely adopted in both research and production environments. NotebookLM is perhaps a well-known example: uploaded documents are converted to a vector database as embeddings, and a numerical representation of the user’s query is checked against the embeddings for the closest match for retrieval and generation. Other examples are Perplexity, ChatGPT’s document and browsing features, and GitHub Copilot Chat with repository indexing.</p>
<p>The process of equipping an LLM with knowledge outside of its training data is an ongoing area of research. There are many failure points in the process; for example – what is the retrieval method? How are the documents encoded? How many documents should be retrieved? And then, once implemented – how well does it perform? What’s the quality of the responses? How fast is it? Can it be applied at scale?</p>
<p>An understandable expectation is that RAG should improve when “agentic” systems enter the picture. Surprisingly, this intuition does not always hold. In this study, we observe cases where additional layers of complexity – including iterative retrieval, grading, and query rewriting – can degrade overall system performance, particularly for smaller or aggressively quantized models.</p>
<p>About “agentic” RAG: when you think about it, it might sound a little silly. Why does a LLM need to tell itself how to retrieve information? The simplest form of RAG – a single-pass lookup of documents based on semantic similarity to the input query – performs well in some contexts, but faces limitations when complex reasoning is required. These include scenarios requiring filtering, aggregation, or query reformulation; ‘multi-hop’ reasoning (connecting multiple documents with disparate semantic meanings); or cases where a wider understanding of the corpus is necessary. “Agentic” systems attempt to address these situations by involving LLMs in additional steps of the retrieval process. For example – a LLM might take a user query and ask: does this need to be rewritten to fit the context of the chat history? Does it need to be rewritten to be more “compatible” with the database embeddings? And then: are the retrieved documents actually relevant?</p>
<p>This study aims to be a small investigation in the usability of several modern LLMs and embedding models – including popular commercial offerings as well as some smaller, open-source models – in different RAG architectures for retrieval of data for TV and movies. We study structured question answering over a fixed corpus of movie and television data, including titles, metadata, and short plot descriptions. The question consists of simple factual lookups, filtering, aggregation, and multi-hop reasoning. System performance is evaluated in several metrics: retrieval quality (e.g., recall and MRR), answer correctness and faithfulness as judged by a reference LLM, and overall latency. The scope of RAG systems for this study includes simple “naive” RAG and a number of “agentic” systems of increasing complexity. The intent is to find how RAG systems of different complexity interact with model size and architecture in controlled settings to find guidelines for production-scale deployment.</p>
<p>Part of the motivation for this study came from my discovery of a 70B model – Llama 3.1 70B-IQ2 – that could run entirely on my RTX 4090(!). In the local LLM “world”, it seemed to be kind of an informal benchmark to be able to run a 70b model in home hardware (without CPU offloading). However, the lowest commonly accepted quantization for anything useful seems to be 4-bit. The 4-bit quant of Llama 3.1 70b requires about ~40gb of RAM, so even a video card like the RTX 4090 can’t hold it without offloading to the CPU and tanking inference speed. After loading up Llama 3.1 70B-IQ2 in Ollama recently, I was excited to see it running at about 50 tokens/second, which is very useable. However, while this was all well and good, it raised an obvious question: what is the hidden cost of such an aggressive quantization? This study aimed to find out whether this and other inexpensive models can be used as more than a “toy” or proof-of-concept, while throwing some high-quality commercial models into the fray for comparison.</p>
</section>
<section id="methods" class="level1 page-columns page-full">
<h1>Methods</h1>
<section id="questions" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="questions">Questions</h3>
<p>Data was extracted from tmdb.org to create 136,788 documents of TV shows and movies released from 1980 to 2025, whose main text was a brief description of the TV show or movie; and metadata for year, rating, votes, genre, language, popularity, and type (TV or movie) were included.</p>
<p>100 questions (the ‘Gold’ set) were written to test different reasoning and retrieval mechanisms. The question types fell into the following categories:</p>
<div id="7eea778a" class="cell page-columns page-full" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>df_data <span class="op">=</span> {<span class="st">'Question Type'</span>: {<span class="dv">0</span>: <span class="st">'descriptive'</span>, <span class="dv">1</span>: <span class="st">'factual'</span>, <span class="dv">2</span>: <span class="st">'unanswerable'</span>, <span class="dv">3</span>: <span class="st">'multi_hop'</span>, <span class="dv">4</span>: <span class="st">'filter'</span>, <span class="dv">5</span>: <span class="st">'contextual'</span>}, <span class="st">'Count'</span>: {<span class="dv">0</span>: <span class="dv">29</span>, <span class="dv">1</span>: <span class="dv">25</span>, <span class="dv">2</span>: <span class="dv">20</span>, <span class="dv">3</span>: <span class="dv">10</span>, <span class="dv">4</span>: <span class="dv">9</span>, <span class="dv">5</span>: <span class="dv">7</span>}}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Recreate the DataFrame</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>type_counts <span class="op">=</span> pd.DataFrame.from_dict(df_data, orient<span class="op">=</span><span class="st">'columns'</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Seaborn 'Deep' Palette Hex Codes manually</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>seaborn_deep <span class="op">=</span> [</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#4C72B0'</span>, <span class="co"># Blue</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#DD8452'</span>, <span class="co"># Orange</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#55A868'</span>, <span class="co"># Green</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#C44E52'</span>, <span class="co"># Red</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#8172B3'</span>, <span class="co"># Purple</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#937860'</span>, <span class="co"># Brown</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#DA8BC3'</span>, <span class="co"># Pink</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#8C8C8C'</span>, <span class="co"># Gray</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#CCB974'</span>, <span class="co"># Yellow</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#64B5CD'</span>  <span class="co"># Cyan</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>fig_dist <span class="op">=</span> px.bar(</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    type_counts, </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'Question Type'</span>, </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Count'</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">'Count'</span>,</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'Question Type'</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    color_discrete_sequence<span class="op">=</span>seaborn_deep</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>fig_dist.update_traces(textposition<span class="op">=</span><span class="st">'outside'</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>fig_dist.update_layout(</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"Correctness Score"</span>,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">10</span>),</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"bottom"</span>,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="fl">1.02</span>,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"right"</span>,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="dv">1</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>fig_dist.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display column-screen-inset">
        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        </script>
        <script type="module">import "https://cdn.plot.ly/plotly-3.3.0.min"</script>
        
</div>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="7656a420-1494-4e66-a668-39ad84f6641b" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("7656a420-1494-4e66-a668-39ad84f6641b")) {                    Plotly.newPlot(                        "7656a420-1494-4e66-a668-39ad84f6641b",                        [{"hovertemplate":"Question Type=%{x}\u003cbr\u003eCount=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"descriptive","marker":{"color":"#4C72B0","pattern":{"shape":""}},"name":"descriptive","orientation":"v","showlegend":true,"text":{"dtype":"f8","bdata":"AAAAAAAAPUA="},"textposition":"outside","x":["descriptive"],"xaxis":"x","y":{"dtype":"i1","bdata":"HQ=="},"yaxis":"y","type":"bar"},{"hovertemplate":"Question Type=%{x}\u003cbr\u003eCount=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"factual","marker":{"color":"#DD8452","pattern":{"shape":""}},"name":"factual","orientation":"v","showlegend":true,"text":{"dtype":"f8","bdata":"AAAAAAAAOUA="},"textposition":"outside","x":["factual"],"xaxis":"x","y":{"dtype":"i1","bdata":"GQ=="},"yaxis":"y","type":"bar"},{"hovertemplate":"Question Type=%{x}\u003cbr\u003eCount=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"unanswerable","marker":{"color":"#55A868","pattern":{"shape":""}},"name":"unanswerable","orientation":"v","showlegend":true,"text":{"dtype":"f8","bdata":"AAAAAAAANEA="},"textposition":"outside","x":["unanswerable"],"xaxis":"x","y":{"dtype":"i1","bdata":"FA=="},"yaxis":"y","type":"bar"},{"hovertemplate":"Question Type=%{x}\u003cbr\u003eCount=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"multi_hop","marker":{"color":"#C44E52","pattern":{"shape":""}},"name":"multi_hop","orientation":"v","showlegend":true,"text":{"dtype":"f8","bdata":"AAAAAAAAJEA="},"textposition":"outside","x":["multi_hop"],"xaxis":"x","y":{"dtype":"i1","bdata":"Cg=="},"yaxis":"y","type":"bar"},{"hovertemplate":"Question Type=%{x}\u003cbr\u003eCount=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"filter","marker":{"color":"#8172B3","pattern":{"shape":""}},"name":"filter","orientation":"v","showlegend":true,"text":{"dtype":"f8","bdata":"AAAAAAAAIkA="},"textposition":"outside","x":["filter"],"xaxis":"x","y":{"dtype":"i1","bdata":"CQ=="},"yaxis":"y","type":"bar"},{"hovertemplate":"Question Type=%{x}\u003cbr\u003eCount=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"contextual","marker":{"color":"#937860","pattern":{"shape":""}},"name":"contextual","orientation":"v","showlegend":true,"text":{"dtype":"f8","bdata":"AAAAAAAAHEA="},"textposition":"outside","x":["contextual"],"xaxis":"x","y":{"dtype":"i1","bdata":"Bw=="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":""},"categoryorder":"array","categoryarray":["descriptive","factual","unanswerable","multi_hop","filter","contextual"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Correctness Score"}},"legend":{"title":{"text":"Question Type"},"tracegroupgap":0,"orientation":"h","yanchor":"bottom","y":1.02,"xanchor":"right","x":1},"barmode":"relative","margin":{"l":10,"r":10,"t":30,"b":10},"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('7656a420-1494-4e66-a668-39ad84f6641b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 1</strong>. Distribution of question types in the 100-question evaluation set.</p>
</div>
<p>Some examples of each category were:</p>
<div id="3a986e70" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itables <span class="im">import</span> show</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Prepare Data</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>sample_questions <span class="op">=</span> [</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Category'</span>: <span class="st">'Factual'</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Question'</span>: <span class="st">'What is the rating of "Bluefin"?'</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gold Answer'</span>: <span class="st">'7.2'</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Why It's Challenging"</span>: <span class="st">'Simple lookup - tests basic retrieval'</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Category'</span>: <span class="st">'Descriptive'</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Question'</span>: <span class="st">'In Sweet Trap (2024), the apprentice falls into whose trap?'</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gold Answer'</span>: <span class="st">'Jiang Jie'</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Why It's Challenging"</span>: <span class="st">'Requires finding specific plot details'</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Category'</span>: <span class="st">'Filter'</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Question'</span>: <span class="st">'How many movies in 2025 allude to the holocaust?'</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gold Answer'</span>: <span class="st">'2'</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Why It's Challenging"</span>: <span class="st">'Needs metadata filtering + counting'</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Category'</span>: <span class="st">'Multi-hop'</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Question'</span>: <span class="st">'What is the 4th oldest Star Wars movie?'</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gold Answer'</span>: <span class="st">'Star Wars: Droids - The Great Heep'</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Why It's Challenging"</span>: <span class="st">'Requires sorting then selecting nth item'</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Category'</span>: <span class="st">'Contextual'</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Question'</span>: <span class="st">'What country is he from?'</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gold Answer'</span>: <span class="st">'New Zealand'</span>,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Why It's Challenging"</span>: <span class="st">'Depends on conversation history'</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Category'</span>: <span class="st">'Unanswerable'</span>,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Question'</span>: <span class="st">'What year was "The Last Pixel" released?'</span>,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gold Answer'</span>: <span class="st">'Movie not in database'</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Why It's Challenging"</span>: <span class="st">'Tests ability to say "I don</span><span class="ch">\'</span><span class="st">t know"'</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>df_sample <span class="op">=</span> pd.DataFrame(sample_questions)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Render Table (Default Styling)</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>show(</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    df_sample,</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    classes<span class="op">=</span><span class="st">"display compact"</span>,</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    style<span class="op">=</span><span class="st">"width:100%; font-size: 16px; white-space: normal;"</span>,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    scrollX<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    columnDefs<span class="op">=</span>[</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"className"</span>: <span class="st">"dt-left"</span>, <span class="st">"targets"</span>: <span class="st">"_all"</span>},</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"width"</span>: <span class="st">"10%"</span>, <span class="st">"targets"</span>: <span class="dv">0</span>},</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"width"</span>: <span class="st">"35%"</span>, <span class="st">"targets"</span>: <span class="dv">1</span>},</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"width"</span>: <span class="st">"15%"</span>, <span class="st">"targets"</span>: <span class="dv">2</span>},</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"width"</span>: <span class="st">"40%"</span>, <span class="st">"targets"</span>: <span class="dv">3</span>}</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<!--| quarto-html-table-processing: none -->
<table id="itables_ce7bbba8_a0af_414a_bb8d_0f873b113c9d"><tbody><tr>
    <td style="vertical-align:middle; text-align:left">
    <a href="https://mwouts.github.io/itables/"><svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="64" viewbox="0 0 500 400" style="font-family: 'Droid Sans', sans-serif;">
    <g style="fill:#d9d7fc">
        <path d="M100,400H500V357H100Z"></path>
        <path d="M100,300H400V257H100Z"></path>
        <path d="M0,200H400V157H0Z"></path>
        <path d="M100,100H500V57H100Z"></path>
        <path d="M100,350H500V307H100Z"></path>
        <path d="M100,250H400V207H100Z"></path>
        <path d="M0,150H400V107H0Z"></path>
        <path d="M100,50H500V7H100Z"></path>
    </g>
    <g style="fill:#1a1366;stroke:#1a1366;">
   <rect x="100" y="7" width="400" height="43">
    <animate attributename="width" values="0;400;0" dur="5s" repeatcount="indefinite"></animate>
      <animate attributename="x" values="100;100;500" dur="5s" repeatcount="indefinite"></animate>
  </rect>
        <rect x="0" y="107" width="400" height="43">
    <animate attributename="width" values="0;400;0" dur="3.5s" repeatcount="indefinite"></animate>
    <animate attributename="x" values="0;0;400" dur="3.5s" repeatcount="indefinite"></animate>
  </rect>
        <rect x="100" y="207" width="300" height="43">
    <animate attributename="width" values="0;300;0" dur="3s" repeatcount="indefinite"></animate>
    <animate attributename="x" values="100;100;400" dur="3s" repeatcount="indefinite"></animate>
  </rect>
        <rect x="100" y="307" width="400" height="43">
    <animate attributename="width" values="0;400;0" dur="4s" repeatcount="indefinite"></animate>
      <animate attributename="x" values="100;100;500" dur="4s" repeatcount="indefinite"></animate>
  </rect>
        <g style="fill:transparent;stroke-width:8; stroke-linejoin:round" rx="5">
            <g transform="translate(45 50) rotate(-45)">
                <circle r="33" cx="0" cy="0"></circle>
                <rect x="-8" y="32" width="16" height="30"></rect>
            </g>

            <g transform="translate(450 152)">
                <polyline points="-15,-20 -35,-20 -35,40 25,40 25,20"></polyline>
                <rect x="-15" y="-40" width="60" height="60"></rect>
            </g>

            <g transform="translate(50 352)">
                <polygon points="-35,-5 0,-40 35,-5"></polygon>
                <polygon points="-35,10 0,45 35,10"></polygon>
            </g>

            <g transform="translate(75 250)">
                <polyline points="-30,30 -60,0 -30,-30"></polyline>
                <polyline points="0,30 -30,0 0,-30"></polyline>
            </g>

            <g transform="translate(425 250) rotate(180)">
                <polyline points="-30,30 -60,0 -30,-30"></polyline>
                <polyline points="0,30 -30,0 0,-30"></polyline>
            </g>
        </g>
    </g>
</svg>
</a>
    Loading ITables v2.5.2 from the internet...
    (need <a href="https://mwouts.github.io/itables/troubleshooting.html">help</a>?)</td>
    </tr></tbody></table>
<link href="https://www.unpkg.com/dt_for_itables@2.4.0/dt_bundle.css" rel="stylesheet">
<script type="module">
    import { ITable, jQuery as $ } from 'https://www.unpkg.com/dt_for_itables@2.4.0/dt_bundle.js';

    document.querySelectorAll("#itables_ce7bbba8_a0af_414a_bb8d_0f873b113c9d:not(.dataTable)").forEach(table => {
        if (!(table instanceof HTMLTableElement))
            return;

        let dt_args = {"classes": ["display", "compact"], "style": {"width": "100%", "font-size": "16px", "white-space": "normal"}, "scrollX": false, "columnDefs": [{"className": "dt-left", "targets": "_all"}, {"width": "10%", "targets": 0}, {"width": "35%", "targets": 1}, {"width": "15%", "targets": 2}, {"width": "40%", "targets": 3}], "layout": {"topStart": null, "topEnd": null, "bottomStart": null, "bottomEnd": null}, "order": [], "text_in_header_can_be_selected": true, "table_html": "<table><thead>\n    <tr style=\"text-align: right;\">\n      \n      <th>Category</th>\n      <th>Question</th>\n      <th>Gold Answer</th>\n      <th>Why It's Challenging</th>\n    </tr>\n  </thead></table>", "data_json": "[[\"Factual\", \"What is the rating of \\\"Bluefin\\\"?\", \"7.2\", \"Simple lookup - tests basic retrieval\"], [\"Descriptive\", \"In Sweet Trap (2024), the apprentice falls into whose trap?\", \"Jiang Jie\", \"Requires finding specific plot details\"], [\"Filter\", \"How many movies in 2025 allude to the holocaust?\", \"2\", \"Needs metadata filtering + counting\"], [\"Multi-hop\", \"What is the 4th oldest Star Wars movie?\", \"Star Wars: Droids - The Great Heep\", \"Requires sorting then selecting nth item\"], [\"Contextual\", \"What country is he from?\", \"New Zealand\", \"Depends on conversation history\"], [\"Unanswerable\", \"What year was \\\"The Last Pixel\\\" released?\", \"Movie not in database\", \"Tests ability to say \\\"I don't know\\\"\"]]"};
        new ITable(table, dt_args);
    });
</script>
</div>
</div>
<div class="tbl-caption">
<p><strong>Table 1</strong>. Sample questions from the 100-question evaluation set, showing each category and its associated challenge.</p>
</div>
</section>
<section id="rag-architectures" class="level3">
<h3 class="anchored" data-anchor-id="rag-architectures">RAG Architectures</h3>
<p>As mentioned, the RAG systems evaluated in this study ranged from a simple “naive” baseline retrieval to complex multi-stage systems. Each represents a different idea on how to improve RAG performance.</p>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row quarto-layout-valign-bottom">
<div class="cell quarto-layout-cell" data-fig-height="6" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
    User[User Query]
    
    subgraph Retrieval["Retrieval Phase"]
        User --&gt; Embed[Embed Query]
        Embed --&gt; Search["Vector Search&lt;br/&gt;(k=20)"]
        Search --&gt; Docs[Retrieved Docs]
    end
    
    subgraph Generation["Generation Phase"]
        Docs --&gt; Format[Format Context]
        Format --&gt; Prompt[Construct Prompt]
        Prompt --&gt; LLM[LLM Generate]
        LLM --&gt; Output[Answer]
    end

    style User fill:#e8f4f8,stroke:#333,stroke-width:2px
    style LLM fill:#f0e6ff,stroke:#333,stroke-width:2px
    style Output fill:#e8f8e8,stroke:#333,stroke-width:2px
    style Retrieval fill:#f9f9f9,stroke:#999
    style Generation fill:#f9f9f9,stroke:#999
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-height="6" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
User[User Query] --&gt; Extract[Extract Metadata]
Extract --&gt; Search{Search Type}

Search --&gt;|Has Filters| Hybrid["Hybrid Search&lt;br/&gt;(Vector + Metadata)"]
Search --&gt;|No Filters| Vector["Vector Search&lt;br/&gt;(k=20)"]

Hybrid --&gt; Docs[Retrieved Docs]
Vector --&gt; Docs

Docs --&gt; CoT["Chain of Thought&lt;br/&gt;Prompt"]
CoT --&gt; LLM[LLM Generate]
LLM --&gt; Answer[Answer]

style User fill:#e8f4f8,stroke:#333,stroke-width:2px
style LLM fill:#f0e6ff,stroke:#333,stroke-width:2px
style Extract fill:#fff9e6,stroke:#333,stroke-width:2px
style Answer fill:#e8f8e8,stroke:#333,stroke-width:2px
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-bottom">
<div class="cell quarto-layout-cell" data-fig-height="6" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TB
User[User Query] --&gt; Retrieve["Vector Search(k=20)"]

Retrieve --&gt; Grade{Grade Docs}
Grade --&gt;|Relevant| Keep[Keep Doc]
Grade --&gt;|Irrelevant| Reject[Reject]

Keep --&gt; Check{Enough?}
Reject --&gt; Check

%% Force the YES branch to the left
Check --&gt;|Yes| YDummy(( ))
YDummy --&gt; Generate["Generate Answer"]

Check --&gt;|No| Expand["Expand Search"]
Expand --&gt; Grade

Generate --&gt; Verify{Confident?}
Verify --&gt;|Yes| Answer[Final Answer]
Verify --&gt;|No| Refine["Refine + Retry"]
Refine --&gt; Generate

style User fill:#e8f4f8,stroke:#333,stroke-width:2px
style Grade fill:#ffe6e6,stroke:#333,stroke-width:2px
style Generate fill:#f0e6ff,stroke:#333,stroke-width:2px
style Answer fill:#e8f8e8,stroke:#333,stroke-width:2px
style Verify fill:#fff0f0,stroke:#333,stroke-width:1px
style YDummy fill:#ffffff00,stroke:#ffffff00
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-fig-height="6" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
User[User Query] --&gt; Context["LLM: Contextualize"]
Context --&gt; Wide["Wide Retrieval(k=100)"]

subgraph Rerank["Reranking Pipeline"]
    Wide --&gt; Cross["Cross-Encoder&lt;br/&gt;Reranker"]
    Cross --&gt; Top["Select Top 10"]
end

Top --&gt; Grade["LLM: Grade Docs"]
Grade --&gt; Generate["LLM: Generate&lt;br/&gt;with Citations"]
Generate --&gt; Output["Answer + Citations"]

style Context fill:#f0e6ff,stroke:#333,stroke-width:2px
style Cross fill:#ffe6e6,stroke:#333,stroke-width:3px
style Grade fill:#f0e6ff,stroke:#333,stroke-width:2px
style Generate fill:#f0e6ff,stroke:#333,stroke-width:2px
style Output fill:#e8f8e8,stroke:#333,stroke-width:2px
style Rerank fill:#f9f9f9,stroke:#999
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 2</strong>. RAG system architectures evaluated: (a) System A - Baseline RAG with simple retrieval + generation, (b) System B - Hybrid Search with vector + metadata and CoT prompting, (c) System C - Agentic RAG with document grading and adaptive generation, (d) System D - “God Mode” with maximum complexity and reranking.</p>
</div>
<ul>
<li><strong>SysA</strong>: Simple one-shot RAG. No bells or whistles. Retrieves 20 documents by semantic matching and inserts all of them into the context.</li>
<li><strong>SysB</strong>: Hybrid Search RAG. Uses metadata filtering in addition to semantic search. Has question-type detection (filtering, multi-hop, etc) with special handling for each.</li>
<li><strong>SysC</strong>: Agentic RAG. LLM-based document grading (decides if retrieved docs are relevant), query rewriting for follow-up questions using chat history, and adaptive generation.</li>
<li><strong>SysD</strong>: ‘God Mode’ agentic RAG with reranking. Casts a wide net (100 documents) and selects 10 documents by BGE-reranker-v2-m3 reranking.</li>
</ul>
</section>
<section id="llms" class="level3">
<h3 class="anchored" data-anchor-id="llms">LLMs</h3>
<p>Generally speaking, the selection of LLMs in this study leaned more towards value options that might be preferable in larger scale production settings. GPT-4o was included as a reference, as well as a couple other inexpensive closed-source models, as well as some smaller open-source models:</p>
<div id="7aef42d9" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itables <span class="im">import</span> show</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Prepare Data</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>models_data <span class="op">=</span> [</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'GPT-4o'</span>, <span class="st">'Provider'</span>: <span class="st">'OpenAI'</span>, <span class="st">'Params'</span>: <span class="st">'~1T*'</span>, <span class="st">'Deployment'</span>: <span class="st">'Cloud API'</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$5/1M tokens'</span>, <span class="st">'Speed'</span>: <span class="st">'~100 tok/s'</span>, <span class="st">'Purpose'</span>: <span class="st">'Reference baseline'</span>, <span class="st">'Category'</span>: <span class="st">'Premium'</span>},</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'GPT-4o-mini'</span>, <span class="st">'Provider'</span>: <span class="st">'OpenAI'</span>, <span class="st">'Params'</span>: <span class="st">'~100B*'</span>, <span class="st">'Deployment'</span>: <span class="st">'Cloud API'</span>, </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0.15/1M tokens'</span>, <span class="st">'Speed'</span>: <span class="st">'~150 tok/s'</span>, <span class="st">'Purpose'</span>: <span class="st">'Cost-optimized'</span>, <span class="st">'Category'</span>: <span class="st">'Budget'</span>},</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'Gemini Flash'</span>, <span class="st">'Provider'</span>: <span class="st">'Google'</span>, <span class="st">'Params'</span>: <span class="st">'~50B*'</span>, <span class="st">'Deployment'</span>: <span class="st">'Cloud API'</span>, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0.075/1M tokens'</span>, <span class="st">'Speed'</span>: <span class="st">'~200 tok/s'</span>, <span class="st">'Purpose'</span>: <span class="st">'Speed-optimized'</span>, <span class="st">'Category'</span>: <span class="st">'Budget'</span>},</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'Qwen 2.5 32B'</span>, <span class="st">'Provider'</span>: <span class="st">'Alibaba'</span>, <span class="st">'Params'</span>: <span class="st">'32B'</span>, <span class="st">'Deployment'</span>: <span class="st">'Local (4-bit)'</span>, </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0'</span>, <span class="st">'Speed'</span>: <span class="st">'~60 tok/s'</span>, <span class="st">'Purpose'</span>: <span class="st">'Quality local'</span>, <span class="st">'Category'</span>: <span class="st">'Local'</span>},</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'Qwen 2.5 32B-Q2'</span>, <span class="st">'Provider'</span>: <span class="st">'Alibaba'</span>, <span class="st">'Params'</span>: <span class="st">'32B'</span>, <span class="st">'Deployment'</span>: <span class="st">'Local (2-bit)'</span>, </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0'</span>, <span class="st">'Speed'</span>: <span class="st">'~80 tok/s'</span>, <span class="st">'Purpose'</span>: <span class="st">'Speed local'</span>, <span class="st">'Category'</span>: <span class="st">'Local'</span>},</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'Llama 3.1 70B-IQ2'</span>, <span class="st">'Provider'</span>: <span class="st">'Meta'</span>, <span class="st">'Params'</span>: <span class="st">'70B'</span>, <span class="st">'Deployment'</span>: <span class="st">'Local (2-bit)'</span>, </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0'</span>, <span class="st">'Speed'</span>: <span class="st">'~50 tok/s'</span>, <span class="st">'Purpose'</span>: <span class="st">'Max params on 4090'</span>, <span class="st">'Category'</span>: <span class="st">'Local'</span>}</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>df_models <span class="op">=</span> pd.DataFrame(models_data)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>df_models.rename(columns<span class="op">=</span>{<span class="st">'Params'</span>: <span class="st">'Size'</span>, <span class="st">'Purpose'</span>: <span class="st">'Test Purpose'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Define Styling Logic</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_by_category(row):</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    cat <span class="op">=</span> row[<span class="st">'Category'</span>]</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cat <span class="op">==</span> <span class="st">'Premium'</span>:</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        bg_color <span class="op">=</span> <span class="st">'#e8f4f8'</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> cat <span class="op">==</span> <span class="st">'Budget'</span>:</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        bg_color <span class="op">=</span> <span class="st">'#f0f8e8'</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        bg_color <span class="op">=</span> <span class="st">'#fff9e6'</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="ss">f'background-color: </span><span class="sc">{</span>bg_color<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> _ <span class="kw">in</span> row]</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Render Table</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>show(</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    df_models.style.<span class="bu">apply</span>(color_by_category, axis<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    classes<span class="op">=</span><span class="st">"display"</span>, </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    scrollX<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    columnDefs<span class="op">=</span>[</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"className"</span>: <span class="st">"dt-center"</span>, <span class="st">"targets"</span>: <span class="st">"_all"</span>},</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"visible"</span>: <span class="va">False</span>, <span class="st">"targets"</span>: <span class="dv">7</span>}</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    allow_html<span class="op">=</span><span class="va">True</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<!--| quarto-html-table-processing: none -->
<table id="T_4902f"><tbody><tr>
    <td style="vertical-align:middle; text-align:left">
    
    Loading ITables v2.5.2 from the internet...
    (need <a href="https://mwouts.github.io/itables/troubleshooting.html">help</a>?)</td>
    </tr></tbody></table>
<link href="https://www.unpkg.com/dt_for_itables@2.4.0/dt_bundle.css" rel="stylesheet">
<script type="module">
    import { ITable, jQuery as $ } from 'https://www.unpkg.com/dt_for_itables@2.4.0/dt_bundle.js';

    document.querySelectorAll("#T_4902f:not(.dataTable)").forEach(table => {
        if (!(table instanceof HTMLTableElement))
            return;

        let dt_args = {"classes": ["display"], "scrollX": false, "columnDefs": [{"className": "dt-center", "targets": "_all"}, {"visible": false, "targets": 7}], "layout": {"topStart": null, "topEnd": null, "bottomStart": null, "bottomEnd": null}, "order": [], "style": {"table-layout": "auto", "width": "auto", "margin": "auto", "caption-side": "bottom"}, "text_in_header_can_be_selected": true, "table_style": "\n#T_4902f_row0_col0, #T_4902f_row0_col1, #T_4902f_row0_col2, #T_4902f_row0_col3, #T_4902f_row0_col4, #T_4902f_row0_col5, #T_4902f_row0_col6, #T_4902f_row0_col7 {\n  background-color: #e8f4f8;\n}\n#T_4902f_row1_col0, #T_4902f_row1_col1, #T_4902f_row1_col2, #T_4902f_row1_col3, #T_4902f_row1_col4, #T_4902f_row1_col5, #T_4902f_row1_col6, #T_4902f_row1_col7, #T_4902f_row2_col0, #T_4902f_row2_col1, #T_4902f_row2_col2, #T_4902f_row2_col3, #T_4902f_row2_col4, #T_4902f_row2_col5, #T_4902f_row2_col6, #T_4902f_row2_col7 {\n  background-color: #f0f8e8;\n}\n#T_4902f_row3_col0, #T_4902f_row3_col1, #T_4902f_row3_col2, #T_4902f_row3_col3, #T_4902f_row3_col4, #T_4902f_row3_col5, #T_4902f_row3_col6, #T_4902f_row3_col7, #T_4902f_row4_col0, #T_4902f_row4_col1, #T_4902f_row4_col2, #T_4902f_row4_col3, #T_4902f_row4_col4, #T_4902f_row4_col5, #T_4902f_row4_col6, #T_4902f_row4_col7, #T_4902f_row5_col0, #T_4902f_row5_col1, #T_4902f_row5_col2, #T_4902f_row5_col3, #T_4902f_row5_col4, #T_4902f_row5_col5, #T_4902f_row5_col6, #T_4902f_row5_col7 {\n  background-color: #fff9e6;\n}\n", "table_html": "\n<table id=\"T_4902f\">\n  <thead>\n    <tr>\n      <th id=\"T_4902f_level0_col0\" class=\"col_heading level0 col0\" >Model</th>\n      <th id=\"T_4902f_level0_col1\" class=\"col_heading level0 col1\" >Provider</th>\n      <th id=\"T_4902f_level0_col2\" class=\"col_heading level0 col2\" >Size</th>\n      <th id=\"T_4902f_level0_col3\" class=\"col_heading level0 col3\" >Deployment</th>\n      <th id=\"T_4902f_level0_col4\" class=\"col_heading level0 col4\" >Cost</th>\n      <th id=\"T_4902f_level0_col5\" class=\"col_heading level0 col5\" >Speed</th>\n      <th id=\"T_4902f_level0_col6\" class=\"col_heading level0 col6\" >Test Purpose</th>\n      <th id=\"T_4902f_level0_col7\" class=\"col_heading level0 col7\" >Category</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td id=\"T_4902f_row0_col0\" class=\"data row0 col0\" >GPT-4o</td>\n      <td id=\"T_4902f_row0_col1\" class=\"data row0 col1\" >OpenAI</td>\n      <td id=\"T_4902f_row0_col2\" class=\"data row0 col2\" >~1T*</td>\n      <td id=\"T_4902f_row0_col3\" class=\"data row0 col3\" >Cloud API</td>\n      <td id=\"T_4902f_row0_col4\" class=\"data row0 col4\" >$5/1M tokens</td>\n      <td id=\"T_4902f_row0_col5\" class=\"data row0 col5\" >~100 tok/s</td>\n      <td id=\"T_4902f_row0_col6\" class=\"data row0 col6\" >Reference baseline</td>\n      <td id=\"T_4902f_row0_col7\" class=\"data row0 col7\" >Premium</td>\n    </tr>\n    <tr>\n      <td id=\"T_4902f_row1_col0\" class=\"data row1 col0\" >GPT-4o-mini</td>\n      <td id=\"T_4902f_row1_col1\" class=\"data row1 col1\" >OpenAI</td>\n      <td id=\"T_4902f_row1_col2\" class=\"data row1 col2\" >~100B*</td>\n      <td id=\"T_4902f_row1_col3\" class=\"data row1 col3\" >Cloud API</td>\n      <td id=\"T_4902f_row1_col4\" class=\"data row1 col4\" >$0.15/1M tokens</td>\n      <td id=\"T_4902f_row1_col5\" class=\"data row1 col5\" >~150 tok/s</td>\n      <td id=\"T_4902f_row1_col6\" class=\"data row1 col6\" >Cost-optimized</td>\n      <td id=\"T_4902f_row1_col7\" class=\"data row1 col7\" >Budget</td>\n    </tr>\n    <tr>\n      <td id=\"T_4902f_row2_col0\" class=\"data row2 col0\" >Gemini Flash</td>\n      <td id=\"T_4902f_row2_col1\" class=\"data row2 col1\" >Google</td>\n      <td id=\"T_4902f_row2_col2\" class=\"data row2 col2\" >~50B*</td>\n      <td id=\"T_4902f_row2_col3\" class=\"data row2 col3\" >Cloud API</td>\n      <td id=\"T_4902f_row2_col4\" class=\"data row2 col4\" >$0.075/1M tokens</td>\n      <td id=\"T_4902f_row2_col5\" class=\"data row2 col5\" >~200 tok/s</td>\n      <td id=\"T_4902f_row2_col6\" class=\"data row2 col6\" >Speed-optimized</td>\n      <td id=\"T_4902f_row2_col7\" class=\"data row2 col7\" >Budget</td>\n    </tr>\n    <tr>\n      <td id=\"T_4902f_row3_col0\" class=\"data row3 col0\" >Qwen 2.5 32B</td>\n      <td id=\"T_4902f_row3_col1\" class=\"data row3 col1\" >Alibaba</td>\n      <td id=\"T_4902f_row3_col2\" class=\"data row3 col2\" >32B</td>\n      <td id=\"T_4902f_row3_col3\" class=\"data row3 col3\" >Local (4-bit)</td>\n      <td id=\"T_4902f_row3_col4\" class=\"data row3 col4\" >$0</td>\n      <td id=\"T_4902f_row3_col5\" class=\"data row3 col5\" >~60 tok/s</td>\n      <td id=\"T_4902f_row3_col6\" class=\"data row3 col6\" >Quality local</td>\n      <td id=\"T_4902f_row3_col7\" class=\"data row3 col7\" >Local</td>\n    </tr>\n    <tr>\n      <td id=\"T_4902f_row4_col0\" class=\"data row4 col0\" >Qwen 2.5 32B-Q2</td>\n      <td id=\"T_4902f_row4_col1\" class=\"data row4 col1\" >Alibaba</td>\n      <td id=\"T_4902f_row4_col2\" class=\"data row4 col2\" >32B</td>\n      <td id=\"T_4902f_row4_col3\" class=\"data row4 col3\" >Local (2-bit)</td>\n      <td id=\"T_4902f_row4_col4\" class=\"data row4 col4\" >$0</td>\n      <td id=\"T_4902f_row4_col5\" class=\"data row4 col5\" >~80 tok/s</td>\n      <td id=\"T_4902f_row4_col6\" class=\"data row4 col6\" >Speed local</td>\n      <td id=\"T_4902f_row4_col7\" class=\"data row4 col7\" >Local</td>\n    </tr>\n    <tr>\n      <td id=\"T_4902f_row5_col0\" class=\"data row5 col0\" >Llama 3.1 70B-IQ2</td>\n      <td id=\"T_4902f_row5_col1\" class=\"data row5 col1\" >Meta</td>\n      <td id=\"T_4902f_row5_col2\" class=\"data row5 col2\" >70B</td>\n      <td id=\"T_4902f_row5_col3\" class=\"data row5 col3\" >Local (2-bit)</td>\n      <td id=\"T_4902f_row5_col4\" class=\"data row5 col4\" >$0</td>\n      <td id=\"T_4902f_row5_col5\" class=\"data row5 col5\" >~50 tok/s</td>\n      <td id=\"T_4902f_row5_col6\" class=\"data row5 col6\" >Max params on 4090</td>\n      <td id=\"T_4902f_row5_col7\" class=\"data row5 col7\" >Local</td>\n    </tr>\n  </tbody>\n</table>\n"};
        new ITable(table, dt_args);
    });
</script>
</div>
</div>
<div class="tbl-caption">
<p><strong>Table 2</strong>. Test suite of 6 models across 3 deployment scenarios. *Estimated parameters not disclosed by providers.</p>
</div>
<p>Qwen 2.5 32B (4-bit quant) and Llama 3.1 70B-IQ2 (2-bit quant) are within the 24GB VRAM limit of the RTX 4090. Because Llama 3.1 70B-IQ2 is 2-bit, I also threw in Qwen 2.5 32B-Q2 to test the degradation, if any, when going from 4 to 2-bit, and get a sense of what might be missing from Llama 3.1 70B-IQ2.</p>
</section>
<section id="embeddings" class="level3">
<h3 class="anchored" data-anchor-id="embeddings">Embeddings</h3>
<p>The embedding models include commercial state of the art and some reputable open source models.</p>
<div id="cd0e959f" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itables <span class="im">import</span> show</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Prepare Data</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>embeddings_data <span class="op">=</span> [</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'OpenAI Large'</span>, <span class="st">'Dimensions'</span>: <span class="dv">3072</span>, <span class="st">'Provider'</span>: <span class="st">'OpenAI'</span>, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0.13/1M tokens'</span>, <span class="st">'Quality'</span>: <span class="st">'⭐⭐⭐⭐⭐'</span>, <span class="st">'Selection Rationale'</span>: <span class="st">'SOTA baseline'</span>},</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'OpenAI Small'</span>, <span class="st">'Dimensions'</span>: <span class="dv">1536</span>, <span class="st">'Provider'</span>: <span class="st">'OpenAI'</span>, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0.02/1M tokens'</span>, <span class="st">'Quality'</span>: <span class="st">'⭐⭐⭐⭐'</span>, <span class="st">'Selection Rationale'</span>: <span class="st">'Cost/quality balance'</span>},</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'Jina v3'</span>, <span class="st">'Dimensions'</span>: <span class="dv">1024</span>, <span class="st">'Provider'</span>: <span class="st">'Jina AI'</span>, </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'Free (local)'</span>, <span class="st">'Quality'</span>: <span class="st">'⭐⭐⭐⭐'</span>, <span class="st">'Selection Rationale'</span>: <span class="st">'Best open-source'</span>},</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'BGE-M3'</span>, <span class="st">'Dimensions'</span>: <span class="dv">1024</span>, <span class="st">'Provider'</span>: <span class="st">'BAAI'</span>, </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'Free (local)'</span>, <span class="st">'Quality'</span>: <span class="st">'⭐⭐⭐'</span>, <span class="st">'Selection Rationale'</span>: <span class="st">'Popular baseline'</span>}</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>df_emb <span class="op">=</span> pd.DataFrame(embeddings_data)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Define Styling Logic</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_by_provider(row):</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    bg_color <span class="op">=</span> <span class="st">'#e8f4f8'</span> <span class="cf">if</span> <span class="st">'OpenAI'</span> <span class="kw">in</span> row[<span class="st">'Provider'</span>] <span class="cf">else</span> <span class="st">'#f0f8e8'</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="ss">f'background-color: </span><span class="sc">{</span>bg_color<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> _ <span class="kw">in</span> row]</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Render Table</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>show(</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    df_emb.style.<span class="bu">apply</span>(color_by_provider, axis<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    classes<span class="op">=</span><span class="st">"display"</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    scrollX<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    columnDefs<span class="op">=</span>[</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"className"</span>: <span class="st">"dt-center"</span>, <span class="st">"targets"</span>: <span class="st">"_all"</span>},</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"width"</span>: <span class="st">"150px"</span>, <span class="st">"targets"</span>: <span class="dv">5</span>}</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    allow_html<span class="op">=</span><span class="va">True</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<!--| quarto-html-table-processing: none -->
<table id="T_99f0d"><tbody><tr>
    <td style="vertical-align:middle; text-align:left">
    
    Loading ITables v2.5.2 from the internet...
    (need <a href="https://mwouts.github.io/itables/troubleshooting.html">help</a>?)</td>
    </tr></tbody></table>
<link href="https://www.unpkg.com/dt_for_itables@2.4.0/dt_bundle.css" rel="stylesheet">
<script type="module">
    import { ITable, jQuery as $ } from 'https://www.unpkg.com/dt_for_itables@2.4.0/dt_bundle.js';

    document.querySelectorAll("#T_99f0d:not(.dataTable)").forEach(table => {
        if (!(table instanceof HTMLTableElement))
            return;

        let dt_args = {"classes": ["display"], "scrollX": false, "columnDefs": [{"className": "dt-center", "targets": "_all"}, {"width": "150px", "targets": 5}], "layout": {"topStart": null, "topEnd": null, "bottomStart": null, "bottomEnd": null}, "order": [], "style": {"table-layout": "auto", "width": "auto", "margin": "auto", "caption-side": "bottom"}, "text_in_header_can_be_selected": true, "table_style": "\n#T_99f0d_row0_col0, #T_99f0d_row0_col1, #T_99f0d_row0_col2, #T_99f0d_row0_col3, #T_99f0d_row0_col4, #T_99f0d_row0_col5, #T_99f0d_row1_col0, #T_99f0d_row1_col1, #T_99f0d_row1_col2, #T_99f0d_row1_col3, #T_99f0d_row1_col4, #T_99f0d_row1_col5 {\n  background-color: #e8f4f8;\n}\n#T_99f0d_row2_col0, #T_99f0d_row2_col1, #T_99f0d_row2_col2, #T_99f0d_row2_col3, #T_99f0d_row2_col4, #T_99f0d_row2_col5, #T_99f0d_row3_col0, #T_99f0d_row3_col1, #T_99f0d_row3_col2, #T_99f0d_row3_col3, #T_99f0d_row3_col4, #T_99f0d_row3_col5 {\n  background-color: #f0f8e8;\n}\n", "table_html": "\n<table id=\"T_99f0d\">\n  <thead>\n    <tr>\n      <th id=\"T_99f0d_level0_col0\" class=\"col_heading level0 col0\" >Model</th>\n      <th id=\"T_99f0d_level0_col1\" class=\"col_heading level0 col1\" >Dimensions</th>\n      <th id=\"T_99f0d_level0_col2\" class=\"col_heading level0 col2\" >Provider</th>\n      <th id=\"T_99f0d_level0_col3\" class=\"col_heading level0 col3\" >Cost</th>\n      <th id=\"T_99f0d_level0_col4\" class=\"col_heading level0 col4\" >Quality</th>\n      <th id=\"T_99f0d_level0_col5\" class=\"col_heading level0 col5\" >Selection Rationale</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td id=\"T_99f0d_row0_col0\" class=\"data row0 col0\" >OpenAI Large</td>\n      <td id=\"T_99f0d_row0_col1\" class=\"data row0 col1\" >3072</td>\n      <td id=\"T_99f0d_row0_col2\" class=\"data row0 col2\" >OpenAI</td>\n      <td id=\"T_99f0d_row0_col3\" class=\"data row0 col3\" >$0.13/1M tokens</td>\n      <td id=\"T_99f0d_row0_col4\" class=\"data row0 col4\" >\u2b50\u2b50\u2b50\u2b50\u2b50</td>\n      <td id=\"T_99f0d_row0_col5\" class=\"data row0 col5\" >SOTA baseline</td>\n    </tr>\n    <tr>\n      <td id=\"T_99f0d_row1_col0\" class=\"data row1 col0\" >OpenAI Small</td>\n      <td id=\"T_99f0d_row1_col1\" class=\"data row1 col1\" >1536</td>\n      <td id=\"T_99f0d_row1_col2\" class=\"data row1 col2\" >OpenAI</td>\n      <td id=\"T_99f0d_row1_col3\" class=\"data row1 col3\" >$0.02/1M tokens</td>\n      <td id=\"T_99f0d_row1_col4\" class=\"data row1 col4\" >\u2b50\u2b50\u2b50\u2b50</td>\n      <td id=\"T_99f0d_row1_col5\" class=\"data row1 col5\" >Cost/quality balance</td>\n    </tr>\n    <tr>\n      <td id=\"T_99f0d_row2_col0\" class=\"data row2 col0\" >Jina v3</td>\n      <td id=\"T_99f0d_row2_col1\" class=\"data row2 col1\" >1024</td>\n      <td id=\"T_99f0d_row2_col2\" class=\"data row2 col2\" >Jina AI</td>\n      <td id=\"T_99f0d_row2_col3\" class=\"data row2 col3\" >Free (local)</td>\n      <td id=\"T_99f0d_row2_col4\" class=\"data row2 col4\" >\u2b50\u2b50\u2b50\u2b50</td>\n      <td id=\"T_99f0d_row2_col5\" class=\"data row2 col5\" >Best open-source</td>\n    </tr>\n    <tr>\n      <td id=\"T_99f0d_row3_col0\" class=\"data row3 col0\" >BGE-M3</td>\n      <td id=\"T_99f0d_row3_col1\" class=\"data row3 col1\" >1024</td>\n      <td id=\"T_99f0d_row3_col2\" class=\"data row3 col2\" >BAAI</td>\n      <td id=\"T_99f0d_row3_col3\" class=\"data row3 col3\" >Free (local)</td>\n      <td id=\"T_99f0d_row3_col4\" class=\"data row3 col4\" >\u2b50\u2b50\u2b50</td>\n      <td id=\"T_99f0d_row3_col5\" class=\"data row3 col5\" >Popular baseline</td>\n    </tr>\n  </tbody>\n</table>\n"};
        new ITable(table, dt_args);
    });
</script>
</div>
</div>
<div class="tbl-caption">
<p><strong>Table 3</strong>. Embedding models evaluated, showing the cost-quality trade-off landscape.</p>
</div>
</section>
<section id="llm-as-judge-scoring" class="level3">
<h3 class="anchored" data-anchor-id="llm-as-judge-scoring">LLM-as-judge scoring</h3>
<p>Answer quality was scored with a fixed judge model (GPT-5.1, temperature 0) to keep evaluations consistent across all 96 configurations. For each question, the judge received the question, the gold answer, and the system’s generated answer, and returned JSON with correctness_score and faithfulness_score in [0,1] plus a short justification (single deterministic pass per answer). Interpretation: correctness measures agreement with the gold answer (paraphrases allowed). Faithfulness here is best interpreted as task/constraint adherence (e.g., not fabricating an answer when unsupported). Judging is based on the answer only (the retrieved documents are not part of the judging). Retrieval quality is evaluated separately using recall/MRR against gold document IDs. LLM judging can be style-sensitive, so results should be taken more on a relative rather than absolute basis.</p>
<p><strong>Note on GPT-5.2 (“During preparation of this manuscript…”): </strong> After completion of all experiments, and while this article was being prepared, GPT-5.2 was released. A spot-check rerun was performed for the GPT-4o/OpenAI-large/SysD configuration with GPT-5.2 as the judge. The results were similar, so the conclusions appear robust to the judge version.</p>
</section>
</section>
<section id="results-and-discussion" class="level1">
<h1>Results and Discussion</h1>
<section id="top-configurations" class="level3">
<h3 class="anchored" data-anchor-id="top-configurations">Top Configurations</h3>
<div id="87bc0337" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itables <span class="im">import</span> show</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">'results_table.csv'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Prepare the Data</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>cols_to_keep <span class="op">=</span> [</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sys'</span>, <span class="st">'llm'</span>, <span class="st">'db'</span>, </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'correctness_score'</span>, <span class="st">'faithfulness_score'</span>, </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'latency_ms'</span>, <span class="st">'main_total_tokens'</span>, <span class="st">'retrieval_recall'</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>table_df <span class="op">=</span> df[cols_to_keep].copy()</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename for readability</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>table_df.columns <span class="op">=</span> [</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'System'</span>, <span class="st">'LLM'</span>, <span class="st">'Embedding'</span>, </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Correctness'</span>, <span class="st">'Faithfulness'</span>, </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Latency (ms)'</span>, <span class="st">'Tokens'</span>, <span class="st">'Recall'</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean System Names</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>system_map <span class="op">=</span> {</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysA"</span>: <span class="st">"A (Naive)"</span>, <span class="st">"SysC"</span>: <span class="st">"B (Hybrid)"</span>, </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysD"</span>: <span class="st">"C (Agentic)"</span>, <span class="st">"SysG"</span>: <span class="st">"D (God Mode)"</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'System'</span>] <span class="op">=</span> table_df[<span class="st">'System'</span>].<span class="bu">map</span>(<span class="kw">lambda</span> x: system_map.get(x, x))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by Correctness (Default view)</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>table_df <span class="op">=</span> table_df.sort_values(by<span class="op">=</span><span class="st">'Correctness'</span>, ascending<span class="op">=</span><span class="va">False</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Format the Values for Display</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'Correctness'</span>] <span class="op">=</span> table_df[<span class="st">'Correctness'</span>].<span class="bu">map</span>(<span class="st">'</span><span class="sc">{:.3f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'Faithfulness'</span>] <span class="op">=</span> table_df[<span class="st">'Faithfulness'</span>].<span class="bu">map</span>(<span class="st">'</span><span class="sc">{:.3f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'Recall'</span>] <span class="op">=</span> table_df[<span class="st">'Recall'</span>].<span class="bu">map</span>(<span class="st">'</span><span class="sc">{:.3f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'Latency (ms)'</span>] <span class="op">=</span> table_df[<span class="st">'Latency (ms)'</span>].<span class="bu">map</span>(<span class="st">'</span><span class="sc">{:,.0f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'Tokens'</span>] <span class="op">=</span> table_df[<span class="st">'Tokens'</span>].<span class="bu">map</span>(<span class="st">'</span><span class="sc">{:,.0f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'Embedding'</span>]<span class="op">=</span>table_df[<span class="st">'Embedding'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.replace(<span class="st">''</span>,<span class="st">''</span>))</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'LLM'</span>]<span class="op">=</span>table_df[<span class="st">'LLM'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.replace(<span class="st">'flash-latest'</span>,<span class="st">'2.5-flash'</span>))</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>show(</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    table_df, </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    classes<span class="op">=</span><span class="st">"display compact"</span>,</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    paging<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    scrollX<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    order<span class="op">=</span>[[<span class="dv">3</span>, <span class="st">'desc'</span>]],</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    columnDefs<span class="op">=</span>[{<span class="st">"className"</span>: <span class="st">"dt-center"</span>, <span class="st">"targets"</span>: <span class="st">"_all"</span>}]</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<!--| quarto-html-table-processing: none -->
<table id="itables_131fa154_c665_4541_9b32_0f83f02cc497"><tbody><tr>
    <td style="vertical-align:middle; text-align:left">
    <a href="https://mwouts.github.io/itables/"><svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="64" viewbox="0 0 500 400" style="font-family: 'Droid Sans', sans-serif;">
    <g style="fill:#d9d7fc">
        <path d="M100,400H500V357H100Z"></path>
        <path d="M100,300H400V257H100Z"></path>
        <path d="M0,200H400V157H0Z"></path>
        <path d="M100,100H500V57H100Z"></path>
        <path d="M100,350H500V307H100Z"></path>
        <path d="M100,250H400V207H100Z"></path>
        <path d="M0,150H400V107H0Z"></path>
        <path d="M100,50H500V7H100Z"></path>
    </g>
    <g style="fill:#1a1366;stroke:#1a1366;">
   <rect x="100" y="7" width="400" height="43">
    <animate attributename="width" values="0;400;0" dur="5s" repeatcount="indefinite"></animate>
      <animate attributename="x" values="100;100;500" dur="5s" repeatcount="indefinite"></animate>
  </rect>
        <rect x="0" y="107" width="400" height="43">
    <animate attributename="width" values="0;400;0" dur="3.5s" repeatcount="indefinite"></animate>
    <animate attributename="x" values="0;0;400" dur="3.5s" repeatcount="indefinite"></animate>
  </rect>
        <rect x="100" y="207" width="300" height="43">
    <animate attributename="width" values="0;300;0" dur="3s" repeatcount="indefinite"></animate>
    <animate attributename="x" values="100;100;400" dur="3s" repeatcount="indefinite"></animate>
  </rect>
        <rect x="100" y="307" width="400" height="43">
    <animate attributename="width" values="0;400;0" dur="4s" repeatcount="indefinite"></animate>
      <animate attributename="x" values="100;100;500" dur="4s" repeatcount="indefinite"></animate>
  </rect>
        <g style="fill:transparent;stroke-width:8; stroke-linejoin:round" rx="5">
            <g transform="translate(45 50) rotate(-45)">
                <circle r="33" cx="0" cy="0"></circle>
                <rect x="-8" y="32" width="16" height="30"></rect>
            </g>

            <g transform="translate(450 152)">
                <polyline points="-15,-20 -35,-20 -35,40 25,40 25,20"></polyline>
                <rect x="-15" y="-40" width="60" height="60"></rect>
            </g>

            <g transform="translate(50 352)">
                <polygon points="-35,-5 0,-40 35,-5"></polygon>
                <polygon points="-35,10 0,45 35,10"></polygon>
            </g>

            <g transform="translate(75 250)">
                <polyline points="-30,30 -60,0 -30,-30"></polyline>
                <polyline points="0,30 -30,0 0,-30"></polyline>
            </g>

            <g transform="translate(425 250) rotate(180)">
                <polyline points="-30,30 -60,0 -30,-30"></polyline>
                <polyline points="0,30 -30,0 0,-30"></polyline>
            </g>
        </g>
    </g>
</svg>
</a>
    Loading ITables v2.5.2 from the internet...
    (need <a href="https://mwouts.github.io/itables/troubleshooting.html">help</a>?)</td>
    </tr></tbody></table>
<link href="https://www.unpkg.com/dt_for_itables@2.4.0/dt_bundle.css" rel="stylesheet">
<script type="module">
    import { ITable, jQuery as $ } from 'https://www.unpkg.com/dt_for_itables@2.4.0/dt_bundle.js';

    document.querySelectorAll("#itables_131fa154_c665_4541_9b32_0f83f02cc497:not(.dataTable)").forEach(table => {
        if (!(table instanceof HTMLTableElement))
            return;

        let dt_args = {"classes": ["display", "compact"], "paging": true, "scrollX": false, "order": [[3, "desc"]], "columnDefs": [{"className": "dt-center", "targets": "_all"}], "layout": {"topStart": "pageLength", "topEnd": "search", "bottomStart": "info", "bottomEnd": "paging"}, "style": {"table-layout": "auto", "width": "auto", "margin": "auto", "caption-side": "bottom"}, "text_in_header_can_be_selected": true, "table_html": "<table><thead>\n    <tr style=\"text-align: right;\">\n      \n      <th>System</th>\n      <th>LLM</th>\n      <th>Embedding</th>\n      <th>Correctness</th>\n      <th>Faithfulness</th>\n      <th>Latency (ms)</th>\n      <th>Tokens</th>\n      <th>Recall</th>\n    </tr>\n  </thead></table>", "data_json": "[[\"C (Agentic)\", \"gemini-2.5-flash\", \"jina-embeddings-v3\", \"0.700\", \"0.867\", \"4,426\", \"3,273\", \"0.725\"], [\"C (Agentic)\", \"gpt-4o\", \"openai-large\", \"0.700\", \"0.889\", \"999\", \"1,970\", \"0.750\"], [\"C (Agentic)\", \"qwen2.5:32b\", \"openai-large\", \"0.700\", \"0.884\", \"3,425\", \"2,222\", \"0.750\"], [\"D (God Mode)\", \"gpt-4o-mini\", \"openai-large\", \"0.698\", \"0.873\", \"3,278\", \"1,588\", \"0.762\"], [\"C (Agentic)\", \"llama3.1-70b-iq2_xs\", \"jina-embeddings-v3\", \"0.690\", \"0.910\", \"5,519\", \"2,106\", \"0.713\"], [\"C (Agentic)\", \"llama3.1-70b-iq2_xs\", \"openai-small\", \"0.690\", \"0.943\", \"4,433\", \"2,070\", \"0.713\"], [\"C (Agentic)\", \"gpt-4o\", \"jina-embeddings-v3\", \"0.690\", \"0.890\", \"1,003\", \"1,918\", \"0.738\"], [\"A (Naive)\", \"gpt-4o\", \"openai-large\", \"0.690\", \"0.847\", \"1,116\", \"2,969\", \"0.700\"], [\"C (Agentic)\", \"gpt-4o\", \"openai-small\", \"0.689\", \"0.846\", \"1,003\", \"1,946\", \"0.725\"], [\"D (God Mode)\", \"gpt-4o\", \"openai-large\", \"0.686\", \"0.914\", \"2,860\", \"1,564\", \"0.762\"], [\"C (Agentic)\", \"qwen2.5:32b\", \"jina-embeddings-v3\", \"0.685\", \"0.889\", \"4,781\", \"2,173\", \"0.738\"], [\"A (Naive)\", \"qwen2.5:32b\", \"jina-embeddings-v3\", \"0.682\", \"0.846\", \"7,058\", \"3,208\", \"0.688\"], [\"C (Agentic)\", \"gemini-2.5-flash\", \"openai-large\", \"0.680\", \"0.836\", \"4,521\", \"3,302\", \"0.725\"], [\"C (Agentic)\", \"qwen2.5:32b-instruct-q2_K\", \"jina-embeddings-v3\", \"0.680\", \"0.925\", \"3,245\", \"2,083\", \"0.738\"], [\"A (Naive)\", \"qwen2.5:32b\", \"openai-large\", \"0.679\", \"0.842\", \"7,153\", \"3,268\", \"0.700\"], [\"C (Agentic)\", \"qwen2.5:32b\", \"openai-small\", \"0.678\", \"0.882\", \"3,010\", \"2,107\", \"0.738\"], [\"D (God Mode)\", \"gpt-4o\", \"jina-embeddings-v3\", \"0.677\", \"0.896\", \"2,236\", \"1,568\", \"0.800\"], [\"A (Naive)\", \"gemini-2.5-flash\", \"openai-large\", \"0.674\", \"0.770\", \"2,341\", \"3,567\", \"0.700\"], [\"B (Hybrid)\", \"gpt-4o\", \"openai-large\", \"0.672\", \"0.900\", \"840\", \"1,790\", \"0.662\"], [\"B (Hybrid)\", \"gemini-2.5-flash\", \"jina-embeddings-v3\", \"0.670\", \"0.886\", \"2,046\", \"2,212\", \"0.675\"], [\"C (Agentic)\", \"qwen2.5:32b-instruct-q2_K\", \"openai-large\", \"0.670\", \"0.894\", \"3,283\", \"2,075\", \"0.750\"], [\"C (Agentic)\", \"llama3.1-70b-iq2_xs\", \"openai-large\", \"0.670\", \"0.920\", \"5,047\", \"2,079\", \"0.725\"], [\"D (God Mode)\", \"gpt-4o-mini\", \"jina-embeddings-v3\", \"0.669\", \"0.892\", \"2,953\", \"1,605\", \"0.812\"], [\"A (Naive)\", \"gpt-4o\", \"jina-embeddings-v3\", \"0.668\", \"0.806\", \"1,079\", \"2,903\", \"0.688\"], [\"C (Agentic)\", \"gpt-4o-mini\", \"openai-small\", \"0.667\", \"0.865\", \"1,006\", \"2,064\", \"0.738\"], [\"C (Agentic)\", \"gemini-2.5-flash\", \"openai-small\", \"0.665\", \"0.860\", \"4,495\", \"3,280\", \"0.738\"], [\"B (Hybrid)\", \"llama3.1-70b-iq2_xs\", \"openai-large\", \"0.660\", \"0.959\", \"5,555\", \"1,821\", \"0.662\"], [\"B (Hybrid)\", \"qwen2.5:32b\", \"jina-embeddings-v3\", \"0.660\", \"0.938\", \"6,762\", \"1,914\", \"0.675\"], [\"A (Naive)\", \"gpt-4o\", \"openai-small\", \"0.660\", \"0.846\", \"1,116\", \"2,964\", \"0.662\"], [\"B (Hybrid)\", \"gemini-2.5-flash\", \"openai-large\", \"0.660\", \"0.866\", \"1,885\", \"2,215\", \"0.662\"], [\"B (Hybrid)\", \"qwen2.5:32b-instruct-q2_K\", \"openai-large\", \"0.660\", \"0.894\", \"2,707\", \"1,971\", \"0.662\"], [\"B (Hybrid)\", \"gpt-4o\", \"jina-embeddings-v3\", \"0.659\", \"0.913\", \"904\", \"1,732\", \"0.675\"], [\"D (God Mode)\", \"gpt-4o\", \"openai-small\", \"0.658\", \"0.904\", \"2,512\", \"1,561\", \"0.762\"], [\"B (Hybrid)\", \"qwen2.5:32b-instruct-q2_K\", \"jina-embeddings-v3\", \"0.658\", \"0.916\", \"2,646\", \"1,922\", \"0.675\"], [\"D (God Mode)\", \"gpt-4o-mini\", \"openai-small\", \"0.657\", \"0.868\", \"3,205\", \"1,594\", \"0.762\"], [\"C (Agentic)\", \"gpt-4o-mini\", \"openai-large\", \"0.655\", \"0.855\", \"1,130\", \"2,078\", \"0.750\"], [\"A (Naive)\", \"gpt-4o-mini\", \"openai-large\", \"0.655\", \"0.786\", \"1,860\", \"2,981\", \"0.700\"], [\"A (Naive)\", \"gpt-4o-mini\", \"jina-embeddings-v3\", \"0.655\", \"0.823\", \"1,503\", \"2,910\", \"0.688\"], [\"B (Hybrid)\", \"qwen2.5:32b-instruct-q2_K\", \"openai-small\", \"0.650\", \"0.900\", \"2,754\", \"1,962\", \"0.650\"], [\"A (Naive)\", \"qwen2.5:32b-instruct-q2_K\", \"openai-small\", \"0.650\", \"0.803\", \"3,894\", \"3,272\", \"0.675\"], [\"B (Hybrid)\", \"gpt-4o-mini\", \"openai-small\", \"0.650\", \"0.871\", \"1,217\", \"1,781\", \"0.650\"], [\"B (Hybrid)\", \"qwen2.5:32b\", \"openai-large\", \"0.650\", \"0.892\", \"4,658\", \"1,967\", \"0.662\"], [\"A (Naive)\", \"qwen2.5:32b-instruct-q2_K\", \"openai-large\", \"0.650\", \"0.827\", \"4,340\", \"3,276\", \"0.700\"], [\"C (Agentic)\", \"qwen2.5:32b-instruct-q2_K\", \"openai-small\", \"0.650\", \"0.928\", \"3,180\", \"1,997\", \"0.738\"], [\"A (Naive)\", \"gpt-4o-mini\", \"openai-small\", \"0.649\", \"0.799\", \"1,527\", \"2,971\", \"0.675\"], [\"B (Hybrid)\", \"gpt-4o-mini\", \"openai-large\", \"0.646\", \"0.883\", \"1,356\", \"1,795\", \"0.662\"], [\"A (Naive)\", \"qwen2.5:32b-instruct-q2_K\", \"jina-embeddings-v3\", \"0.642\", \"0.849\", \"3,817\", \"3,219\", \"0.688\"], [\"B (Hybrid)\", \"gpt-4o-mini\", \"jina-embeddings-v3\", \"0.642\", \"0.812\", \"1,377\", \"1,739\", \"0.675\"], [\"A (Naive)\", \"qwen2.5:32b\", \"openai-small\", \"0.640\", \"0.831\", \"6,390\", \"3,267\", \"0.675\"], [\"B (Hybrid)\", \"gpt-4o\", \"openai-small\", \"0.638\", \"0.909\", \"856\", \"1,776\", \"0.637\"], [\"B (Hybrid)\", \"llama3.1-70b-iq2_xs\", \"openai-small\", \"0.635\", \"0.903\", \"5,672\", \"1,816\", \"0.650\"], [\"B (Hybrid)\", \"qwen2.5:32b\", \"openai-small\", \"0.635\", \"0.877\", \"4,537\", \"1,955\", \"0.650\"], [\"A (Naive)\", \"gemini-2.5-flash\", \"jina-embeddings-v3\", \"0.635\", \"0.749\", \"1,986\", \"3,476\", \"0.688\"], [\"D (God Mode)\", \"qwen2.5:32b\", \"openai-large\", \"0.633\", \"0.873\", \"23,488\", \"4,926\", \"0.713\"], [\"A (Naive)\", \"llama3.1-70b-iq2_xs\", \"openai-small\", \"0.633\", \"0.679\", \"9,236\", \"3,044\", \"0.675\"], [\"C (Agentic)\", \"gpt-4o-mini\", \"jina-embeddings-v3\", \"0.630\", \"0.886\", \"1,131\", \"2,041\", \"0.725\"], [\"B (Hybrid)\", \"llama3.1-70b-iq2_xs\", \"jina-embeddings-v3\", \"0.629\", \"0.904\", \"5,673\", \"1,765\", \"0.675\"], [\"D (God Mode)\", \"qwen2.5:32b-instruct-q2_K\", \"openai-large\", \"0.629\", \"0.858\", \"6,511\", \"4,924\", \"0.750\"], [\"A (Naive)\", \"llama3.1-70b-iq2_xs\", \"jina-embeddings-v3\", \"0.620\", \"0.707\", \"9,358\", \"2,976\", \"0.688\"], [\"A (Naive)\", \"llama3.1-70b-iq2_xs\", \"openai-large\", \"0.619\", \"0.655\", \"10,396\", \"3,043\", \"0.700\"], [\"A (Naive)\", \"gemini-2.5-flash\", \"openai-small\", \"0.614\", \"0.767\", \"2,311\", \"3,598\", \"0.675\"], [\"C (Agentic)\", \"llama3.1-70b-iq2_xs\", \"bge-m3\", \"0.610\", \"0.946\", \"4,925\", \"1,901\", \"0.575\"], [\"D (God Mode)\", \"qwen2.5:32b-instruct-q2_K\", \"jina-embeddings-v3\", \"0.609\", \"0.878\", \"4,461\", \"4,982\", \"0.725\"], [\"C (Agentic)\", \"qwen2.5:32b\", \"bge-m3\", \"0.605\", \"0.959\", \"2,934\", \"1,899\", \"0.600\"], [\"C (Agentic)\", \"gemini-2.5-flash\", \"bge-m3\", \"0.600\", \"0.853\", \"4,442\", \"3,167\", \"0.588\"], [\"B (Hybrid)\", \"gemini-2.5-flash\", \"openai-small\", \"0.600\", \"0.825\", \"2,105\", \"2,264\", \"0.650\"], [\"D (God Mode)\", \"qwen2.5:32b\", \"openai-small\", \"0.597\", \"0.860\", \"19,778\", \"4,951\", \"0.738\"], [\"D (God Mode)\", \"qwen2.5:32b-instruct-q2_K\", \"openai-small\", \"0.592\", \"0.830\", \"5,070\", \"5,051\", \"0.700\"], [\"A (Naive)\", \"gpt-4o\", \"bge-m3\", \"0.590\", \"0.877\", \"896\", \"2,826\", \"0.550\"], [\"A (Naive)\", \"qwen2.5:32b-instruct-q2_K\", \"bge-m3\", \"0.586\", \"0.824\", \"3,746\", \"3,131\", \"0.550\"], [\"D (God Mode)\", \"gemini-2.5-flash\", \"jina-embeddings-v3\", \"0.582\", \"0.826\", \"9,068\", \"1,058\", \"0.738\"], [\"B (Hybrid)\", \"qwen2.5:32b\", \"bge-m3\", \"0.580\", \"0.917\", \"4,672\", \"1,854\", \"0.537\"], [\"B (Hybrid)\", \"qwen2.5:32b-instruct-q2_K\", \"bge-m3\", \"0.580\", \"0.905\", \"2,426\", \"1,859\", \"0.537\"], [\"C (Agentic)\", \"qwen2.5:32b-instruct-q2_K\", \"bge-m3\", \"0.580\", \"0.922\", \"2,896\", \"1,846\", \"0.588\"], [\"A (Naive)\", \"gpt-4o-mini\", \"bge-m3\", \"0.578\", \"0.841\", \"1,274\", \"2,835\", \"0.550\"], [\"D (God Mode)\", \"qwen2.5:32b\", \"jina-embeddings-v3\", \"0.575\", \"0.830\", \"18,429\", \"4,886\", \"0.750\"], [\"A (Naive)\", \"qwen2.5:32b\", \"bge-m3\", \"0.570\", \"0.877\", \"7,134\", \"3,127\", \"0.550\"], [\"C (Agentic)\", \"gpt-4o-mini\", \"bge-m3\", \"0.570\", \"0.883\", \"1,006\", \"1,863\", \"0.588\"], [\"D (God Mode)\", \"gpt-4o-mini\", \"bge-m3\", \"0.570\", \"0.873\", \"2,803\", \"1,622\", \"0.625\"], [\"C (Agentic)\", \"gpt-4o\", \"bge-m3\", \"0.570\", \"0.832\", \"787\", \"1,686\", \"0.600\"], [\"D (God Mode)\", \"gemini-2.5-flash\", \"openai-large\", \"0.562\", \"0.808\", \"7,181\", \"1,055\", \"0.700\"], [\"B (Hybrid)\", \"llama3.1-70b-iq2_xs\", \"bge-m3\", \"0.560\", \"0.871\", \"5,786\", \"1,715\", \"0.537\"], [\"B (Hybrid)\", \"gpt-4o\", \"bge-m3\", \"0.555\", \"0.905\", \"757\", \"1,679\", \"0.537\"], [\"B (Hybrid)\", \"gemini-2.5-flash\", \"bge-m3\", \"0.548\", \"0.870\", \"1,969\", \"2,167\", \"0.537\"], [\"A (Naive)\", \"gemini-2.5-flash\", \"bge-m3\", \"0.546\", \"0.718\", \"2,090\", \"3,455\", \"0.550\"], [\"D (God Mode)\", \"gpt-4o\", \"bge-m3\", \"0.545\", \"0.882\", \"2,158\", \"1,578\", \"0.600\"], [\"D (God Mode)\", \"gemini-2.5-flash\", \"openai-small\", \"0.544\", \"0.835\", \"4,759\", \"1,053\", \"0.700\"], [\"B (Hybrid)\", \"gpt-4o-mini\", \"bge-m3\", \"0.530\", \"0.882\", \"1,066\", \"1,682\", \"0.537\"], [\"A (Naive)\", \"llama3.1-70b-iq2_xs\", \"bge-m3\", \"0.528\", \"0.701\", \"9,032\", \"2,897\", \"0.550\"], [\"D (God Mode)\", \"qwen2.5:32b-instruct-q2_K\", \"bge-m3\", \"0.508\", \"0.860\", \"4,111\", \"4,992\", \"0.550\"], [\"D (God Mode)\", \"qwen2.5:32b\", \"bge-m3\", \"0.498\", \"0.845\", \"20,319\", \"5,041\", \"0.562\"], [\"D (God Mode)\", \"gemini-2.5-flash\", \"bge-m3\", \"0.469\", \"0.831\", \"6,723\", \"1,052\", \"0.600\"], [\"D (God Mode)\", \"llama3.1-70b-iq2_xs\", \"openai-large\", \"0.406\", \"0.669\", \"33,167\", \"4,883\", \"0.537\"], [\"D (God Mode)\", \"llama3.1-70b-iq2_xs\", \"openai-small\", \"0.333\", \"0.600\", \"25,991\", \"5,054\", \"0.550\"], [\"D (God Mode)\", \"llama3.1-70b-iq2_xs\", \"jina-embeddings-v3\", \"0.300\", \"0.551\", \"28,428\", \"4,906\", \"0.512\"], [\"D (God Mode)\", \"llama3.1-70b-iq2_xs\", \"bge-m3\", \"0.165\", \"0.403\", \"22,024\", \"4,796\", \"0.263\"]]"};
        new ITable(table, dt_args);
    });
</script>
</div>
</div>
<div class="tbl-caption">
<p><strong>Table 4</strong>. All 96 configurations ranked by correctness score (default sort).</p>
</div>
<p>Table 4 shows the raw results for all 96 evaluated configurations, sorted by correctness. Each row corresponds to a unique configuration of RAG system architecture, LLM, and embedding model; with additional columns for metrics such as faithfulness, latency, token usage, and retrieval recall.</p>
<p>A cursory look at the table shows a few high-level patterns. First, there appears to be a relatively narrow band of configurations at around 70% correctness, no model “convincingly” better than the rest. GPT-4o expectedly shows up in many of the top-ranked configurations, but some open-source LLMs and embedding models show up as well, such as Qwen2.5 32B and Jina-V3 for embeddings.</p>
<p>Latency and token usage vary more widely. Some configurations achieve among the highest correctness with relatively low latency (~1000ms), while others suffer a latency penalty with no corresponding gains. Is there a benefit to the lower-ranked configurations in a more comprehensive cost-benefit analysis? This question is examined more in later sections.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">By Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">By Embedding</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">By System</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'results_table.csv'</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'llm'</span>]<span class="op">=</span>df[<span class="st">'llm'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.replace(<span class="st">'gemini-flash-latest'</span>,<span class="st">'gemini-2.5-flash'</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>nano_colors <span class="op">=</span> [<span class="st">"#636EFA"</span>, <span class="st">"#EF553B"</span>, <span class="st">"#00CC96"</span>, <span class="st">"#AB63FA"</span>, <span class="st">"#FFA15A"</span>]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> style_figure(fig, y_title):</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    fig.update_layout(</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        yaxis_title<span class="op">=</span>y_title,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        showlegend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        font<span class="op">=</span><span class="bu">dict</span>(family<span class="op">=</span><span class="st">"Arial"</span>, size<span class="op">=</span><span class="dv">14</span>),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        autosize<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">0</span>, r<span class="op">=</span><span class="dv">0</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    fig.update_traces(meanline_visible<span class="op">=</span><span class="va">True</span>, points<span class="op">=</span><span class="st">'all'</span>, jitter<span class="op">=</span><span class="fl">0.05</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                      marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">4</span>, opacity<span class="op">=</span><span class="fl">0.6</span>))</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fig</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>fig_llm <span class="op">=</span> px.violin(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    df, x<span class="op">=</span><span class="st">"llm"</span>, y<span class="op">=</span><span class="st">"correctness_score"</span>, color<span class="op">=</span><span class="st">"llm"</span>,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    box<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    color_discrete_sequence<span class="op">=</span>nano_colors</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>style_figure(fig_llm, <span class="st">"Correctness Score"</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>fig_llm.show(config<span class="op">=</span>{<span class="st">'responsive'</span>: <span class="va">True</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fd536bcb" class="cell quarto-layout-panel" data-layout-ncol="1" data-fig-height="6" data-execution_count="6">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="ce766212-85f7-4aa6-bf57-9ce567aa41b0" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("ce766212-85f7-4aa6-bf57-9ce567aa41b0")) {                    Plotly.newPlot(                        "ce766212-85f7-4aa6-bf57-9ce567aa41b0",                        [{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"llm=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"qwen2.5:32b-instruct-q2_K","marker":{"color":"#636EFA","opacity":0.6,"size":4},"name":"qwen2.5:32b-instruct-q2_K","offsetgroup":"qwen2.5:32b-instruct-q2_K","orientation":"v","scalegroup":"True","showlegend":true,"x":["qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K","qwen2.5:32b-instruct-q2_K"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"sHJoke184z+Nl24Sg8DiP4\u002fC9Shcj+I\u002fj8L1KFyP4j8lBoGVQ4vkP3STGARWDuU\u002fw\u002fUoXI\u002fC5T\u002fNzMzMzMzkPx+F61G4HuU\u002fcT0K16Nw5T\u002fNzMzMzMzkP83MzMzMzOQ\u002fzczMzMzM5D9U46WbxCDkP4xs5\u002fup8eI\u002fqMZLN4lB4D8="},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"},{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"llm=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"gemini-2.5-flash","marker":{"color":"#EF553B","opacity":0.6,"size":4},"name":"gemini-2.5-flash","offsetgroup":"gemini-2.5-flash","orientation":"v","scalegroup":"True","showlegend":true,"x":["gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash","gemini-2.5-flash"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"Rrbz\u002fdR44T\u002fvp8ZLN4nhPzMzMzMzM+M\u002fUrgehetR5D9xPQrXo3DlP2ZmZmZmZuY\u002fxSCwcmiR5T8fhetRuB7lP8P1KFyPwuU\u002f2c73U+Ol4z8zMzMzMzPjP0jhehSuR+U\u002flkOLbOf74T+cxCCwcmjhP2q8dJMYBN4\u002fOrTIdr6f4j8="},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"},{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"llm=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"gpt-4o","marker":{"color":"#00CC96","opacity":0.6,"size":4},"name":"gpt-4o","offsetgroup":"gpt-4o","orientation":"v","scalegroup":"True","showlegend":true,"x":["gpt-4o","gpt-4o","gpt-4o","gpt-4o","gpt-4o","gpt-4o","gpt-4o","gpt-4o","gpt-4o","gpt-4o","gpt-4o","gpt-4o","gpt-4o","gpt-4o","gpt-4o","gpt-4o"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"4XoUrkfh4j\u002fD9Shcj8LhPz0K16NwPeI\u002fxks3iUFg5T9KDAIrhxblPxSuR+F6FOY\u002fFK5H4XoU5j8bL90kBoHlP2ZmZmZmZuY\u002fH4XrUbge5T\u002fRItv5fmrkP0A1XrpJDOY\u002fwMqhRbbz5T90kxgEVg7lP3E9CtejcOE\u002fRIts5\u002fup5T8="},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"},{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"llm=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"gpt-4o-mini","marker":{"color":"#AB63FA","opacity":0.6,"size":4},"name":"gpt-4o-mini","offsetgroup":"gpt-4o-mini","orientation":"v","scalegroup":"True","showlegend":true,"x":["gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini","gpt-4o-mini"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"5dAi2\u002fl+4j\u002f2KFyPwvXgPz0K16NwPeI\u002f9ihcj8L15D8lBoGVQ4vkPylcj8L1KOQ\u002f9ihcj8L15D946SYxCKzkP\u002fYoXI\u002fC9eQ\u002f+FPjpZvE5D\u002fNzMzMzMzkP\u002fLSTWIQWOU\u002fvHSTGARW5j+gGi\u002fdJAblPz0K16NwPeI\u002fnMQgsHJo5T8="},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"},{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"llm=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"llama3.1-70b-iq2_xs","marker":{"color":"#FFA15A","opacity":0.6,"size":4},"name":"llama3.1-70b-iq2_xs","offsetgroup":"llama3.1-70b-iq2_xs","orientation":"v","scalegroup":"True","showlegend":true,"x":["llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs","llama3.1-70b-iq2_xs"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"TDeJQWDl4D\u002fsUbgehevhP4XrUbgeheM\u002f16NwPQrX4z9U46WbxCDkPxSuR+F6FOY\u002fAiuHFtnO4z8fhetRuB7lP3E9CtejcOU\u002fqMZLN4lB5D9SuB6F61HkPxSuR+F6FOY\u002flkOLbOf72T8bWmQ730\u002fVPx+F61G4HsU\u002fMzMzMzMz0z8="},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"},{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"llm=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"qwen2.5:32b","marker":{"color":"#636EFA","opacity":0.6,"size":4},"name":"qwen2.5:32b","offsetgroup":"qwen2.5:32b","orientation":"v","scalegroup":"True","showlegend":true,"x":["qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b","qwen2.5:32b"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"PQrXo3A94j+PwvUoXI\u002fiP1yPwvUoXOM\u002f0UUXXXTR5T8fhetRuB7lP+xRuB6F6+U\u002f7nw\u002fNV665T\u002fNzMzMzMzkP2ZmZmZmZuY\u002fexSuR+F65D9SuB6F61HkPxgEVg4tsuU\u002ftMh2vp8a4z+sHFpkO9\u002ffP2ZmZmZmZuI\u002fqMZLN4lB5D8="},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"llm"},"categoryorder":"array","categoryarray":["qwen2.5:32b-instruct-q2_K","gemini-2.5-flash","gpt-4o","gpt-4o-mini","llama3.1-70b-iq2_xs","qwen2.5:32b"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Correctness Score"}},"legend":{"title":{"text":"llm"},"tracegroupgap":0},"violinmode":"overlay","font":{"family":"Arial","size":14},"margin":{"l":0,"r":0,"t":30,"b":0},"height":500,"showlegend":false,"autosize":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('ce766212-85f7-4aa6-bf57-9ce567aa41b0');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 3</strong>. LLM performance distribution shows Llama 70B-IQ2’s high variance under 2-bit quantization.</p>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div id="c48096ae" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="585991c6-7273-484d-a0f7-226c120ce1aa" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("585991c6-7273-484d-a0f7-226c120ce1aa")) {                    Plotly.newPlot(                        "585991c6-7273-484d-a0f7-226c120ce1aa",                        [{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"db=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"jina-embeddings-v3","marker":{"color":"#636EFA","opacity":0.6,"size":4},"name":"jina-embeddings-v3","offsetgroup":"jina-embeddings-v3","orientation":"v","scalegroup":"True","showlegend":true,"x":["jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3","jina-embeddings-v3"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"sHJoke184z9SuB6F61HkP3E9CtejcOU\u002fZmZmZmZm5j86tMh2vp\u002fiP8ZLN4lBYOU\u002fSgwCK4cW5T8UrkfhehTmP0SLbOf7qeU\u002f9ihcj8L15D8lBoGVQ4vkPylcj8L1KOQ\u002fnMQgsHJo5T\u002fXo3A9CtfjP1TjpZvEIOQ\u002fFK5H4XoU5j8zMzMzMzPTP9FFF1100eU\u002fH4XrUbge5T\u002fsUbgehevlP2ZmZmZmZuI\u002fJQaBlUOL5D90kxgEVg7lP8P1KFyPwuU\u002f"},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"},{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"db=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"bge-m3","marker":{"color":"#EF553B","opacity":0.6,"size":4},"name":"bge-m3","offsetgroup":"bge-m3","orientation":"v","scalegroup":"True","showlegend":true,"x":["bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3","bge-m3"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"Rrbz\u002fdR44T\u002fvp8ZLN4nhPzMzMzMzM+M\u002farx0kxgE3j\u002fhehSuR+HiP8P1KFyPwuE\u002fPQrXo3A94j9xPQrXo3DhP+XQItv5fuI\u002f9ihcj8L14D89CtejcD3iPz0K16NwPeI\u002fTDeJQWDl4D\u002fsUbgehevhP4XrUbgeheM\u002fH4XrUbgexT89CtejcD3iP4\u002fC9Shcj+I\u002fXI\u002fC9Shc4z+sHFpkO9\u002ffP42XbhKDwOI\u002fj8L1KFyP4j+PwvUoXI\u002fiP6jGSzeJQeA\u002f"},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"},{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"db=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"openai-large","marker":{"color":"#00CC96","opacity":0.6,"size":4},"name":"openai-large","offsetgroup":"openai-large","orientation":"v","scalegroup":"True","showlegend":true,"x":["openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large","openai-large"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"xSCwcmiR5T8fhetRuB7lP8P1KFyPwuU\u002flkOLbOf74T8UrkfhehTmPxsv3SQGgeU\u002fZmZmZmZm5j\u002fAyqFFtvPlP\u002fYoXI\u002fC9eQ\u002feOkmMQis5D\u002f2KFyPwvXkP7x0kxgEVuY\u002fAiuHFtnO4z8fhetRuB7lP3E9CtejcOU\u002flkOLbOf72T\u002fufD81XrrlP83MzMzMzOQ\u002fZmZmZmZm5j+oxks3iUHkP83MzMzMzOQ\u002fH4XrUbge5T9xPQrXo3DlP1TjpZvEIOQ\u002f"},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"},{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"db=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"openai-small","marker":{"color":"#AB63FA","opacity":0.6,"size":4},"name":"openai-small","offsetgroup":"openai-small","orientation":"v","scalegroup":"True","showlegend":true,"x":["openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small","openai-small"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"2c73U+Ol4z8zMzMzMzPjP0jhehSuR+U\u002fnMQgsHJo4T8fhetRuB7lP9Ei2\u002fl+auQ\u002fQDVeukkM5j90kxgEVg7lP\u002fhT46WbxOQ\u002fzczMzMzM5D\u002fy0k1iEFjlP6AaL90kBuU\u002fqMZLN4lB5D9SuB6F61HkPxSuR+F6FOY\u002fG1pkO99P1T97FK5H4XrkP1K4HoXrUeQ\u002fGARWDi2y5T+0yHa+nxrjP83MzMzMzOQ\u002fzczMzMzM5D\u002fNzMzMzMzkP4xs5\u002fup8eI\u002f"},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"db"},"categoryorder":"array","categoryarray":["jina-embeddings-v3","bge-m3","openai-large","openai-small"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Correctness Score"}},"legend":{"title":{"text":"db"},"tracegroupgap":0},"violinmode":"overlay","font":{"family":"Arial","size":14},"margin":{"l":0,"r":0,"t":30,"b":0},"height":500,"showlegend":false,"autosize":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('585991c6-7273-484d-a0f7-226c120ce1aa');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 4</strong>. Embedding model performance shows free Jina-v3 matching paid OpenAI, with BGE-M3 notably worse.</p>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div id="8bc9b658" class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="d5aaa4fc-bff2-41d8-92d1-e211622f4a0a" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("d5aaa4fc-bff2-41d8-92d1-e211622f4a0a")) {                    Plotly.newPlot(                        "d5aaa4fc-bff2-41d8-92d1-e211622f4a0a",                        [{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"clean_sys=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"System D","marker":{"color":"#AB63FA","opacity":0.6,"size":4},"name":"System D","offsetgroup":"System D","orientation":"v","scalegroup":"True","showlegend":true,"x":["System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D","System D"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"sHJoke184z+WQ4ts5\u002fvhP5zEILByaOE\u002farx0kxgE3j86tMh2vp\u002fiP8DKoUW28+U\u002fdJMYBFYO5T9xPQrXo3DhP0SLbOf7qeU\u002fvHSTGARW5j+gGi\u002fdJAblPz0K16NwPeI\u002fnMQgsHJo5T+WQ4ts5\u002fvZPxtaZDvfT9U\u002fH4XrUbgexT8zMzMzMzPTP7TIdr6fGuM\u002frBxaZDvf3z9mZmZmZmbiP6jGSzeJQeQ\u002fVOOlm8Qg5D+MbOf7qfHiP6jGSzeJQeA\u002f"},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"},{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"clean_sys=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"System A","marker":{"color":"#636EFA","opacity":0.6,"size":4},"name":"System A","offsetgroup":"System A","orientation":"v","scalegroup":"True","showlegend":true,"x":["System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A","System A"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"Rrbz\u002fdR44T9SuB6F61HkP8UgsHJokeU\u002f2c73U+Ol4z\u002fhehSuR+HiP8ZLN4lBYOU\u002fFK5H4XoU5j8fhetRuB7lP+XQItv5fuI\u002f9ihcj8L15D\u002f2KFyPwvXkP\u002fhT46WbxOQ\u002fTDeJQWDl4D\u002fXo3A9CtfjPwIrhxbZzuM\u002fqMZLN4lB5D89CtejcD3iP9FFF1100eU\u002f7nw\u002fNV665T97FK5H4XrkP42XbhKDwOI\u002fJQaBlUOL5D\u002fNzMzMzMzkP83MzMzMzOQ\u002f"},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"},{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"clean_sys=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"System B","marker":{"color":"#EF553B","opacity":0.6,"size":4},"name":"System B","offsetgroup":"System B","orientation":"v","scalegroup":"True","showlegend":true,"x":["System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B","System B"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"76fGSzeJ4T9xPQrXo3DlPx+F61G4HuU\u002fMzMzMzMz4z\u002fD9Shcj8LhP0oMAiuHFuU\u002fGy\u002fdJAaB5T\u002fRItv5fmrkP\u002fYoXI\u002fC9eA\u002fJQaBlUOL5D946SYxCKzkP83MzMzMzOQ\u002f7FG4HoXr4T9U46WbxCDkPx+F61G4HuU\u002fUrgehetR5D+PwvUoXI\u002fiPx+F61G4HuU\u002fzczMzMzM5D9SuB6F61HkP4\u002fC9Shcj+I\u002fdJMYBFYO5T8fhetRuB7lP83MzMzMzOQ\u002f"},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"},{"alignmentgroup":"True","box":{"visible":true},"hovertemplate":"clean_sys=%{x}\u003cbr\u003ecorrectness_score=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"System C","marker":{"color":"#00CC96","opacity":0.6,"size":4},"name":"System C","offsetgroup":"System C","orientation":"v","scalegroup":"True","showlegend":true,"x":["System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C","System C"],"x0":" ","xaxis":"x","y":{"dtype":"f8","bdata":"MzMzMzMz4z9mZmZmZmbmP8P1KFyPwuU\u002fSOF6FK5H5T89CtejcD3iPxSuR+F6FOY\u002fZmZmZmZm5j9ANV66SQzmPz0K16NwPeI\u002fKVyPwvUo5D\u002f2KFyPwvXkP\u002fLSTWIQWOU\u002fhetRuB6F4z8UrkfhehTmP3E9CtejcOU\u002fFK5H4XoU5j9cj8L1KFzjP+xRuB6F6+U\u002fZmZmZmZm5j8YBFYOLbLlP4\u002fC9Shcj+I\u002fw\u002fUoXI\u002fC5T9xPQrXo3DlP83MzMzMzOQ\u002f"},"y0":" ","yaxis":"y","type":"violin","meanline":{"visible":true},"jitter":0.05,"points":"all"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"clean_sys"},"categoryorder":"array","categoryarray":["System A","System B","System C","System D"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Correctness Score"}},"legend":{"title":{"text":"clean_sys"},"tracegroupgap":0},"violinmode":"overlay","font":{"family":"Arial","size":14},"margin":{"l":0,"r":0,"t":30,"b":0},"height":500,"showlegend":false,"autosize":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d5aaa4fc-bff2-41d8-92d1-e211622f4a0a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 5</strong>. System architecture stability. ‘God Mode’ (System D) exhibits high variance.</p>
</div>
</div>
</div>
</div>
<p>To move beyond ranked averages, Figures 3-5 visualize correctness distributions using violin plots grouped by generator model (LLM), embedding model, and system architecture (use the tabs in Figure 3 to see Figures 4 and 5).</p>
<p>When grouped by generator model, most models exhibit relatively tight distributions centered around the mid-0.6 range. However, Llama 3.1 70B-IQ2 stands out with a much broader variance: while some configurations within this LLM perform competitively, others degrade sharply, producing a long lower tail. This suggests that the model’s performance is highly sensitive to other components of its configuration.</p>
<p>Grouping by embedding model reveals a more modest effect. OpenAI and Jina embeddings produce slightly higher median correctness and tighter distributions, while bge-m3 shows greater variance and a lower median. Importantly, embeddings seem to influence consistency more than peak performance.</p>
<p>The most striking pattern appears when results are grouped by system architecture. Systems A, B, and C exhibit relatively narrow distributions, with gradual improvements from naive retrieval (System A) to hybrid filtering/routing (System B) and light agentic control via rewriting + grading (System C). In contrast, System D (“God Mode”) shows substantially higher variance. It appears among both the highest (approaching the ~70% ceiling) and lowest-scoring configurations across the entire study. Rather than breaking through the ceiling, System D appears to be introducing failure modes with its additional complexity that appear when paired with certain models. In any case, these results suggest that increasing RAG sophistication does not necessarily translate to improved performance.</p>
<p>What are the conditions that lead to System D’s underperformance? The following sections examine this.</p>
</section>
<section id="correctness-cost-and-latency" class="level3">
<h3 class="anchored" data-anchor-id="correctness-cost-and-latency">Correctness, Cost, and Latency</h3>
<div id="8e62baa0" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  <span class="co"># Added for log calculation</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>sys_config <span class="op">=</span> {</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysA"</span>: {<span class="st">"label"</span>: <span class="st">"SysA"</span>,    <span class="st">"color"</span>: <span class="st">"#4C72B0"</span>},</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysC"</span>: {<span class="st">"label"</span>: <span class="st">"SysB"</span>,   <span class="st">"color"</span>: <span class="st">"#DD8452"</span>},</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysD"</span>: {<span class="st">"label"</span>: <span class="st">"SysC"</span>,  <span class="st">"color"</span>: <span class="st">"#55A868"</span>},</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysG"</span>: {<span class="st">"label"</span>: <span class="st">"SysD"</span>, <span class="st">"color"</span>: <span class="st">"#C44E52"</span>}</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>color_map_final <span class="op">=</span> {v[<span class="st">'label'</span>]: v[<span class="st">'color'</span>] <span class="cf">for</span> k, v <span class="kw">in</span> sys_config.items()}</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'results_table.csv'</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'db'</span>]<span class="op">=</span>df[<span class="st">'db'</span>].replace(<span class="st">'jina-embeddings-v3'</span>,<span class="st">'jina-v3'</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_system_label(name):</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key, config <span class="kw">in</span> sys_config.items():</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> key <span class="kw">in</span> name:</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> config[<span class="st">'label'</span>]</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Article_System'</span>] <span class="op">=</span> df[<span class="st">'experiment_name'</span>].<span class="bu">apply</span>(get_system_label)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>fig_main <span class="op">=</span> px.scatter(</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"latency_ms"</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"correctness_score"</span>,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"Article_System"</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    symbol<span class="op">=</span><span class="st">"db"</span>,</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"correctness_score"</span>,</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    hover_data<span class="op">=</span>[<span class="st">"llm"</span>, <span class="st">"experiment_name"</span>, <span class="st">"main_total_tokens"</span>],</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    color_discrete_map<span class="op">=</span>color_map_final</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>fig_main.add_vline(x<span class="op">=</span><span class="dv">1000</span>, line_width<span class="op">=</span><span class="dv">1</span>, line_dash<span class="op">=</span><span class="st">"dash"</span>, line_color<span class="op">=</span><span class="st">"grey"</span>, annotation_text<span class="op">=</span><span class="st">"1s UX Target"</span>)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Pareto Frontier</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>sorted_df <span class="op">=</span> df.sort_values(<span class="st">'latency_ms'</span>)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>frontier_points <span class="op">=</span> []</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>max_correctness <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> sorted_df.iterrows():</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row[<span class="st">'correctness_score'</span>] <span class="op">&gt;</span> max_correctness:</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>        frontier_points.append(row)</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>        max_correctness <span class="op">=</span> row[<span class="st">'correctness_score'</span>]</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>frontier_df <span class="op">=</span> pd.DataFrame(frontier_points)</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>fig_main.add_trace(</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    go.Scatter(</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>frontier_df[<span class="st">'latency_ms'</span>],</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>frontier_df[<span class="st">'correctness_score'</span>],</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">'Efficiency Frontier'</span>,</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>        line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>, width<span class="op">=</span><span class="dv">2</span>, dash<span class="op">=</span><span class="st">'dash'</span>)</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a><span class="co"># --- NEW: Calculate ranges dynamically ---</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>min_lat <span class="op">=</span> df[<span class="st">'latency_ms'</span>].<span class="bu">min</span>()</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>max_lat <span class="op">=</span> df[<span class="st">'latency_ms'</span>].<span class="bu">max</span>()</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Log Range (Plotly expects log10 values for range when type='log')</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding ~5% padding so bubbles don't get cut off</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>log_padding <span class="op">=</span> <span class="fl">0.1</span> </span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>range_log <span class="op">=</span> [np.log10(min_lat) <span class="op">-</span> log_padding, np.log10(max_lat) <span class="op">+</span> log_padding]</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear Range (Plotly expects absolute values)</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>lin_padding <span class="op">=</span> (max_lat <span class="op">-</span> min_lat) <span class="op">*</span> <span class="fl">0.05</span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>range_linear <span class="op">=</span> [min_lat <span class="op">-</span> lin_padding, max_lat <span class="op">+</span> lin_padding]</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Define buttons with explicit ranges</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>updatemenus <span class="op">=</span> [</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>    <span class="bu">dict</span>(</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>        <span class="bu">type</span><span class="op">=</span><span class="st">"buttons"</span>,</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>        direction<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>        buttons<span class="op">=</span><span class="bu">list</span>([</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>                args<span class="op">=</span>[{</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"xaxis.type"</span>: <span class="st">"log"</span>, </span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"xaxis.range"</span>: range_log</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>                }],</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">"Log Scale"</span>,</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>                method<span class="op">=</span><span class="st">"relayout"</span></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>                args<span class="op">=</span>[{</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"xaxis.type"</span>: <span class="st">"linear"</span>, </span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"xaxis.range"</span>: range_linear</span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>                }],</span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">"Linear Scale"</span>,</span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>                method<span class="op">=</span><span class="st">"relayout"</span></span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>        ]),</span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>        pad<span class="op">=</span>{<span class="st">"r"</span>: <span class="dv">10</span>, <span class="st">"t"</span>: <span class="dv">10</span>},</span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>        showactive<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="fl">1.15</span>,</span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>        bgcolor<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>        bordercolor<span class="op">=</span><span class="st">"#c7c7c7"</span></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Set default start to log</span></span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>fig_main.update_xaxes(<span class="bu">type</span><span class="op">=</span><span class="st">"log"</span>, <span class="bu">range</span><span class="op">=</span>range_log, title<span class="op">=</span><span class="st">"Latency (ms)"</span>)</span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>fig_main.update_yaxes(title<span class="op">=</span><span class="st">"Correctness Score"</span>)</span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>fig_main.update_layout(</span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">700</span>, <span class="co"># Good height for mobile</span></span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MARGINS:</span></span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># t=100: Extra room at top for Title + Buttons</span></span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>    <span class="co"># b=100: Extra room at bottom for the Legend</span></span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">100</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>    legend_title_text<span class="op">=</span><span class="st">"Architecture"</span>,</span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>    updatemenus<span class="op">=</span>updatemenus,</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>    <span class="co"># LEGEND CONFIGURATION</span></span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We place it horizontally at the very bottom. </span></span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Since labels are short ("SysA"), they fit in one row on mobile.</span></span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,      <span class="co"># Horizontal (The "columns" you wanted)</span></span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.15</span>,              <span class="co"># Push it below the X-axis</span></span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span>                 <span class="co"># Center it</span></span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>fig_main.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="a1205fb0-be95-402f-ad52-235eb1fb491c" class="plotly-graph-div" style="height:700px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("a1205fb0-be95-402f-ad52-235eb1fb491c")) {                    Plotly.newPlot(                        "a1205fb0-be95-402f-ad52-235eb1fb491c",                        [{"customdata":[["qwen2.5:32b-instruct-q2_K","SysG_v4_GodMode_qwen2.5:32b-instruct-q2_K_jina-embeddings-v3",4981.63],["gemini-flash-latest","SysG_v4_GodMode_gemini-flash-latest_jina-embeddings-v3",1057.63],["gpt-4o","SysG_v4_GodMode_gpt-4o_jina-embeddings-v3",1568.23],["gpt-4o-mini","SysG_v4_GodMode_gpt-4o-mini_jina-embeddings-v3",1605.19],["llama3.1-70b-iq2_xs","SysG_v4_GodMode_llama3.1-70b-iq2_xs_jina-embeddings-v3",4906.21],["qwen2.5:32b","SysG_v4_GodMode_qwen2.5:32b_jina-embeddings-v3",4885.97]],"hovertemplate":"Article_System=SysD\u003cbr\u003edb=jina-v3\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysD, jina-v3","marker":{"color":"#C44E52","size":{"dtype":"f8","bdata":"sHJoke184z86tMh2vp\u002fiP0SLbOf7qeU\u002fnMQgsHJo5T8zMzMzMzPTP2ZmZmZmZuI\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"circle"},"mode":"markers","name":"SysD, jina-v3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AADQDwttsUAAAFAc0bXBQAAAAL5Zd6FAAAAQ9OERp0AAAHaF5MLbQAAAprZf\u002f9FA"},"xaxis":"x","y":{"dtype":"f8","bdata":"sHJoke184z86tMh2vp\u002fiP0SLbOf7qeU\u002fnMQgsHJo5T8zMzMzMzPTP2ZmZmZmZuI\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysG_v4_GodMode_gemini-flash-latest_bge-m3",1051.58],["gpt-4o","SysG_v4_GodMode_gpt-4o_bge-m3",1577.59],["gpt-4o-mini","SysG_v4_GodMode_gpt-4o-mini_bge-m3",1622.24],["llama3.1-70b-iq2_xs","SysG_v4_GodMode_llama3.1-70b-iq2_xs_bge-m3",4795.62],["qwen2.5:32b","SysG_v4_GodMode_qwen2.5:32b_bge-m3",5040.52],["qwen2.5:32b-instruct-q2_K","SysG_v4_GodMode_qwen2.5:32b-instruct-q2_K_bge-m3",4991.59]],"hovertemplate":"Article_System=SysD\u003cbr\u003edb=bge-m3\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysD, bge-m3","marker":{"color":"#C44E52","size":{"dtype":"f8","bdata":"arx0kxgE3j9xPQrXo3DhPz0K16NwPeI\u002fH4XrUbgexT+sHFpkO9\u002ffP6jGSzeJQeA\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"diamond"},"mode":"markers","name":"SysD, bge-m3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AQDIqFlDukAAABCC7tygQAAAoFA25qVAAADeaveB1UABAD4Vo9fTQAAAUIFpD7BA"},"xaxis":"x","y":{"dtype":"f8","bdata":"arx0kxgE3j9xPQrXo3DhPz0K16NwPeI\u002fH4XrUbgexT+sHFpkO9\u002ffP6jGSzeJQeA\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysG_v4_GodMode_gemini-flash-latest_openai-large",1054.86],["gpt-4o","SysG_v4_GodMode_gpt-4o_openai-large",1563.89],["gpt-4o-mini","SysG_v4_GodMode_gpt-4o-mini_openai-large",1587.85],["llama3.1-70b-iq2_xs","SysG_v4_GodMode_llama3.1-70b-iq2_xs_openai-large",4882.69],["qwen2.5:32b","SysG_v4_GodMode_qwen2.5:32b_openai-large",4925.85],["qwen2.5:32b-instruct-q2_K","SysG_v4_GodMode_qwen2.5:32b-instruct-q2_K_openai-large",4924.04]],"hovertemplate":"Article_System=SysD\u003cbr\u003edb=openai-large\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysD, openai-large","marker":{"color":"#C44E52","size":{"dtype":"f8","bdata":"lkOLbOf74T\u002fAyqFFtvPlP7x0kxgEVuY\u002flkOLbOf72T+oxks3iUHkP1TjpZvEIOQ\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"square"},"mode":"markers","name":"SysD, openai-large","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AQDoflYNvEAAACDum1imQAAAAKFTnKlAAABjcOox4EAAAHS+7u\u002fWQAAAGEVbb7lA"},"xaxis":"x","y":{"dtype":"f8","bdata":"lkOLbOf74T\u002fAyqFFtvPlP7x0kxgEVuY\u002flkOLbOf72T+oxks3iUHkP1TjpZvEIOQ\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysG_v4_GodMode_gemini-flash-latest_openai-small",1053.27],["gpt-4o","SysG_v4_GodMode_gpt-4o_openai-small",1561.45],["gpt-4o-mini","SysG_v4_GodMode_gpt-4o-mini_openai-small",1593.5],["llama3.1-70b-iq2_xs","SysG_v4_GodMode_llama3.1-70b-iq2_xs_openai-small",5053.75],["qwen2.5:32b","SysG_v4_GodMode_qwen2.5:32b_openai-small",4950.71],["qwen2.5:32b-instruct-q2_K","SysG_v4_GodMode_qwen2.5:32b-instruct-q2_K_openai-small",5050.66]],"hovertemplate":"Article_System=SysD\u003cbr\u003edb=openai-small\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysD, openai-small","marker":{"color":"#C44E52","size":{"dtype":"f8","bdata":"nMQgsHJo4T90kxgEVg7lP6AaL90kBuU\u002fG1pkO99P1T+0yHa+nxrjP4xs5\u002fup8eI\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"x"},"mode":"markers","name":"SysD, openai-small","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AACgMomWskAAABCiNaCjQAEAAHJlCqlA\u002f\u002f9TBqNh2UAAAJaCeVDTQAAAGNaFzbNA"},"xaxis":"x","y":{"dtype":"f8","bdata":"nMQgsHJo4T90kxgEVg7lP6AaL90kBuU\u002fG1pkO99P1T+0yHa+nxrjP4xs5\u002fup8eI\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysA_Baseline_jina-embeddings-v3_gemini-flash-latest",3476.02],["gpt-4o","SysA_Baseline_jina-embeddings-v3_gpt-4o",2903.26],["gpt-4o-mini","SysA_Baseline_jina-embeddings-v3_gpt-4o-mini",2909.78],["llama3.1-70b-iq2_xs","SysA_Baseline_jina-embeddings-v3_llama3.1-70b-iq2_xs",2975.68],["qwen2.5:32b","SysA_Baseline_jina-embeddings-v3_qwen2.5:32b",3207.7373737373737],["qwen2.5:32b-instruct-q2_K","SysA_Baseline_jina-embeddings-v3_qwen2.5:32b-instruct-q2_K",3218.72]],"hovertemplate":"Article_System=SysA\u003cbr\u003edb=jina-v3\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysA, jina-v3","marker":{"color":"#4C72B0","size":{"dtype":"f8","bdata":"UrgehetR5D\u002fGSzeJQWDlP\u002fYoXI\u002fC9eQ\u002f16NwPQrX4z\u002fRRRdddNHlPyUGgZVDi+Q\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"circle"},"mode":"markers","name":"SysA, jina-v3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"\u002fv8\u002fS98Hn0AAAEDEcd2QQAAA4BfifJdAAAD0iexGwkBgKbBCu5G7QAAAMIz50a1A"},"xaxis":"x","y":{"dtype":"f8","bdata":"UrgehetR5D\u002fGSzeJQWDlP\u002fYoXI\u002fC9eQ\u002f16NwPQrX4z\u002fRRRdddNHlPyUGgZVDi+Q\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysA_Baseline_bge-m3_gemini-flash-latest",3454.57],["gpt-4o","SysA_Baseline_bge-m3_gpt-4o",2825.5],["gpt-4o-mini","SysA_Baseline_bge-m3_gpt-4o-mini",2834.53],["llama3.1-70b-iq2_xs","SysA_Baseline_bge-m3_llama3.1-70b-iq2_xs",2896.7],["qwen2.5:32b","SysA_Baseline_bge-m3_qwen2.5:32b",3127.48],["qwen2.5:32b-instruct-q2_K","SysA_Baseline_bge-m3_qwen2.5:32b-instruct-q2_K",3130.88]],"hovertemplate":"Article_System=SysA\u003cbr\u003edb=bge-m3\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysA, bge-m3","marker":{"color":"#4C72B0","size":{"dtype":"f8","bdata":"Rrbz\u002fdR44T\u002fhehSuR+HiP+XQItv5fuI\u002fTDeJQWDl4D89CtejcD3iP42XbhKDwOI\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"diamond"},"mode":"markers","name":"SysA, bge-m3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AQBA86RToEAAAECeif6LQAAAgICb5pNA\u002f\u002f+rnNSjwUAAANjKdt67QP\u002f\u002fr6EuRK1A"},"xaxis":"x","y":{"dtype":"f8","bdata":"Rrbz\u002fdR44T\u002fhehSuR+HiP+XQItv5fuI\u002fTDeJQWDl4D89CtejcD3iP42XbhKDwOI\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysA_Baseline_openai-large_gemini-flash-latest",3566.68],["gpt-4o","SysA_Baseline_openai-large_gpt-4o",2969.07],["gpt-4o-mini","SysA_Baseline_openai-large_gpt-4o-mini",2980.76],["llama3.1-70b-iq2_xs","SysA_Baseline_openai-large_llama3.1-70b-iq2_xs",3043.28],["qwen2.5:32b","SysA_Baseline_openai-large_qwen2.5:32b",3268.35],["qwen2.5:32b-instruct-q2_K","SysA_Baseline_openai-large_qwen2.5:32b-instruct-q2_K",3275.84]],"hovertemplate":"Article_System=SysA\u003cbr\u003edb=openai-large\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysA, openai-large","marker":{"color":"#4C72B0","size":{"dtype":"f8","bdata":"xSCwcmiR5T8UrkfhehTmP\u002fYoXI\u002fC9eQ\u002fAiuHFtnO4z\u002fufD81XrrlP83MzMzMzOQ\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"square"},"mode":"markers","name":"SysA, openai-large","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AADw91FKokAAAABuiW+RQAAAgHKnEZ1AAAA4TA9OxEAAAHA98PC7QAAAeIGx87BA"},"xaxis":"x","y":{"dtype":"f8","bdata":"xSCwcmiR5T8UrkfhehTmP\u002fYoXI\u002fC9eQ\u002fAiuHFtnO4z\u002fufD81XrrlP83MzMzMzOQ\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysA_Baseline_openai-small_gemini-flash-latest",3598.44],["gpt-4o","SysA_Baseline_openai-small_gpt-4o",2964.04],["gpt-4o-mini","SysA_Baseline_openai-small_gpt-4o-mini",2970.77],["llama3.1-70b-iq2_xs","SysA_Baseline_openai-small_llama3.1-70b-iq2_xs",3043.58],["qwen2.5:32b","SysA_Baseline_openai-small_qwen2.5:32b",3266.79],["qwen2.5:32b-instruct-q2_K","SysA_Baseline_openai-small_qwen2.5:32b-instruct-q2_K",3272.41]],"hovertemplate":"Article_System=SysA\u003cbr\u003edb=openai-small\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysA, openai-small","marker":{"color":"#4C72B0","size":{"dtype":"f8","bdata":"2c73U+Ol4z8fhetRuB7lP\u002fhT46WbxOQ\u002fqMZLN4lB5D97FK5H4XrkP83MzMzMzOQ\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"x"},"mode":"markers","name":"SysA, openai-small","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AADwBXYOokAAAOAYQ3GRQAAAAKuv3ZdAAACUyfQJwkAAAECgfva4QAAA8NhXa65A"},"xaxis":"x","y":{"dtype":"f8","bdata":"2c73U+Ol4z8fhetRuB7lP\u002fhT46WbxOQ\u002fqMZLN4lB5D97FK5H4XrkP83MzMzMzOQ\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysC_Hybrid_FIXED_jina-embeddings-v3_gemini-flash-latest",2212.44],["gpt-4o","SysC_Hybrid_FIXED_jina-embeddings-v3_gpt-4o",1732.5],["gpt-4o-mini","SysC_Hybrid_FIXED_jina-embeddings-v3_gpt-4o-mini",1739.06],["llama3.1-70b-iq2_xs","SysC_Hybrid_FIXED_jina-embeddings-v3_llama3.1-70b-iq2_xs",1765.23],["qwen2.5:32b","SysC_Hybrid_FIXED_jina-embeddings-v3_qwen2.5:32b",1913.65],["qwen2.5:32b-instruct-q2_K","SysC_Hybrid_FIXED_jina-embeddings-v3_qwen2.5:32b-instruct-q2_K",1922.35]],"hovertemplate":"Article_System=SysB\u003cbr\u003edb=jina-v3\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysB, jina-v3","marker":{"color":"#DD8452","size":{"dtype":"f8","bdata":"cT0K16Nw5T9KDAIrhxblPyUGgZVDi+Q\u002fVOOlm8Qg5D8fhetRuB7lP3STGARWDuU\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"circle"},"mode":"markers","name":"SysB, jina-v3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AABAdX\u002f2n0AAAAD7\u002fT+MQAAAAPGqhZVAAADY+XUptkABADj3ZGq6QAAAIPwFq6RA"},"xaxis":"x","y":{"dtype":"f8","bdata":"cT0K16Nw5T9KDAIrhxblPyUGgZVDi+Q\u002fVOOlm8Qg5D8fhetRuB7lP3STGARWDuU\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysC_Hybrid_FIXED_bge-m3_gemini-flash-latest",2166.74],["gpt-4o","SysC_Hybrid_FIXED_bge-m3_gpt-4o",1679.44],["gpt-4o-mini","SysC_Hybrid_FIXED_bge-m3_gpt-4o-mini",1682.33],["llama3.1-70b-iq2_xs","SysC_Hybrid_FIXED_bge-m3_llama3.1-70b-iq2_xs",1715.49],["qwen2.5:32b","SysC_Hybrid_FIXED_bge-m3_qwen2.5:32b",1853.97],["qwen2.5:32b-instruct-q2_K","SysC_Hybrid_FIXED_bge-m3_qwen2.5:32b-instruct-q2_K",1859.23]],"hovertemplate":"Article_System=SysB\u003cbr\u003edb=bge-m3\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysB, bge-m3","marker":{"color":"#DD8452","size":{"dtype":"f8","bdata":"76fGSzeJ4T\u002fD9Shcj8LhP\u002fYoXI\u002fC9eA\u002f7FG4HoXr4T+PwvUoXI\u002fiP4\u002fC9Shcj+I\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"diamond"},"mode":"markers","name":"SysB, bge-m3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AABASgvEnkAAAIBkMqmHQAEAwEuHp5BAAABYwhaatkAAAMh99D+yQAAA4H+e86JA"},"xaxis":"x","y":{"dtype":"f8","bdata":"76fGSzeJ4T\u002fD9Shcj8LhP\u002fYoXI\u002fC9eA\u002f7FG4HoXr4T+PwvUoXI\u002fiP4\u002fC9Shcj+I\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysC_Hybrid_FIXED_openai-large_gemini-flash-latest",2215.42],["gpt-4o","SysC_Hybrid_FIXED_openai-large_gpt-4o",1790.19],["gpt-4o-mini","SysC_Hybrid_FIXED_openai-large_gpt-4o-mini",1795.2],["llama3.1-70b-iq2_xs","SysC_Hybrid_FIXED_openai-large_llama3.1-70b-iq2_xs",1820.67],["qwen2.5:32b","SysC_Hybrid_FIXED_openai-large_qwen2.5:32b",1967.11],["qwen2.5:32b-instruct-q2_K","SysC_Hybrid_FIXED_openai-large_qwen2.5:32b-instruct-q2_K",1971.37]],"hovertemplate":"Article_System=SysB\u003cbr\u003edb=openai-large\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysB, openai-large","marker":{"color":"#DD8452","size":{"dtype":"f8","bdata":"H4XrUbge5T8bL90kBoHlP3jpJjEIrOQ\u002fH4XrUbge5T\u002fNzMzMzMzkPx+F61G4HuU\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"square"},"mode":"markers","name":"SysB, openai-large","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"\u002f\u002f9fbc10nUAAAADRxT+KQAAAoCkzL5VAAADIT46ytUAAAJAt1jGyQAEAQHNwJqVA"},"xaxis":"x","y":{"dtype":"f8","bdata":"H4XrUbge5T8bL90kBoHlP3jpJjEIrOQ\u002fH4XrUbge5T\u002fNzMzMzMzkPx+F61G4HuU\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysC_Hybrid_FIXED_openai-small_gemini-flash-latest",2264.11],["gpt-4o","SysC_Hybrid_FIXED_openai-small_gpt-4o",1775.69],["gpt-4o-mini","SysC_Hybrid_FIXED_openai-small_gpt-4o-mini",1781.34],["llama3.1-70b-iq2_xs","SysC_Hybrid_FIXED_openai-small_llama3.1-70b-iq2_xs",1816.02],["qwen2.5:32b","SysC_Hybrid_FIXED_openai-small_qwen2.5:32b",1954.66],["qwen2.5:32b-instruct-q2_K","SysC_Hybrid_FIXED_openai-small_qwen2.5:32b-instruct-q2_K",1961.82]],"hovertemplate":"Article_System=SysB\u003cbr\u003edb=openai-small\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysB, openai-small","marker":{"color":"#DD8452","size":{"dtype":"f8","bdata":"MzMzMzMz4z\u002fRItv5fmrkP83MzMzMzOQ\u002fUrgehetR5D9SuB6F61HkP83MzMzMzOQ\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"x"},"mode":"markers","name":"SysB, openai-small","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AADA+XxyoEAAAIDxhMGKQAAAoAxuBJNAAADYBzIotkAAAEBXJbmxQAAA8PTWg6VA"},"xaxis":"x","y":{"dtype":"f8","bdata":"MzMzMzMz4z\u002fRItv5fmrkP83MzMzMzOQ\u002fUrgehetR5D9SuB6F61HkP83MzMzMzOQ\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysD_v5_FIXED_jina-embeddings-v3_gemini-flash-latest",3273.37],["gpt-4o","SysD_v5_FIXED_jina-embeddings-v3_gpt-4o",1917.71],["gpt-4o-mini","SysD_v5_FIXED_jina-embeddings-v3_gpt-4o-mini",2040.94],["llama3.1-70b-iq2_xs","SysD_v5_FIXED_jina-embeddings-v3_llama3.1-70b-iq2_xs",2105.71],["qwen2.5:32b","SysD_v5_FIXED_jina-embeddings-v3_qwen2.5:32b",2173.18],["qwen2.5:32b-instruct-q2_K","SysD_v5_FIXED_jina-embeddings-v3_qwen2.5:32b-instruct-q2_K",2082.83]],"hovertemplate":"Article_System=SysC\u003cbr\u003edb=jina-v3\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysC, jina-v3","marker":{"color":"#55A868","size":{"dtype":"f8","bdata":"ZmZmZmZm5j8UrkfhehTmPylcj8L1KOQ\u002fFK5H4XoU5j\u002fsUbgehevlP8P1KFyPwuU\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"circle"},"mode":"markers","name":"SysC, jina-v3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AADYH\u002fhJsUAAAMCEzlmPQP\u002f\u002ff2boq5FAAAAIVK+OtUAAADCGrayyQAEAYOq5WqlA"},"xaxis":"x","y":{"dtype":"f8","bdata":"ZmZmZmZm5j8UrkfhehTmPylcj8L1KOQ\u002fFK5H4XoU5j\u002fsUbgehevlP8P1KFyPwuU\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysD_v5_FIXED_bge-m3_gemini-flash-latest",3167.16],["gpt-4o","SysD_v5_FIXED_bge-m3_gpt-4o",1686.27],["gpt-4o-mini","SysD_v5_FIXED_bge-m3_gpt-4o-mini",1862.69],["llama3.1-70b-iq2_xs","SysD_v5_FIXED_bge-m3_llama3.1-70b-iq2_xs",1901.23],["qwen2.5:32b","SysD_v5_FIXED_bge-m3_qwen2.5:32b",1899.1],["qwen2.5:32b-instruct-q2_K","SysD_v5_FIXED_bge-m3_qwen2.5:32b-instruct-q2_K",1846.22]],"hovertemplate":"Article_System=SysC\u003cbr\u003edb=bge-m3\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysC, bge-m3","marker":{"color":"#55A868","size":{"dtype":"f8","bdata":"MzMzMzMz4z89CtejcD3iPz0K16NwPeI\u002fhetRuB6F4z9cj8L1KFzjP4\u002fC9Shcj+I\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"diamond"},"mode":"markers","name":"SysC, bge-m3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AADAZl5asUAAAMCctpeIQAEAgBGbco9AAAD4mMk8s0AAAAA5oeumQAAAQGPNoKZA"},"xaxis":"x","y":{"dtype":"f8","bdata":"MzMzMzMz4z89CtejcD3iPz0K16NwPeI\u002fhetRuB6F4z9cj8L1KFzjP4\u002fC9Shcj+I\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysD_v5_FIXED_openai-large_gemini-flash-latest",3301.68],["gpt-4o","SysD_v5_FIXED_openai-large_gpt-4o",1970.19],["gpt-4o-mini","SysD_v5_FIXED_openai-large_gpt-4o-mini",2078.4],["llama3.1-70b-iq2_xs","SysD_v5_FIXED_openai-large_llama3.1-70b-iq2_xs",2079.49],["qwen2.5:32b","SysD_v5_FIXED_openai-large_qwen2.5:32b",2222.35],["qwen2.5:32b-instruct-q2_K","SysD_v5_FIXED_openai-large_qwen2.5:32b-instruct-q2_K",2074.85]],"hovertemplate":"Article_System=SysC\u003cbr\u003edb=openai-large\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysC, openai-large","marker":{"color":"#55A868","size":{"dtype":"f8","bdata":"w\u002fUoXI\u002fC5T9mZmZmZmbmP\u002fYoXI\u002fC9eQ\u002fcT0K16Nw5T9mZmZmZmbmP3E9CtejcOU\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"square"},"mode":"markers","name":"SysC, openai-large","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AACI0U+psUD\u002f\u002f790+DWPQP\u002f\u002ffymdp5FAAADwVeC2s0ABALDr5sGqQAAAcCQWpalA"},"xaxis":"x","y":{"dtype":"f8","bdata":"w\u002fUoXI\u002fC5T9mZmZmZmbmP\u002fYoXI\u002fC9eQ\u002fcT0K16Nw5T9mZmZmZmbmP3E9CtejcOU\u002f"},"yaxis":"y","type":"scatter"},{"customdata":[["gemini-flash-latest","SysD_v5_FIXED_openai-small_gemini-flash-latest",3279.64],["gpt-4o","SysD_v5_FIXED_openai-small_gpt-4o",1945.59],["gpt-4o-mini","SysD_v5_FIXED_openai-small_gpt-4o-mini",2063.78],["llama3.1-70b-iq2_xs","SysD_v5_FIXED_openai-small_llama3.1-70b-iq2_xs",2070.38],["qwen2.5:32b","SysD_v5_FIXED_openai-small_qwen2.5:32b",2106.68],["qwen2.5:32b-instruct-q2_K","SysD_v5_FIXED_openai-small_qwen2.5:32b-instruct-q2_K",1997.33]],"hovertemplate":"Article_System=SysC\u003cbr\u003edb=openai-small\u003cbr\u003elatency_ms=%{x}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cbr\u003ellm=%{customdata[0]}\u003cbr\u003eexperiment_name=%{customdata[1]}\u003cbr\u003emain_total_tokens=%{customdata[2]}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysC, openai-small","marker":{"color":"#55A868","size":{"dtype":"f8","bdata":"SOF6FK5H5T9ANV66SQzmP\u002fLSTWIQWOU\u002fFK5H4XoU5j8YBFYOLbLlP83MzMzMzOQ\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"x"},"mode":"markers","name":"SysC, openai-small","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AACQduWOsUABAMBu5FSPQP\u002f\u002fvwjhco9AAACwPZJQsUAAALBkXoSnQAEA4PsV16hA"},"xaxis":"x","y":{"dtype":"f8","bdata":"SOF6FK5H5T9ANV66SQzmP\u002fLSTWIQWOU\u002fFK5H4XoU5j8YBFYOLbLlP83MzMzMzOQ\u002f"},"yaxis":"y","type":"scatter"},{"line":{"color":"black","dash":"dash","width":2},"mode":"lines","name":"Efficiency Frontier","x":{"dtype":"f8","bdata":"AACAZDKph0AAAMCctpeIQAAAANHFP4pA\u002f\u002f+\u002fdPg1j0A="},"y":{"dtype":"f8","bdata":"w\u002fUoXI\u002fC4T89CtejcD3iPxsv3SQGgeU\u002fZmZmZmZm5j8="},"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Latency (ms)"},"type":"log","range":[2.7791817005472153,4.620710462321331]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Correctness Score"}},"legend":{"title":{"text":"Architecture"},"tracegroupgap":0,"itemsizing":"constant","orientation":"h","yanchor":"top","y":-0.15,"xanchor":"center","x":0.5},"shapes":[{"line":{"color":"grey","dash":"dash","width":1},"type":"line","x0":1000,"x1":1000,"xref":"x","y0":0,"y1":1,"yref":"y domain"}],"annotations":[{"showarrow":false,"text":"1s UX Target","x":1000,"xanchor":"left","xref":"x","y":1,"yanchor":"top","yref":"y domain"}],"margin":{"l":10,"r":10,"t":100,"b":100},"height":700,"updatemenus":[{"bgcolor":"white","bordercolor":"#c7c7c7","buttons":[{"args":[{"xaxis.type":"log","xaxis.range":[2.7791817005472153,4.620710462321331]}],"label":"Log Scale","method":"relayout"},{"args":[{"xaxis.type":"linear","xaxis.range":[-863.3592249155045,34787.83504974842]}],"label":"Linear Scale","method":"relayout"}],"direction":"left","pad":{"r":10,"t":10},"showactive":true,"type":"buttons","x":0.0,"xanchor":"left","y":1.15,"yanchor":"top"}]},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a1205fb0-be95-402f-ad52-235eb1fb491c');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 6</strong>. RAG performance trade-off between correctness and latency. The efficiency frontier shows optimal configurations.</p>
</div>
<p>Figure 6 shows the trade-off between correctness and latency across all evaluated RAG configurations. Results are shown on a logarithmic scale for latency, to accommodate for the wide variance in latencies that appear in some of the more complex configurations.</p>
<p>Several patterns are immediately apparent: first, there’s a cluster of configurations in the upper left of the plot, near ~70% correctness and the 1 s threshold for latency. The configurations in these points are predominately Systems A, B, and C paired with Jina-v3 and OpenAI embeddings.</p>
<p>System C in particular exhibits a favorable balance between performance and speed. Across multiple embedding choices, its configurations populate the efficiency frontier (dotted line), showing that query rewriting and relatively light agentic control can improve retrieval performance at low cost. This observation is consistent across different System C configurations.</p>
<p>In contrast, System D (“God Mode”) displays markedly higher variance. While some System D configurations nearly reach the efficiency frontier, others suffer severe degradation – both in latency and accuracy – resulting in a wide spread in both dimensions. This spread is especially pronounced for smaller or aggressively quantized models, where additional complexity appears to suffer from rather than compensate for their simplicity.</p>
<p>The dashed line indicates the empirical efficiency frontier, showing that beyond a certain point, increases in system complexity do not reliably translate into improved performance. Notably, System D rarely sits on the frontier.</p>
<p>Altogether, these results show an overarching finding of the study: that increased complexity does not necessarily translate to increased performance – and can instead become a liability in certain conditions.</p>
<div id="618998d6" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fig_retrieval <span class="op">=</span> px.scatter(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"retrieval_recall"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"retrieval_mrr"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"Article_System"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    symbol<span class="op">=</span><span class="st">"db"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"correctness_score"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    opacity<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    color_discrete_map<span class="op">=</span>color_map_final,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span>{</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"retrieval_recall"</span>: <span class="st">"Recall (Did we find it?)"</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"retrieval_mrr"</span>: <span class="st">"MRR (Was it at the top?)"</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Article_System"</span>: <span class="st">"Architecture"</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>fig_retrieval.add_annotation(</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">1.0</span>, y<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">"&lt;b&gt;Perfect Retrieval"</span>,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    showarrow<span class="op">=</span><span class="va">True</span>, arrowhead<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=-</span><span class="dv">40</span>, ay<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"rgba(255, 255, 255, 0.8)"</span>,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    bordercolor<span class="op">=</span><span class="st">"black"</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>fig_retrieval.add_annotation(</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">0.9</span>, y<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">"&lt;b&gt;⚠️ No-Go Zone:&lt;br&gt; High Recall, Low MRR"</span>,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    showarrow<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"rgba(255, 255, 255, 0.8)"</span>,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    font<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"orange"</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>fig_retrieval.add_annotation(</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">0.7</span>, y<span class="op">=</span><span class="fl">0.75</span>,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">"&lt;b&gt;Systems C and D (Agentic)&lt;br&gt;Dominate Search&lt;/b&gt;"</span>,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    showarrow<span class="op">=</span><span class="va">True</span>, arrowhead<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=-</span><span class="dv">35</span>, ay<span class="op">=-</span><span class="dv">40</span>,</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"rgba(255, 255, 255, 0.8)"</span>,</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    bordercolor<span class="op">=</span><span class="st">"black"</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>fig_retrieval.update_layout(</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">600</span>,</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    xaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[<span class="op">-</span><span class="fl">0.05</span>, <span class="fl">1.05</span>]),</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[<span class="op">-</span><span class="fl">0.05</span>, <span class="fl">1.05</span>]),</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.15</span>,</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>        bgcolor<span class="op">=</span><span class="st">"rgba(0,0,0,0)"</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>fig_retrieval.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="c4822c7e-96eb-432e-8f54-bb6bbbe16a25" class="plotly-graph-div" style="height:600px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("c4822c7e-96eb-432e-8f54-bb6bbbe16a25")) {                    Plotly.newPlot(                        "c4822c7e-96eb-432e-8f54-bb6bbbe16a25",                        [{"hovertemplate":"Architecture=SysD\u003cbr\u003edb=jina-v3\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysD, jina-v3","marker":{"color":"#C44E52","opacity":0.7,"size":{"dtype":"f8","bdata":"sHJoke184z86tMh2vp\u002fiP0SLbOf7qeU\u002fnMQgsHJo5T8zMzMzMzPTP2ZmZmZmZuI\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"circle"},"mode":"markers","name":"SysD, jina-v3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"MzMzMzMz5z+amZmZmZnnP5qZmZmZmek\u002fAAAAAAAA6j9mZmZmZmbgPwAAAAAAAOg\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"dnfwEnxx5D\u002fxs1HA6yXjP820+B4aBeY\u002f9k\u002fC3YAw5j9mvygfQlbZP8xmqzbOZuM\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysD\u003cbr\u003edb=bge-m3\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysD, bge-m3","marker":{"color":"#C44E52","opacity":0.7,"size":{"dtype":"f8","bdata":"arx0kxgE3j9xPQrXo3DhPz0K16NwPeI\u002fH4XrUbgexT+sHFpkO9\u002ffP6jGSzeJQeA\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"diamond"},"mode":"markers","name":"SysD, bge-m3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"MzMzMzMz4z8zMzMzMzPjPwAAAAAAAOQ\u002fzczMzMzM0D8AAAAAAADiP5qZmZmZmeE\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"E5qLtkP\u002f4D8P+aYQn3fgP5Of5S27w+A\u002fqP48ycR6yz8R4FGGpCPfP6UMQqZIzN0\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysD\u003cbr\u003edb=openai-large\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysD, openai-large","marker":{"color":"#C44E52","opacity":0.7,"size":{"dtype":"f8","bdata":"lkOLbOf74T\u002fAyqFFtvPlP7x0kxgEVuY\u002flkOLbOf72T+oxks3iUHkP1TjpZvEIOQ\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"square"},"mode":"markers","name":"SysD, openai-large","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"ZmZmZmZm5j9mZmZmZmboP2ZmZmZmZug\u002fMzMzMzMz4T\u002fNzMzMzMzmPwAAAAAAAOg\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"j65v7fHo4z8K8TCbZ93lPxvotIFO2+U\u002fXog4wgdi3T+uaayb9VTkP+qKKvxdKOU\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysD\u003cbr\u003edb=openai-small\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysD, openai-small","marker":{"color":"#C44E52","opacity":0.7,"size":{"dtype":"f8","bdata":"nMQgsHJo4T90kxgEVg7lP6AaL90kBuU\u002fG1pkO99P1T+0yHa+nxrjP4xs5\u002fup8eI\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"x"},"mode":"markers","name":"SysD, openai-small","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"ZmZmZmZm5j9mZmZmZmboP2ZmZmZmZug\u002fmpmZmZmZ4T+amZmZmZnnP2ZmZmZmZuY\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"pERRHHhY4j\u002fgTaN21QXmPyD9aeTvDOU\u002f+ols1\u002fFu3D9QRNX7wdjkP+p+rVrvk+M\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysA\u003cbr\u003edb=jina-v3\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysA, jina-v3","marker":{"color":"#4C72B0","opacity":0.7,"size":{"dtype":"f8","bdata":"UrgehetR5D\u002fGSzeJQWDlP\u002fYoXI\u002fC9eQ\u002f16NwPQrX4z\u002fRRRdddNHlPyUGgZVDi+Q\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"circle"},"mode":"markers","name":"SysA, jina-v3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"AAAAAAAA5j8AAAAAAADmPwAAAAAAAOY\u002fAAAAAAAA5j8AAAAAAADmPwAAAAAAAOY\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"zczMzMxM5D\u002fNzMzMzEzkP83MzMzMTOQ\u002fzczMzMxM5D\u002fNzMzMzEzkP83MzMzMTOQ\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysA\u003cbr\u003edb=bge-m3\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysA, bge-m3","marker":{"color":"#4C72B0","opacity":0.7,"size":{"dtype":"f8","bdata":"Rrbz\u002fdR44T\u002fhehSuR+HiP+XQItv5fuI\u002fTDeJQWDl4D89CtejcD3iP42XbhKDwOI\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"diamond"},"mode":"markers","name":"SysA, bge-m3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"mpmZmZmZ4T+amZmZmZnhP5qZmZmZmeE\u002fmpmZmZmZ4T+amZmZmZnhP5qZmZmZmeE\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"7+7u7u5u4D\u002fv7u7u7m7gP+\u002fu7u7ubuA\u002f7+7u7u5u4D\u002fv7u7u7m7gP+\u002fu7u7ubuA\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysA\u003cbr\u003edb=openai-large\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysA, openai-large","marker":{"color":"#4C72B0","opacity":0.7,"size":{"dtype":"f8","bdata":"xSCwcmiR5T8UrkfhehTmP\u002fYoXI\u002fC9eQ\u002fAiuHFtnO4z\u002fufD81XrrlP83MzMzMzOQ\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"square"},"mode":"markers","name":"SysA, openai-large","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"ZmZmZmZm5j9mZmZmZmbmP2ZmZmZmZuY\u002fZmZmZmZm5j9mZmZmZmbmP2ZmZmZmZuY\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"3lOkqyBx5D\u002feU6SrIHHkP95TpKsgceQ\u002f3lOkqyBx5D\u002feU6SrIHHkP95TpKsgceQ\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysA\u003cbr\u003edb=openai-small\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysA, openai-small","marker":{"color":"#4C72B0","opacity":0.7,"size":{"dtype":"f8","bdata":"2c73U+Ol4z8fhetRuB7lP\u002fhT46WbxOQ\u002fqMZLN4lB5D97FK5H4XrkP83MzMzMzOQ\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"x"},"mode":"markers","name":"SysA, openai-small","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"mpmZmZmZ5T8zMzMzMzPlP5qZmZmZmeU\u002fmpmZmZmZ5T+amZmZmZnlP5qZmZmZmeU\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"gk4b6LSB4z8b6LSBThvjP4JOG+i0geM\u002fgk4b6LSB4z+CThvotIHjP4JOG+i0geM\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysB\u003cbr\u003edb=jina-v3\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysB, jina-v3","marker":{"color":"#DD8452","opacity":0.7,"size":{"dtype":"f8","bdata":"cT0K16Nw5T9KDAIrhxblPyUGgZVDi+Q\u002fVOOlm8Qg5D8fhetRuB7lP3STGARWDuU\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"circle"},"mode":"markers","name":"SysB, jina-v3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"mpmZmZmZ5T+amZmZmZnlP5qZmZmZmeU\u002fmpmZmZmZ5T+amZmZmZnlP5qZmZmZmeU\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"fuAHfuAH5D9+4Ad+4AfkP37gB37gB+Q\u002ffuAHfuAH5D9+4Ad+4AfkP37gB37gB+Q\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysB\u003cbr\u003edb=bge-m3\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysB, bge-m3","marker":{"color":"#DD8452","opacity":0.7,"size":{"dtype":"f8","bdata":"76fGSzeJ4T\u002fD9Shcj8LhP\u002fYoXI\u002fC9eA\u002f7FG4HoXr4T+PwvUoXI\u002fiP4\u002fC9Shcj+I\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"diamond"},"mode":"markers","name":"SysB, bge-m3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"MzMzMzMz4T8zMzMzMzPhPzMzMzMzM+E\u002fMzMzMzMz4T8zMzMzMzPhPzMzMzMzM+E\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"zczMzMxM4D\u002fNzMzMzEzgP83MzMzMTOA\u002fzczMzMxM4D\u002fNzMzMzEzgP83MzMzMTOA\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysB\u003cbr\u003edb=openai-large\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysB, openai-large","marker":{"color":"#DD8452","opacity":0.7,"size":{"dtype":"f8","bdata":"H4XrUbge5T8bL90kBoHlP3jpJjEIrOQ\u002fH4XrUbge5T\u002fNzMzMzMzkPx+F61G4HuU\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"square"},"mode":"markers","name":"SysB, openai-large","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"MzMzMzMz5T8zMzMzMzPlPzMzMzMzM+U\u002fMzMzMzMz5T8zMzMzMzPlPzMzMzMzM+U\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"ZmZmZmam5D9mZmZmZqbkP2ZmZmZmpuQ\u002fZmZmZmam5D9mZmZmZqbkP2ZmZmZmpuQ\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysB\u003cbr\u003edb=openai-small\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysB, openai-small","marker":{"color":"#DD8452","opacity":0.7,"size":{"dtype":"f8","bdata":"MzMzMzMz4z\u002fRItv5fmrkP83MzMzMzOQ\u002fUrgehetR5D9SuB6F61HkP83MzMzMzOQ\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"x"},"mode":"markers","name":"SysB, openai-small","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"zczMzMzM5D9mZmZmZmbkP83MzMzMzOQ\u002fzczMzMzM5D\u002fNzMzMzMzkP83MzMzMzOQ\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"4noUrkfh4j97FK5H4XriP+J6FK5H4eI\u002f4noUrkfh4j\u002fiehSuR+HiP+J6FK5H4eI\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysC\u003cbr\u003edb=jina-v3\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysC, jina-v3","marker":{"color":"#55A868","opacity":0.7,"size":{"dtype":"f8","bdata":"ZmZmZmZm5j8UrkfhehTmPylcj8L1KOQ\u002fFK5H4XoU5j\u002fsUbgehevlP8P1KFyPwuU\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"circle"},"mode":"markers","name":"SysC, jina-v3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"MzMzMzMz5z+amZmZmZnnPzMzMzMzM+c\u002fzczMzMzM5j+amZmZmZnnP5qZmZmZmec\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"bc\u002f2bM925T\u002fTNV3TNd3lP23P9mzPduU\u002f7h0SVYT45D9WYzVWY7XlP4J9Pk5Ki+U\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysC\u003cbr\u003edb=bge-m3\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysC, bge-m3","marker":{"color":"#55A868","opacity":0.7,"size":{"dtype":"f8","bdata":"MzMzMzMz4z89CtejcD3iPz0K16NwPeI\u002fhetRuB6F4z9cj8L1KFzjP4\u002fC9Shcj+I\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"diamond"},"mode":"markers","name":"SysC, bge-m3","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"zczMzMzM4j8zMzMzMzPjP83MzMzMzOI\u002fZmZmZmZm4j8zMzMzMzPjP83MzMzMzOI\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"IiIiIiKi4T+JiIiIiAjiPyIiIiIiouE\u002fAAAAAACA4T8zMzMzM7PhPyIiIiIiouE\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysC\u003cbr\u003edb=openai-large\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysC, openai-large","marker":{"color":"#55A868","opacity":0.7,"size":{"dtype":"f8","bdata":"w\u002fUoXI\u002fC5T9mZmZmZmbmP\u002fYoXI\u002fC9eQ\u002fcT0K16Nw5T9mZmZmZmbmP3E9CtejcOU\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"square"},"mode":"markers","name":"SysC, openai-large","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"MzMzMzMz5z8AAAAAAADoPwAAAAAAAOg\u002fMzMzMzMz5z8AAAAAAADoPwAAAAAAAOg\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"AAAAAABA5j8AAAAAAMDmPyIiIiIiYuY\u002fAAAAAABA5j+8u7u7u3vmP5qZmZmZ2eY\u002f"},"yaxis":"y","type":"scatter"},{"hovertemplate":"Architecture=SysC\u003cbr\u003edb=openai-small\u003cbr\u003eRecall (Did we find it?)=%{x}\u003cbr\u003eMRR (Was it at the top?)=%{y}\u003cbr\u003ecorrectness_score=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"SysC, openai-small","marker":{"color":"#55A868","opacity":0.7,"size":{"dtype":"f8","bdata":"SOF6FK5H5T9ANV66SQzmP\u002fLSTWIQWOU\u002fFK5H4XoU5j8YBFYOLbLlP83MzMzMzOQ\u002f"},"sizemode":"area","sizeref":0.0017499999999999998,"symbol":"x"},"mode":"markers","name":"SysC, openai-small","orientation":"v","showlegend":true,"x":{"dtype":"f8","bdata":"mpmZmZmZ5z8zMzMzMzPnP5qZmZmZmec\u002fzczMzMzM5j+amZmZmZnnP5qZmZmZmec\u002f"},"xaxis":"x","y":{"dtype":"f8","bdata":"0GkDnTbQ5D+dNtBpA53kPwOdNtBpA+U\u002fNtBpA5025D+H195TpKvkP79Y8oslv+Q\u002f"},"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Recall (Did we find it?)"},"range":[-0.05,1.05]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"MRR (Was it at the top?)"},"range":[-0.05,1.05]},"legend":{"title":{"text":"Architecture, db"},"tracegroupgap":0,"itemsizing":"constant","orientation":"h","yanchor":"top","y":-0.15,"xanchor":"center","x":0.5,"bgcolor":"rgba(0,0,0,0)"},"annotations":[{"arrowhead":2,"ax":-40,"ay":40,"bgcolor":"rgba(255, 255, 255, 0.8)","bordercolor":"black","showarrow":true,"text":"\u003cb\u003ePerfect Retrieval","x":1.0,"y":1.0},{"bgcolor":"rgba(255, 255, 255, 0.8)","font":{"color":"orange"},"showarrow":false,"text":"\u003cb\u003e⚠️ No-Go Zone:\u003cbr\u003e High Recall, Low MRR","x":0.9,"y":0.1},{"arrowhead":2,"ax":-35,"ay":-40,"bgcolor":"rgba(255, 255, 255, 0.8)","bordercolor":"black","showarrow":true,"text":"\u003cb\u003eSystems C and D (Agentic)\u003cbr\u003eDominate Search\u003c\u002fb\u003e","x":0.7,"y":0.75}],"margin":{"l":10,"r":10,"t":30,"b":100},"height":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('c4822c7e-96eb-432e-8f54-bb6bbbe16a25');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 7</strong>. Retrieval quality comparing recall (did we find it?) versus MRR (was it ranked first?). Systems C and D dominate.</p>
</div>
<p>Figure 7 shows Mean Reciprocal Rank (MRR) vs recall. Recall indicates whether the correct document existed in the retrieved set, while MRR indicates the average reciprocal rank of any relevant document in that retrieved set. An analogy would be: imagine you’re trying to find a needle in a haystack. Recall is whether that needle exists in the haystack at all, while MRR indicates how close that needle happened to be near the top of the pile.</p>
<p>The data points in Figure 7 show an almost linear trend. Systems C and D clearly inhabit the “head” of the line and possess the configurations with the highest recall and MRR. It appears as though Systems C and D have complementary advantages and disadvantages: System C has the highest MRR but middling recall, while System D has the highest recall but middling MRR. The performance of each system’s retrieval mechanisms are clues that could explain the differences in overall correctness for each RAG architecture, as well as the large variance in System D (see Figure 5). For System C, it seems the good MRR (positioning the relevant documents near the top of the pile) leads to not just good, but remarkably robust performance despite not having the best recall. For System D, the lower MRR seems to introduce errors that are exacerbated by certain LLMs in downstream “agentic” steps, leading to spectacular failures in certain configurations – notably in those containing Llama 3.1 70B-IQ2. The weaknesses of RAG containing this LLM are explored in detail in later sections.</p>
<div id="6bf4dcf3" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">'results_table.csv'</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_and_rename_sys(name):</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysA"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System A (Naive)"</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysC"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System B (Hybrid)"</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysD"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System C (Agentic)"</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysG"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System D (God Mode)"</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Article_System'</span>] <span class="op">=</span> df[<span class="st">'experiment_name'</span>].<span class="bu">apply</span>(clean_and_rename_sys)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>system_colors <span class="op">=</span> {</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'System A (Naive)'</span>: <span class="st">'#3498db'</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'System B (Hybrid)'</span>: <span class="st">'#f39c12'</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'System C (Agentic)'</span>: <span class="st">'#2ecc71'</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'System D (God Mode)'</span>: <span class="st">'#9b59b6'</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> system <span class="kw">in</span> <span class="bu">sorted</span>(df[<span class="st">'Article_System'</span>].unique()):</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    system_df <span class="op">=</span> df[df[<span class="st">'Article_System'</span>] <span class="op">==</span> system]</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(go.Scatter(</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>system_df[<span class="st">'main_total_tokens'</span>],</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>system_df[<span class="st">'correctness_score'</span>],</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>system,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        marker<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>            size<span class="op">=</span>system_df[<span class="st">'latency_ms'</span>]<span class="op">/</span><span class="dv">200</span>,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>            sizemode<span class="op">=</span><span class="st">'area'</span>,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>            sizemin<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>system_colors.get(system, <span class="st">'#95a5a6'</span>),</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>            opacity<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>            line<span class="op">=</span><span class="bu">dict</span>(width<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span>[<span class="ss">f"LLM: </span><span class="sc">{</span>row[<span class="st">'llm'</span>]<span class="sc">}</span><span class="ss">&lt;br&gt;Embedding: </span><span class="sc">{</span>row[<span class="st">'db'</span>]<span class="sc">}</span><span class="ss">&lt;br&gt;Latency: </span><span class="sc">{</span>row[<span class="st">'latency_ms'</span>]<span class="sc">:.0f}</span><span class="ss">ms"</span> </span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>              <span class="cf">for</span> _, row <span class="kw">in</span> system_df.iterrows()],</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span><span class="st">'&lt;b&gt;%</span><span class="sc">{text}</span><span class="st">&lt;/b&gt;&lt;br&gt;Tokens: %</span><span class="sc">{x}</span><span class="st">&lt;br&gt;Accuracy: %</span><span class="sc">{y:.2%}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;'</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>fig.add_annotation(</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="dv">2050</span>, y<span class="op">=</span><span class="fl">0.73</span>,</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">"System C: High accuracy,&lt;br&gt;Low token usage 👍"</span>,</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    showarrow<span class="op">=</span><span class="va">True</span>, arrowhead<span class="op">=</span><span class="dv">2</span>, ax<span class="op">=</span><span class="dv">0</span>, ay<span class="op">=-</span><span class="dv">40</span>,</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"rgba(46, 204, 113, 0.1)"</span>,</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>    bordercolor<span class="op">=</span><span class="st">"#2ecc71"</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>fig.add_annotation(</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="dv">4800</span>, y<span class="op">=</span><span class="fl">0.25</span>,</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">"System D with Llama:&lt;br&gt;High cost, low accuracy"</span>,</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>    showarrow<span class="op">=</span><span class="va">False</span>, arrowhead<span class="op">=</span><span class="dv">2</span>, ax<span class="op">=</span><span class="dv">20</span>, ay<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"rgba(155, 89, 182, 0.1)"</span>,</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>    bordercolor<span class="op">=</span><span class="st">"#9b59b6"</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"Token Usage (Cost Proxy)"</span>,</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"Accuracy"</span>,</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">650</span>, <span class="co"># Increased height to fit legend</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.15</span>,</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>fig.add_hline(y<span class="op">=</span><span class="fl">0.70</span>, line_dash<span class="op">=</span><span class="st">"dash"</span>, line_color<span class="op">=</span><span class="st">"gray"</span>,</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>              annotation_text<span class="op">=</span><span class="st">"70% Ceiling"</span>, annotation_position<span class="op">=</span><span class="st">"top left"</span>)</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="978444c2-3665-4450-b44d-d07dc0e7a8be" class="plotly-graph-div" style="height:650px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("978444c2-3665-4450-b44d-d07dc0e7a8be")) {                    Plotly.newPlot(                        "978444c2-3665-4450-b44d-d07dc0e7a8be",                        [{"hovertemplate":"\u003cb\u003e%{text}\u003c\u002fb\u003e\u003cbr\u003eTokens: %{x}\u003cbr\u003eAccuracy: %{y:.2%}\u003cextra\u003e\u003c\u002fextra\u003e","marker":{"color":"#3498db","line":{"color":"white","width":1},"opacity":0.7,"size":{"dtype":"f8","bdata":"NDMz2\u002fHlJEAyMzMHFNwjQAAAAK5eaSdAmpmZB8AcJ0AAAACEleoRQGZmZi5UlhVAAAAAwFNRFkCamZkViVMWQGZmZvYYeRlAMzMzj30QHkAzMzObqJoiQJqZmflljB5AZWbmV0OURkDNzEzPBWVHQJqZmTiE\u002fUlAzcxM4\u002fsWR0DNzEyWDtZBQOxXCrrypEFAAAAAb+HhQUAAAABI1fM\u002fQMzMzB\u002f\u002fujJAMzMzbr4VM0AzMzO6zrI1QGZmZk3mdzNA"},"sizemin":5,"sizemode":"area"},"mode":"markers","name":"System A (Naive)","text":["LLM: gemini-flash-latest\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 2090ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 1986ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 2341ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 2311ms","LLM: gpt-4o\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 896ms","LLM: gpt-4o\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 1079ms","LLM: gpt-4o\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 1116ms","LLM: gpt-4o\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 1116ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 1274ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 1503ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 1860ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 1527ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 9032ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 9358ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 10396ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 9236ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 7134ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 7058ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 7153ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 6390ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 3746ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 3817ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 4340ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 3894ms"],"x":{"dtype":"f8","bdata":"cT0K1yP9qkDXo3A9CiirQI\u002fC9Shc3atAexSuR+EcrEAAAAAAABOmQOxRuB6FrqZAcT0K1yMyp0CuR+F6FCinQMP1KFwPJaZAw\u002fUoXI+7pkDsUbgehUmnQNejcD2KNadAZmZmZmahpkCPwvUoXD+nQMP1KFyPxqdAXI\u002fC9SjHp0ApXI\u002fC9W6oQObtDIl5D6lAMzMzM7OIqUCuR+F6lIWpQPYoXI\u002fCdahAPQrXo3AlqUBI4XoUrpepQLgehevRkKlA"},"y":{"dtype":"f8","bdata":"Rrbz\u002fdR44T9SuB6F61HkP8UgsHJokeU\u002f2c73U+Ol4z\u002fhehSuR+HiP8ZLN4lBYOU\u002fFK5H4XoU5j8fhetRuB7lP+XQItv5fuI\u002f9ihcj8L15D\u002f2KFyPwvXkP\u002fhT46WbxOQ\u002fTDeJQWDl4D\u002fXo3A9CtfjPwIrhxbZzuM\u002fqMZLN4lB5D89CtejcD3iP9FFF1100eU\u002f7nw\u002fNV665T97FK5H4XrkP42XbhKDwOI\u002fJQaBlUOL5D\u002fNzMzMzMzkP83MzMzMzOQ\u002f"},"type":"scatter"},{"hovertemplate":"\u003cb\u003e%{text}\u003c\u002fb\u003e\u003cbr\u003eTokens: %{x}\u003cbr\u003eAccuracy: %{y:.2%}\u003cextra\u003e\u003c\u002fextra\u003e","marker":{"color":"#f39c12","line":{"color":"white","width":1},"opacity":0.7,"size":{"dtype":"f8","bdata":"zczMEKuwI0AAAAB0zHQkQMzMzBId2iJAzczMxGwNJUAzMzNDNkkOQGZmZpZ5FBJAAAAAkKfMEEBmZmY+sR8RQM7MzARRURVAzczM7F+MG0DNzMwgsh0bQGZmZhqXVxhAmpmZnDHuPEAzMzOmB148QAAAAOHUxTtAzczM\u002f2hcPECamZk6Glw3QDQzs7Lu50BAZmZm6AdKN0DNzMz0i682QDMzM48SQihAZmZmioJ0KkDOzMx0exIrQJqZmecIiitA"},"sizemin":5,"sizemode":"area"},"mode":"markers","name":"System B (Hybrid)","text":["LLM: gemini-flash-latest\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 1969ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 2046ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 1885ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 2105ms","LLM: gpt-4o\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 757ms","LLM: gpt-4o\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 904ms","LLM: gpt-4o\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 840ms","LLM: gpt-4o\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 856ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 1066ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 1377ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 1356ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 1217ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 5786ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 5673ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 5555ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 5672ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 4672ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 6762ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 4658ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 4537ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 2426ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 2646ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 2707ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 2754ms"],"x":{"dtype":"f8","bdata":"FK5H4XrtoEB7FK5H4UihQKRwPQrXTqFAH4XrUTiwoUD2KFyPwj2aQAAAAAAAEptA9ihcj8L4m0D2KFyPwr6bQLgehetRSZpACtejcD0sm0DNzMzMzAycQI\u002fC9Shc1ZtAKVyPwvXNmkBSuB6F65SbQEjhehSucpxArkfhehRgnEB7FK5H4fecQJqZmZmZ5p1APQrXo3C8nkBxPQrXo4qeQFK4HoXrDJ1AZmZmZmYJnkAUrkfhes2eQOF6FK5Hp55A"},"y":{"dtype":"f8","bdata":"76fGSzeJ4T9xPQrXo3DlPx+F61G4HuU\u002fMzMzMzMz4z\u002fD9Shcj8LhP0oMAiuHFuU\u002fGy\u002fdJAaB5T\u002fRItv5fmrkP\u002fYoXI\u002fC9eA\u002fJQaBlUOL5D946SYxCKzkP83MzMzMzOQ\u002f7FG4HoXr4T9U46WbxCDkPx+F61G4HuU\u002fUrgehetR5D+PwvUoXI\u002fiPx+F61G4HuU\u002fzczMzMzM5D9SuB6F61HkP4\u002fC9Shcj+I\u002fdJMYBFYO5T8fhetRuB7lP83MzMzMzOQ\u002f"},"type":"scatter"},{"hovertemplate":"\u003cb\u003e%{text}\u003c\u002fb\u003e\u003cbr\u003eTokens: %{x}\u003cbr\u003eAccuracy: %{y:.2%}\u003cextra\u003e\u003c\u002fextra\u003e","marker":{"color":"#2ecc71","line":{"color":"white","width":1},"opacity":0.7,"size":{"dtype":"f8","bdata":"zczMZDs2NkBmZmaZPSE2QJqZmXJHmzZAAAAAond5NkAAAABYg3oPQAAAACyEEBRAmZmZxZT5E0A0MzP\u002fXg0UQGdmZj5jIBRAzMzMHJqeFkBlZmYWG5kWQJmZmQWQIBRAZmZmXbqfOEAAAACp6pc7QAAAAG4APDlAzczM8rApNkDNzMzskFYtQM3MzIJE5zdAAQAA8+8fMUBmZmZsEhouQM3MzHTJ9ixAAQAAlhA6MEBmZmbFp2kwQGhmZkKhyy9A"},"sizemin":5,"sizemode":"area"},"mode":"markers","name":"System C (Agentic)","text":["LLM: gemini-flash-latest\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 4442ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 4426ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 4521ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 4495ms","LLM: gpt-4o\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 787ms","LLM: gpt-4o\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 1003ms","LLM: gpt-4o\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 999ms","LLM: gpt-4o\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 1003ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 1006ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 1131ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 1130ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 1006ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 4925ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 5519ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 5047ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 4433ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 2934ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 4781ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 3425ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 3010ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 2896ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 3245ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 3283ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 3180ms"],"x":{"dtype":"f8","bdata":"uB6F61G+qEAK16NwvZKpQI\u002fC9Shcy6lA4XoUrkefqUCuR+F6FFmaQKRwPQrX9p1A9ihcj8LInkCPwvUoXGaeQPYoXI\u002fCGp1A9ihcj8Ljn0DNzMzMzDygQMP1KFyPH6BAUrgeheu0nUBSuB6Fa3OgQBSuR+H6PqBA9ihcj8IsoEBmZmZmZqydQI\u002fC9Shc+qBAMzMzM7NcoUCPwvUoXHWgQHsUrkfh2JxAXI\u002fC9ahFoEAzMzMzszWgQLgehetRNZ9A"},"y":{"dtype":"f8","bdata":"MzMzMzMz4z9mZmZmZmbmP8P1KFyPwuU\u002fSOF6FK5H5T89CtejcD3iPxSuR+F6FOY\u002fZmZmZmZm5j9ANV66SQzmPz0K16NwPeI\u002fKVyPwvUo5D\u002f2KFyPwvXkP\u002fLSTWIQWOU\u002fhetRuB6F4z8UrkfhehTmP3E9CtejcOU\u002fFK5H4XoU5j9cj8L1KFzjP+xRuB6F6+U\u002fZmZmZmZm5j8YBFYOLbLlP4\u002fC9Shcj+I\u002fw\u002fUoXI\u002fC5T9xPQrXo3DlP83MzMzMzOQ\u002f"},"type":"scatter"},{"hovertemplate":"\u003cb\u003e%{text}\u003c\u002fb\u003e\u003cbr\u003eTokens: %{x}\u003cbr\u003eAccuracy: %{y:.2%}\u003cextra\u003e\u003c\u002fextra\u003e","marker":{"color":"#9b59b6","line":{"color":"white","width":1},"opacity":0.7,"size":{"dtype":"f8","bdata":"mpmZoyJONkA0M7NlDvRBQJqZmQ3tyjdANDOzs\u002fHOQEAAAAAaSatGQM3MzDBhmixAZmZm+PweKUCamZkrrJUlQGZmZiZUWyZAAAAAkAxkMEA0MzNTpwYwQGZmZprzByxAzczMnoeHLUAzM5OuxbpkQJmZ2dB8PmBAZmYmGKOHW0DNzCxLacRhQDMz83PtuFhAm5lZd+9lWUAzM\u002fNFcAlXQM3MTN8SXF1AmpkZp0RHQEAAAAA7\u002fVg5QM3MzIabjjRA"},"sizemin":5,"sizemode":"area"},"mode":"markers","name":"System D (God Mode)","text":["LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 4461ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 7181ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 4759ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 6723ms","LLM: gemini-flash-latest\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 9068ms","LLM: gpt-4o\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 2860ms","LLM: gpt-4o\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 2512ms","LLM: gpt-4o\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 2158ms","LLM: gpt-4o\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 2236ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 3278ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 3205ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 2803ms","LLM: gpt-4o-mini\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 2953ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 33167ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 25991ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 22024ms","LLM: llama3.1-70b-iq2_xs\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 28428ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 19778ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 20319ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: jina-embeddings-v3\u003cbr\u003eLatency: 18429ms","LLM: qwen2.5:32b\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 23488ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: openai-large\u003cbr\u003eLatency: 6511ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: openai-small\u003cbr\u003eLatency: 5070ms","LLM: qwen2.5:32b-instruct-q2_K\u003cbr\u003eEmbedding: bge-m3\u003cbr\u003eLatency: 4111ms"],"x":{"dtype":"f8","bdata":"exSuR6F1s0A9CtejcHuQQK5H4XoUdZBAuB6F61FukEDsUbgehYaQQMP1KFyPb5hAzczMzMxlmECPwvUoXKaYQFK4HoXrgJhAZmZmZmbPmEAAAAAAAOaYQClcj8L1WJlA9ihcj8IUmUA9CtejsBKzQAAAAADAvbNAhetRuJ67skApXI\u002fCNSqzQClcj8K1VrNA7FG4HoWws0AfhetR+BWzQJqZmZnZPbNA16NwPQo8s0Bcj8L1qLqzQKRwPQqXf7NA"},"y":{"dtype":"f8","bdata":"sHJoke184z+WQ4ts5\u002fvhP5zEILByaOE\u002farx0kxgE3j86tMh2vp\u002fiP8DKoUW28+U\u002fdJMYBFYO5T9xPQrXo3DhP0SLbOf7qeU\u002fvHSTGARW5j+gGi\u002fdJAblPz0K16NwPeI\u002fnMQgsHJo5T+WQ4ts5\u002fvZPxtaZDvfT9U\u002fH4XrUbgexT8zMzMzMzPTP7TIdr6fGuM\u002frBxaZDvf3z9mZmZmZmbiP6jGSzeJQeQ\u002fVOOlm8Qg5D+MbOf7qfHiP6jGSzeJQeA\u002f"},"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"annotations":[{"arrowhead":2,"ax":0,"ay":-40,"bgcolor":"rgba(46, 204, 113, 0.1)","bordercolor":"#2ecc71","showarrow":true,"text":"System C: High accuracy,\u003cbr\u003eLow token usage 👍","x":2050,"y":0.73},{"arrowhead":2,"ax":20,"ay":40,"bgcolor":"rgba(155, 89, 182, 0.1)","bordercolor":"#9b59b6","showarrow":false,"text":"System D with Llama:\u003cbr\u003eHigh cost, low accuracy","x":4800,"y":0.25},{"showarrow":false,"text":"70% Ceiling","x":0,"xanchor":"left","xref":"x domain","y":0.7,"yanchor":"bottom","yref":"y"}],"margin":{"l":10,"r":10,"t":30,"b":100},"legend":{"orientation":"h","yanchor":"top","y":-0.15,"xanchor":"center","x":0.5},"xaxis":{"title":{"text":"Token Usage (Cost Proxy)"}},"yaxis":{"title":{"text":"Accuracy"}},"height":650,"shapes":[{"line":{"color":"gray","dash":"dash"},"type":"line","x0":0,"x1":1,"xref":"x domain","y0":0.7,"y1":0.7,"yref":"y"}]},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('978444c2-3665-4450-b44d-d07dc0e7a8be');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 8</strong>. The economics of RAG showing token usage as a cost proxy versus accuracy. Bubble size indicates latency.</p>
</div>
<p>Figure 8 shows the relationship between correctness and token count, with latency indicated by bubble size.</p>
<p>Across all systems, performance appears to peak near a ~70% accuracy ceiling. System C occupies the most favorable region of the plot, achieving near-peak accuracy with comparatively low token usage and modest latency. This suggests that the right agentic enhancements can potentially improve RAG in the present use case beyond the baseline “naive” system, and not with an unreasonable extra cost.</p>
<p>However, System D appears to be split in performance. Some configurations showed near-peak correctness and among the lowest token use (upper left of the plot). When System D works well, it works <i>really</i> well. Other System D configurations showed the <i>highest</i> token use and the <i>lowest</i> correctness (lower right of the plot). These outlying points reflect systematic failure modes that emerge when complex agentic logic is paired with smaller or aggressively quantized models (vide infra).</p>
<p>Altogether, this figure highlights an important economic implication of RAG system design: greater architectural complexity does not guarantee improved performance. In practice, increasing control depth can amplify model weaknesses, resulting in higher costs without corresponding gains in accuracy.</p>
<div id="17ba5f9a" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># --- UPDATE: Point to evals subdirectory ---</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>EVALS_DIR <span class="op">=</span> <span class="st">"evals"</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>results_files <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> os.listdir(EVALS_DIR) <span class="cf">if</span> i.endswith(<span class="st">'jsonl'</span>) <span class="kw">and</span> <span class="kw">not</span> i.startswith(<span class="st">'gold'</span>) <span class="kw">and</span> <span class="kw">not</span> <span class="st">'llama3.1_70b_SysG'</span> <span class="kw">in</span> i]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>all_records <span class="op">=</span> []</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> results_files:</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- UPDATE: Join path with directory ---</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    full_path <span class="op">=</span> os.path.join(EVALS_DIR, f)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(full_path, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>, errors<span class="op">=</span><span class="st">"replace"</span>) <span class="im">as</span> infile:</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> infile:</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.loads(line)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                exp_name <span class="op">=</span> data.get(<span class="st">'experiment_name'</span>, <span class="st">''</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">'SysA'</span> <span class="kw">in</span> exp_name: sys_name <span class="op">=</span> <span class="st">'SysA'</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="st">'SysC'</span> <span class="kw">in</span> exp_name: sys_name <span class="op">=</span> <span class="st">'SysC'</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="st">'SysD'</span> <span class="kw">in</span> exp_name: sys_name <span class="op">=</span> <span class="st">'SysD'</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="st">'SysG'</span> <span class="kw">in</span> exp_name: sys_name <span class="op">=</span> <span class="st">'SysG'</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: sys_name <span class="op">=</span> <span class="st">'Other'</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>                all_records.append({</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'System'</span>: sys_name,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Question Type'</span>: data.get(<span class="st">'question_type'</span>, <span class="st">'unknown'</span>),</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Correctness'</span>: data.get(<span class="st">'correctness_score'</span>, <span class="dv">0</span>),</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Latency'</span>: data.get(<span class="st">'latency_ms'</span>, <span class="dv">0</span>),</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'QID'</span>: data.get(<span class="st">'question_id'</span>, <span class="va">None</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>df_qtype <span class="op">=</span> pd.DataFrame(all_records)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Map raw system names</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>SYSTEM_MAP <span class="op">=</span> {</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysA"</span>: <span class="st">"A"</span>,</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysC"</span>: <span class="st">"B"</span>,</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysD"</span>: <span class="st">"C"</span>,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysG"</span>: <span class="st">"D"</span>,</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_qtype.copy()</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"System_Article"</span>] <span class="op">=</span> df[<span class="st">"System"</span>].<span class="bu">map</span>(SYSTEM_MAP)</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with missing QID or unmapped system</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[df[<span class="st">"QID"</span>].notna() <span class="op">&amp;</span> df[<span class="st">"System_Article"</span>].notna()].copy()</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co"># If you have multiple rows per (QID, System) from multiple configs/runs,</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="co"># collapse to a single correctness per question per system.</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>df_collapsed <span class="op">=</span> (</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>    df.groupby([<span class="st">"QID"</span>, <span class="st">"System_Article"</span>], as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">"Correctness"</span>]</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>      .mean()</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot to wide: columns A/B/C/D, index QID</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>wide <span class="op">=</span> df_collapsed.pivot(index<span class="op">=</span><span class="st">"QID"</span>, columns<span class="op">=</span><span class="st">"System_Article"</span>, values<span class="op">=</span><span class="st">"Correctness"</span>)</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Bootstrap helper</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bootstrap_ci(data, n_boot<span class="op">=</span><span class="dv">10000</span>, ci<span class="op">=</span><span class="dv">95</span>, seed<span class="op">=</span><span class="dv">42</span>):</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> np.asarray(data)</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(data) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan, np.nan, np.nan</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>    rng <span class="op">=</span> np.random.default_rng(seed)</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bootstrap means</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>    boot_means <span class="op">=</span> np.empty(n_boot, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_boot):</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>        sample <span class="op">=</span> rng.choice(data, size<span class="op">=</span><span class="bu">len</span>(data), replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>        boot_means[i] <span class="op">=</span> sample.mean()</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>    alpha <span class="op">=</span> (<span class="dv">100</span> <span class="op">-</span> ci) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>    lower <span class="op">=</span> np.percentile(boot_means, alpha)</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>    upper <span class="op">=</span> np.percentile(boot_means, <span class="dv">100</span> <span class="op">-</span> alpha)</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data.mean(), lower, upper</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Compare C vs others</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="st">"C"</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>comparators <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"D"</span>]</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> []</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> comp <span class="kw">in</span> comparators:</span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep only QIDs where both systems exist</span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>    pair <span class="op">=</span> wide[[target, comp]].dropna()</span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Per-question paired delta</span></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> pair[target] <span class="op">-</span> pair[comp]</span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>    mean_delta, ci_low, ci_high <span class="op">=</span> bootstrap_ci(delta.values)</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>    rows.append({</span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Comparison"</span>: <span class="ss">f"</span><span class="sc">{</span>target<span class="sc">}</span><span class="ss"> − </span><span class="sc">{</span>comp<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Paired_Qs"</span>: <span class="bu">len</span>(delta),</span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mean_Delta"</span>: mean_delta,</span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>        <span class="st">"CI_Low"</span>: ci_low,</span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>        <span class="st">"CI_High"</span>: ci_high,</span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>summary <span class="op">=</span> pd.DataFrame(rows)</span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Plot all comparisons in one figure</span></span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>y_labels <span class="op">=</span> [<span class="ss">f"System </span><span class="sc">{</span>r[<span class="st">'Comparison'</span>]<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> _, r <span class="kw">in</span> summary.iterrows()]</span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>summary[<span class="st">"Mean_Delta"</span>],</span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>y_labels,</span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">"black"</span>),</span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a>    error_x<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a>        <span class="bu">type</span><span class="op">=</span><span class="st">"data"</span>,</span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a>        symmetric<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a>        array<span class="op">=</span>(summary[<span class="st">"CI_High"</span>] <span class="op">-</span> summary[<span class="st">"Mean_Delta"</span>]).to_list(),</span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>        arrayminus<span class="op">=</span>(summary[<span class="st">"Mean_Delta"</span>] <span class="op">-</span> summary[<span class="st">"CI_Low"</span>]).to_list(),</span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>        thickness<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="dv">8</span></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>    hovertemplate<span class="op">=</span>(</span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;b&gt;%</span><span class="sc">{y}</span><span class="st">&lt;/b&gt;&lt;br&gt;"</span> <span class="op">+</span></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mean Δ: %</span><span class="sc">{x:.4f}</span><span class="st">&lt;br&gt;"</span> <span class="op">+</span></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"Mean Δ correctness"</span></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>fig.add_vline(</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>    line_dash<span class="op">=</span><span class="st">"dash"</span>,</span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>    line_color<span class="op">=</span><span class="st">"gray"</span>,</span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>    annotation_text<span class="op">=</span><span class="st">"No difference"</span>,</span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>    annotation_position<span class="op">=</span><span class="st">"top"</span></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>    <span class="co"># title="Per-question correctness difference vs System C&lt;br&gt;&lt;sup&gt;95% bootstrap confidence intervals (paired by QID)&lt;/sup&gt;",</span></span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"Δ Correctness (C − comparator)"</span>,</span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">320</span> <span class="op">+</span> <span class="dv">40</span> <span class="op">*</span> <span class="bu">len</span>(comparators),</span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">60</span>, r<span class="op">=</span><span class="dv">40</span>, t<span class="op">=</span><span class="dv">70</span>, b<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="c14b6213-5d56-4548-9679-4adc9d368797" class="plotly-graph-div" style="height:440px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("c14b6213-5d56-4548-9679-4adc9d368797")) {                    Plotly.newPlot(                        "c14b6213-5d56-4548-9679-4adc9d368797",                        [{"error_x":{"array":[0.04362604166666666,0.04529166666666666,0.04591666666666666],"arrayminus":[0.04150104166666667,0.041374999999999995,0.043545833333333325],"symmetric":false,"thickness":2,"type":"data","width":8},"hovertemplate":"\u003cb\u003e%{y}\u003c\u002fb\u003e\u003cbr\u003eMean Δ: %{x:.4f}\u003cbr\u003e\u003cextra\u003e\u003c\u002fextra\u003e","marker":{"color":"black","size":12},"mode":"markers","name":"Mean Δ correctness","x":{"dtype":"f8","bdata":"ke18PzVemj+J+jdCGb2dP4YW2c73U7s\u002f"},"y":["System C − A","System C − B","System C − D"],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"shapes":[{"line":{"color":"gray","dash":"dash"},"type":"line","x0":0,"x1":0,"xref":"x","y0":0,"y1":1,"yref":"y domain"}],"annotations":[{"showarrow":false,"text":"No difference","x":0,"xanchor":"center","xref":"x","y":1,"yanchor":"bottom","yref":"y domain"}],"margin":{"l":60,"r":40,"t":70,"b":40},"xaxis":{"title":{"text":"Δ Correctness (C − comparator)"}},"yaxis":{"title":{}},"height":440},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('c14b6213-5d56-4548-9679-4adc9d368797');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 9</strong>. 95% bootstrap confidence intervals for mean correctness differences between pairs of RAG architectures. The difference in correctness is statistically insignficant between System C and Systems A and B, but statistically significant between Systems C and D.</p>
</div>
<p>Is System C the best in terms of correctness? With only 100 questions, there’s not enough power at present to distinguish small differences among the top systems. To assess uncertainty, paired, per-question 95% bootstrap confidence intervals were calculated for the mean correctness difference between System C and the rest.</p>
<p>Figure 9 shows that System C is not clearly superior to Systems A or B because their confidence intervals overlap zero. This raises the question: do moderately agentic routines really improve correctness over strong naive or hybrid baselines, or do they mostly impact cost, latency, and robustness? A larger, more thorough, more expensive benchmark is necessary to answer that question definitively.</p>
<p>However, Figure 9 <i>does</i> show System C confidently outperforming System D, because the interval doesn’t reach zero. However, this is mainly driven by brittle System D configurations – the “high token, low accuracy” outliers in Figure 8. Added complexity can unintentionally introduce unexpected and spectacular points of failure. In practice, that means any new “agentic” functionality should be introduced to RAG pipelines cautiously and with rigorous testing.</p>
<div id="7c8c039d" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">'results_table.csv'</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_and_rename_sys(name):</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(name, <span class="bu">str</span>): <span class="cf">return</span> <span class="bu">str</span>(name)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysA"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System A (Naive)"</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysC"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System B (Hybrid)"</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysD"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System C (Agentic)"</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysG"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System D (God Mode)"</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'experiment_name'</span> <span class="kw">in</span> df.columns:</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Article_System'</span>] <span class="op">=</span> df[<span class="st">'experiment_name'</span>].<span class="bu">apply</span>(clean_and_rename_sys)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>gap_df <span class="op">=</span> df.groupby(<span class="st">'Article_System'</span>)[[<span class="st">'correctness_score'</span>, <span class="st">'faithfulness_score'</span>]].mean().reset_index()</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>gap_melted <span class="op">=</span> gap_df.melt(id_vars<span class="op">=</span><span class="st">'Article_System'</span>, </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                         value_vars<span class="op">=</span>[<span class="st">'correctness_score'</span>, <span class="st">'faithfulness_score'</span>],</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>                         var_name<span class="op">=</span><span class="st">'Metric'</span>, value_name<span class="op">=</span><span class="st">'Score'</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>gap_melted[<span class="st">'Metric'</span>] <span class="op">=</span> gap_melted[<span class="st">'Metric'</span>].replace({</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'correctness_score'</span>: <span class="st">'Correctness (Factuality)'</span>,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'faithfulness_score'</span>: <span class="st">'Faithfulness (Instruction Following)'</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>fig_gap <span class="op">=</span> px.bar(</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    gap_melted,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"Article_System"</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"Score"</span>,</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"Metric"</span>,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    barmode<span class="op">=</span><span class="st">"group"</span>,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    color_discrete_map<span class="op">=</span>{</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Correctness (Factuality)"</span>: <span class="st">"#2c3e50"</span>,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Faithfulness (Instruction Following)"</span>: <span class="st">"#18bc9c"</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    text_auto<span class="op">=</span><span class="st">'.2f'</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>fig_gap.update_layout(</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="fl">1.05</span>], title<span class="op">=</span><span class="st">"Score (0-1)"</span>),</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="va">None</span>, <span class="co"># Remove fixed width=800 so it fills screen</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>, </span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>, </span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.2</span>, </span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>, </span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>fig_gap.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="e1afdd45-eeb0-4a83-94f7-fc108ae982df" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("e1afdd45-eeb0-4a83-94f7-fc108ae982df")) {                    Plotly.newPlot(                        "e1afdd45-eeb0-4a83-94f7-fc108ae982df",                        [{"alignmentgroup":"True","hovertemplate":"Metric=Correctness (Factuality)\u003cbr\u003eArticle_System=%{x}\u003cbr\u003eScore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Correctness (Factuality)","marker":{"color":"#2c3e50","pattern":{"shape":""}},"name":"Correctness (Factuality)","offsetgroup":"Correctness (Factuality)","orientation":"v","showlegend":true,"textposition":"auto","texttemplate":"%{y:.2f}","x":["System A (Naive)","System B (Hybrid)","System C (Agentic)","System D (God Mode)"],"xaxis":"x","y":{"dtype":"f8","bdata":"2rwBNIIm5D\u002fwp8ZLNwnkP8Rn2BUg9+Q\u002f80T9G6GM4T8="},"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"Metric=Faithfulness (Instruction Following)\u003cbr\u003eArticle_System=%{x}\u003cbr\u003eScore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Faithfulness (Instruction Following)","marker":{"color":"#18bc9c","pattern":{"shape":""}},"name":"Faithfulness (Instruction Following)","offsetgroup":"Faithfulness (Instruction Following)","orientation":"v","showlegend":true,"textposition":"auto","texttemplate":"%{y:.2f}","x":["System A (Naive)","System B (Hybrid)","System C (Agentic)","System D (God Mode)"],"xaxis":"x","y":{"dtype":"f8","bdata":"of0lLfdt6T9kzF1LyIfsP88ZUdobfOw\u002fNO84RUfy6T8="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Score (0-1)"},"range":[0,1.05]},"legend":{"title":{"text":"Metric"},"tracegroupgap":0,"orientation":"h","yanchor":"top","y":-0.2,"xanchor":"center","x":0.5},"barmode":"group","margin":{"l":10,"r":10,"t":30,"b":100},"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e1afdd45-eeb0-4a83-94f7-fc108ae982df');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 10</strong>. The hallucination gap comparing correctness (factuality) versus faithfulness (instruction following) by system.</p>
</div>
<p>Figure 10 compares the average correctness (factual accuracy) and faithfulness (instruction following) in each RAG architecture. The stark variation in correctness has already been discussed, but it contrasts with faithfulness, which is relatively high and constant throughout each of the architectures.</p>
<p>Because correctness and faithfulness don’t appear to <i>strongly</i> correlate, any failures in the RAG systems studied here are not due to classical “hallucinations”. Even in configurations where accuracy degrades, particularly in System D, instructions are still followed faithfully. In practice, this means that the spectacular failures of System D in some configurations are not due to a lack of faithfulness. Any errors in accuracy likely arise early in the RAG chain and then are carried along in the pipeline. This observation reinforces a central theme of the study: improving RAG performance requires not only better language models, but also careful attention to the reliability of the control logic in the pipeline.</p>
<div id="d2905ee5" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'results_table.csv'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>naive_df <span class="op">=</span> df[df[<span class="st">'sys'</span>] <span class="op">==</span> <span class="st">'SysA'</span>]</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>recall_5 <span class="op">=</span> naive_df[<span class="st">'recall_at_5'</span>].mean()</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>recall_10 <span class="op">=</span> naive_df[<span class="st">'recall_at_10'</span>].mean()</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>recall_20 <span class="op">=</span> naive_df[<span class="st">'retrieval_recall'</span>].mean()</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>k_values <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>]</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>recall_scores <span class="op">=</span> [recall_5, recall_10, recall_20]</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>token_costs <span class="op">=</span> [<span class="dv">5</span> <span class="op">*</span> <span class="dv">250</span>, <span class="dv">10</span> <span class="op">*</span> <span class="dv">250</span>, <span class="dv">20</span> <span class="op">*</span> <span class="dv">250</span>] </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>k_values, y<span class="op">=</span>recall_scores,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"Recall (Accuracy Ceiling)"</span>,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'lines+markers'</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#2ecc71'</span>, width<span class="op">=</span><span class="dv">4</span>),</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>),</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="st">'y1'</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>k_values, y<span class="op">=</span>token_costs,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"Token Cost (Linear Growth)"</span>,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'lines+markers'</span>,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#e74c3c'</span>, width<span class="op">=</span><span class="dv">3</span>, dash<span class="op">=</span><span class="st">'dot'</span>),</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, symbol<span class="op">=</span><span class="st">'square'</span>),</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="st">'y2'</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>fig.add_annotation(</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="dv">20</span>, y<span class="op">=</span>recall_20,</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">"&lt;b&gt;Diminishing Returns&lt;/b&gt;&lt;br&gt;4x Cost for &lt;1</span><span class="sc">% G</span><span class="st">ain"</span>,</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    showarrow<span class="op">=</span><span class="va">True</span>, arrowhead<span class="op">=</span><span class="dv">2</span>, ax<span class="op">=</span><span class="dv">0</span>, ay<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"rgba(255, 255, 255, 0.8)"</span>, bordercolor<span class="op">=</span><span class="st">"orange"</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    xaxis<span class="op">=</span><span class="bu">dict</span>(title<span class="op">=</span><span class="st">"Chunks Retrieved (k)"</span>, tickvals<span class="op">=</span>[<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>]),</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Recall Score"</span>, </span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>        title_font<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"#2ecc71"</span>),</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>        tickfont<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"#2ecc71"</span>),</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>        <span class="bu">range</span><span class="op">=</span>[<span class="fl">0.6</span>, <span class="fl">0.75</span>]</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    yaxis2<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Est. Tokens"</span>,</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>        title_font<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"#e74c3c"</span>),</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>        tickfont<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"#e74c3c"</span>),</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>        overlaying<span class="op">=</span><span class="st">'y'</span>,</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>        side<span class="op">=</span><span class="st">'right'</span>,</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>        <span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="dv">6000</span>]</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">550</span>,</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.2</span>,</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>        bgcolor<span class="op">=</span><span class="st">"rgba(0,0,0,0)"</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="acb40941-7ef0-4e8f-872b-cb92f02a66b0" class="plotly-graph-div" style="height:550px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("acb40941-7ef0-4e8f-872b-cb92f02a66b0")) {                    Plotly.newPlot(                        "acb40941-7ef0-4e8f-872b-cb92f02a66b0",                        [{"line":{"color":"#2ecc71","width":4},"marker":{"size":12},"mode":"lines+markers","name":"Recall (Accuracy Ceiling)","x":[5,10,20],"y":[0.6432291666666666,0.6541666666666667,0.6526041666666668],"yaxis":"y","type":"scatter"},{"line":{"color":"#e74c3c","dash":"dot","width":3},"marker":{"size":10,"symbol":"square"},"mode":"lines+markers","name":"Token Cost (Linear Growth)","x":[5,10,20],"y":[1250,2500,5000],"yaxis":"y2","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"annotations":[{"arrowhead":2,"ax":0,"ay":40,"bgcolor":"rgba(255, 255, 255, 0.8)","bordercolor":"orange","showarrow":true,"text":"\u003cb\u003eDiminishing Returns\u003c\u002fb\u003e\u003cbr\u003e4x Cost for \u003c1% Gain","x":20,"y":0.6526041666666668}],"xaxis":{"title":{"text":"Chunks Retrieved (k)"},"tickvals":[5,10,20]},"yaxis":{"title":{"text":"Recall Score","font":{"color":"#2ecc71"}},"tickfont":{"color":"#2ecc71"},"range":[0.6,0.75]},"yaxis2":{"title":{"text":"Est. Tokens","font":{"color":"#e74c3c"}},"tickfont":{"color":"#e74c3c"},"overlaying":"y","side":"right","range":[0,6000]},"margin":{"l":10,"r":10,"t":30,"b":100},"legend":{"orientation":"h","yanchor":"top","y":-0.2,"xanchor":"center","x":0.5,"bgcolor":"rgba(0,0,0,0)"},"height":550},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('acb40941-7ef0-4e8f-872b-cb92f02a66b0');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 11</strong>. The diminishing returns of increasing context size (k) in naive RAG—costs grow linearly while recall saturates.</p>
</div>
<p>Figure 11 examines the effect of k – the number of documents retrieved – on recall and token usage in the naive RAG baseline (System A). This analysis was motivated by an observation, after completing all experiments, that token use by System A was relatively high among the different RAG systems in this study (see Figure 8). This raised the possibility that the value chosen for k (20) was a little too high. Figure 11 shows that recall rapidly improves up to about k=5 to 10, but only modestly improves beyond that, while token use continues to grow linearly. While similar performance in System A in the experiments of this study would have probably been observed with a lower k and incurred smaller token costs, this highlight a general pattern that recurs through this study: retrieval recall often saturates well before system costs do.</p>
<div id="a2db1b32" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw -&gt; paper naming</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>SYSTEM_MAP <span class="op">=</span> {</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysA"</span>: <span class="st">"A"</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysC"</span>: <span class="st">"B"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysD"</span>: <span class="st">"C"</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysG"</span>: <span class="st">"D"</span>,  <span class="co"># God Mode</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --- UPDATE: Point to evals subdirectory ---</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>EVALS_DIR <span class="op">=</span> <span class="st">"evals"</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>results_files <span class="op">=</span> [</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(EVALS_DIR)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> f.startswith(<span class="st">"evaluation_results"</span>) <span class="kw">and</span> f.endswith(<span class="st">".jsonl"</span>) <span class="kw">and</span> <span class="kw">not</span> f.startswith(<span class="st">"gold"</span>) <span class="kw">and</span> <span class="kw">not</span> <span class="st">'llama3.1_70b_SysG'</span> <span class="kw">in</span> f</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>all_records <span class="op">=</span> []</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> infer_raw_system(exp_name: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check longer/more specific tokens first</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> raw <span class="kw">in</span> [<span class="st">"SysG"</span>, <span class="st">"SysD"</span>, <span class="st">"SysC"</span>, <span class="st">"SysA"</span>]:</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> raw <span class="kw">in</span> exp_name:</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> raw</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"Other"</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> results_files:</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- UPDATE: Join path with directory ---</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    full_path <span class="op">=</span> os.path.join(EVALS_DIR, f)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(full_path, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>,errors<span class="op">=</span><span class="st">"replace"</span>) <span class="im">as</span> infile:</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> infile:</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.loads(line)</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>            exp_name <span class="op">=</span> data.get(<span class="st">"experiment_name"</span>, <span class="st">""</span>)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>            raw_sys <span class="op">=</span> infer_raw_system(exp_name)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>            paper_sys <span class="op">=</span> SYSTEM_MAP.get(raw_sys, raw_sys)</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>            all_records.append({</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">"System"</span>: paper_sys,</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Question Type"</span>: data.get(<span class="st">"question_type"</span>, <span class="st">"unknown"</span>),</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Correctness"</span>: data.get(<span class="st">"correctness_score"</span>, <span class="dv">0</span>),</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Latency"</span>: data.get(<span class="st">"latency_ms"</span>, <span class="dv">0</span>),</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>df_qtype <span class="op">=</span> pd.DataFrame(all_records)</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>summary_df <span class="op">=</span> (</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>    df_qtype</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"System"</span>, <span class="st">"Question Type"</span>], as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">"Correctness"</span>]</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>    .mean()</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.bar(</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>    summary_df,</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"Question Type"</span>,</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"Correctness"</span>,</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"System"</span>,</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>    barmode<span class="op">=</span><span class="st">"group"</span>,</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>    color_discrete_map<span class="op">=</span>{</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>        <span class="st">"A"</span>: <span class="st">"#4C72B0"</span>,</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>        <span class="st">"B"</span>: <span class="st">"#DD8452"</span>,</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>        <span class="st">"C"</span>: <span class="st">"#55A868"</span>,</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>        <span class="st">"D"</span>: <span class="st">"#C44E52"</span>,</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="fl">1.05</span>], title<span class="op">=</span><span class="st">"Avg Correctness Score"</span>),</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"Question Category"</span>,</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>    legend_title<span class="op">=</span><span class="st">"Sys"</span>,</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">550</span>,</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.25</span>, <span class="co"># Push further down because x-axis labels (categories) might wrap</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="214e54ff-4032-41c1-a886-83ce796982af" class="plotly-graph-div" style="height:550px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("214e54ff-4032-41c1-a886-83ce796982af")) {                    Plotly.newPlot(                        "214e54ff-4032-41c1-a886-83ce796982af",                        [{"alignmentgroup":"True","hovertemplate":"System=A\u003cbr\u003eQuestion Type=%{x}\u003cbr\u003eCorrectness=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"A","marker":{"color":"#4C72B0","pattern":{"shape":""}},"name":"A","offsetgroup":"A","orientation":"v","showlegend":true,"textposition":"auto","x":["contextual","descriptive","factual","filter","multi_hop","unanswerable"],"xaxis":"x","y":{"dtype":"f8","bdata":"AAAAAAAAAAAjsWE+EhvsPxSuR+F6FOo\u002fchzHcRzHsT9VVVVVVVW1P4XrUbgeBek\u002f"},"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"System=B\u003cbr\u003eQuestion Type=%{x}\u003cbr\u003eCorrectness=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"B","marker":{"color":"#DD8452","pattern":{"shape":""}},"name":"B","offsetgroup":"B","orientation":"v","showlegend":true,"textposition":"auto","x":["contextual","descriptive","factual","filter","multi_hop","unanswerable"],"xaxis":"x","y":{"dtype":"f8","bdata":"AAAAAAAAAADPZeH7XBbsP5x9+Ay7Auo\u002fAAAAAAAAAAARERERERGxP2As+cWS3+k\u002f"},"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"System=C\u003cbr\u003eQuestion Type=%{x}\u003cbr\u003eCorrectness=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"C","marker":{"color":"#55A868","pattern":{"shape":""}},"name":"C","offsetgroup":"C","orientation":"v","showlegend":true,"textposition":"auto","x":["contextual","descriptive","factual","filter","multi_hop","unanswerable"],"xaxis":"x","y":{"dtype":"f8","bdata":"O6iDOqiD4D+i32wd+s3sP2PJL5b8Yuk\u002faC+hvYT2cj8RERERERGBP1nyiyW\u002fWOk\u002f"},"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"System=D\u003cbr\u003eQuestion Type=%{x}\u003cbr\u003eCorrectness=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"D","marker":{"color":"#C44E52","pattern":{"shape":""}},"name":"D","offsetgroup":"D","orientation":"v","showlegend":true,"textposition":"auto","x":["contextual","descriptive","factual","filter","multi_hop","unanswerable"],"xaxis":"x","y":{"dtype":"f8","bdata":"hDqogzqo4T9l1yZKdm3mP\u002fYoXI\u002fC9eQ\u002feHd3d3d3tz8AAAAAAACwPwY6baDThuQ\u002f"},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Question Category"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Avg Correctness Score"},"range":[0,1.05]},"legend":{"title":{"text":"Sys"},"tracegroupgap":0,"orientation":"h","yanchor":"top","y":-0.25,"xanchor":"center","x":0.5},"barmode":"group","margin":{"l":10,"r":10,"t":30,"b":100},"height":550},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('214e54ff-4032-41c1-a886-83ce796982af');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 12</strong>. System competency profile showing correctness by question type. Complex systems excel at filter and multi-hop categories.</p>
</div>
<p>It can be quickly observed from Figure 12 that System C is the most robust performer across nearly all question types. Particularly, it clearly exceeds all other systems in descriptive, factual, contextual, and unanswerable categories. It’s also significantly better than System D, despite System D’s increased complexity. This suggests possible failure modes resulting from interaction between System D’s architectural complexity and the robustness of other system components.</p>
<p>Figure 12 also shows that only the agentic systems (Systems C and D) are capable of answering the “contextual” questions. This is because only these systems contain a rudimentary “agentic” function of rewriting follow-up user queries – using the conversation history as the context – to create queries that works better for the semantic retrieval step. E.g., a vague question of “what year was it released?” gets transformed to “what year was the second Star Wars movie released?”, etc.</p>
<p>Finally, Figure 12 shows that filter and multi-hop questions are only solved reliably by Systems A (Naive) and D (God Mode). In the naive system, these questions succeed mainly due to “context stuffing” – the large k used for this system (20) increased the chance of finding the correct document. In contrast, System D attempts to solve these questions through explicit decomposition and reranking – an approach that is theoretically more principled, but, as shown below, can be a liability in configurations with spotty model robustness.</p>
<p>Altogether, these results motivate a closer examination of System D’s failures in cases where the simpler System C succeeds. The following case studies analyze certain “God Mode” failures to illustrate how aspects of its complex architecture interact to undermine otherwise correct retrieval.</p>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
When and why did “God Mode” not work?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why did the complex System D fail where the simpler System C succeeded? Failure analysis showed that the semantic reranker often discarded “boring” but correct metadata in favor of “rich” but irrelevant plot summaries, or simply overwhelmed the model with noise.</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Question</th>
<th style="text-align: left;">System C (Agentic)</th>
<th style="text-align: left;">System D (GodMode)</th>
<th style="text-align: left;">What happened?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>“What is the popularity score of Armageddon (1998)?”</strong></td>
<td style="text-align: left;"><strong>“7.838”</strong> (Correct)</td>
<td style="text-align: left;"><em>“The popularity score of Armageddon (1998) is 6.4/10 [Doc 20603].”</em> (Incorrect)</td>
<td style="text-align: left;"><strong>Metric confusion under noise:</strong> God Mode returned a rating-style number for a popularity field. It grabbed a number from the metadata that looked plausible but wasn’t the correct one.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>“How much gold was Brink’s-Mat holding?”</strong></td>
<td style="text-align: left;"><strong>“£26 million”</strong> (Correct)</td>
<td style="text-align: left;"><em>“The information is not found in the provided documents.”</em> (Incorrect)</td>
<td style="text-align: left;"><strong>Retrieval miss / over-filtering:</strong> God Mode simply fails to surface the relevant evidence (its retrieval metrics for this item drop to zero). Generation failed because retrieval failed.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>“Which movie is about two rival gangs in Munich?”</strong></td>
<td style="text-align: left;"><strong>“Nacht der Wölfe”</strong> (Correct)</td>
<td style="text-align: left;">*“I cannot find the answer…” (Incorrect)</td>
<td style="text-align: left;"><strong>Wrong retrieval target:</strong> This looks like a straight-up miss – God Mode doesn’t retrieve the needed doc and instead finds unrelated ones.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="9913308a" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mean_correctness(jsonl_path: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    vals <span class="op">=</span> []</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(jsonl_path, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>,errors<span class="op">=</span><span class="st">"replace"</span>) <span class="im">as</span> f:</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> line.strip():</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>            d <span class="op">=</span> json.loads(line)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>            v <span class="op">=</span> d.get(<span class="st">"correctness_score"</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> v <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>                vals.append(v)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(np.mean(vals))</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co"># --- UPDATE: Added 'evals/' prefix to all paths ---</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>qwen_4bit <span class="op">=</span> <span class="st">"evals/evaluation_results_qwen2.5_32b_SysG_v4_Reranked_FIXED_1766524393.jsonl"</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>qwen_2bit <span class="op">=</span> <span class="st">"evals/evaluation_results_qwen2.5_32b-instruct-q2_K_SysG_v4_Reranked_FIXED_1766368890.jsonl"</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>llama_4bit <span class="op">=</span> <span class="st">"evals/evaluation_results_llama3.1_70b_SysG_v4_Reranked_FIXED_1766501850.jsonl"</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>llama_2bit <span class="op">=</span> <span class="st">"evals/evaluation_results_llama3.1-70b-iq2_xs_SysG_v4_Reranked_FIXED_1766415472.jsonl"</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>qwen_y <span class="op">=</span> [mean_correctness(qwen_4bit), mean_correctness(qwen_2bit)]</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>llama_y <span class="op">=</span> [mean_correctness(llama_4bit), mean_correctness(llama_2bit)]</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>[<span class="st">'4-Bit'</span>, <span class="st">'2-Bit'</span>],</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>qwen_y,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'lines+markers+text'</span>,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'Qwen 2.5 32B'</span>,</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#00cc96'</span>, width<span class="op">=</span><span class="dv">4</span>),</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>),</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span>[<span class="ss">f"</span><span class="sc">{</span>v<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span> <span class="cf">for</span> v <span class="kw">in</span> qwen_y],</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    textposition<span class="op">=</span><span class="st">"top right"</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>[<span class="st">'4-Bit'</span>, <span class="st">'2-Bit'</span>],</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>llama_y,</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'lines+markers+text'</span>,</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'Llama 3.1 70B'</span>,</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#ef553b'</span>, width<span class="op">=</span><span class="dv">4</span>, dash<span class="op">=</span><span class="st">'dash'</span>),</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>, symbol<span class="op">=</span><span class="st">'x'</span>),</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span>[<span class="ss">f"</span><span class="sc">{</span>v<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span> <span class="cf">for</span> v <span class="kw">in</span> llama_y],</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>    textposition<span class="op">=</span><span class="st">"bottom center"</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"Correctness Score"</span>,</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[<span class="fl">0.2</span>, <span class="fl">0.75</span>], tickformat<span class="op">=</span><span class="st">".0%"</span>),</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">'plotly_white'</span>,</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">550</span>,</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.2</span>,</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="b20bd9b5-855c-43b6-b0fc-720e169f497a" class="plotly-graph-div" style="height:550px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("b20bd9b5-855c-43b6-b0fc-720e169f497a")) {                    Plotly.newPlot(                        "b20bd9b5-855c-43b6-b0fc-720e169f497a",                        [{"line":{"color":"#00cc96","width":4},"marker":{"size":12},"mode":"lines+markers+text","name":"Qwen 2.5 32B","text":["63.3%","62.9%"],"textposition":"top right","x":["4-Bit","2-Bit"],"y":[0.633,0.629],"type":"scatter"},{"line":{"color":"#ef553b","dash":"dash","width":4},"marker":{"size":12,"symbol":"x"},"mode":"lines+markers+text","name":"Llama 3.1 70B","text":["47.7%","40.6%"],"textposition":"bottom center","x":["4-Bit","2-Bit"],"y":[0.47700000000000004,0.406],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"yaxis":{"title":{"text":"Correctness Score"},"range":[0.2,0.75],"tickformat":".0%"},"margin":{"l":10,"r":10,"t":30,"b":100},"legend":{"orientation":"h","yanchor":"top","y":-0.2,"xanchor":"center","x":0.5},"height":550},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('b20bd9b5-855c-43b6-b0fc-720e169f497a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 13</strong>. The fragility threshold showing impact of quantization on accuracy. Qwen 2.5 maintains performance while Llama 3.1 degrades rapidly.</p>
</div>
<div id="65c66203" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_jsonl(path: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    rows <span class="op">=</span> []</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>,errors<span class="op">=</span><span class="st">"replace"</span>) <span class="im">as</span> f:</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>            line <span class="op">=</span> line.strip()</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> line:</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>            rows.append(json.loads(line))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(rows)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Normalize types just in case</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"correctness_score"</span>] <span class="op">=</span> pd.to_numeric(df.get(<span class="st">"correctness_score"</span>), errors<span class="op">=</span><span class="st">"coerce"</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"question_type"</span>] <span class="op">=</span> df.get(<span class="st">"question_type"</span>).astype(<span class="bu">str</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mean_correctness_by_qtype(path: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.Series:</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> load_jsonl(path)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># drop rows where correctness missing (should be rare, but safe)</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df[df[<span class="st">"correctness_score"</span>].notna()].copy()</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df.groupby(<span class="st">"question_type"</span>)[<span class="st">"correctness_score"</span>].mean()</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co"># --- UPDATE: Added 'evals/' prefix to all paths ---</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>qwen_4bit <span class="op">=</span> <span class="st">"evals/evaluation_results_qwen2.5_32b_SysG_v4_Reranked_FIXED_1766524393.jsonl"</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>qwen_2bit <span class="op">=</span> <span class="st">"evals/evaluation_results_qwen2.5_32b-instruct-q2_K_SysG_v4_Reranked_FIXED_1766368890.jsonl"</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>llama_4bit <span class="op">=</span> <span class="st">"evals/evaluation_results_llama3.1_70b_SysG_v4_Reranked_FIXED_1766501850.jsonl"</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>llama_2bit <span class="op">=</span> <span class="st">"evals/evaluation_results_llama3.1-70b-iq2_xs_SysG_v4_Reranked_FIXED_1766415472.jsonl"</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute mean correctness by question type</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>qwen_4 <span class="op">=</span> mean_correctness_by_qtype(qwen_4bit)</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>qwen_2 <span class="op">=</span> mean_correctness_by_qtype(qwen_2bit)</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>llama_4 <span class="op">=</span> mean_correctness_by_qtype(llama_4bit)</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>llama_2 <span class="op">=</span> mean_correctness_by_qtype(llama_2bit)</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Union of question types present across files</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>qtypes <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(qwen_4.index) <span class="op">|</span> <span class="bu">set</span>(qwen_2.index) <span class="op">|</span> <span class="bu">set</span>(llama_4.index) <span class="op">|</span> <span class="bu">set</span>(llama_2.index))</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: enforce a nicer order if you want it to match the article</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>preferred_order <span class="op">=</span> [<span class="st">"descriptive"</span>, <span class="st">"factual"</span>, <span class="st">"unanswerable"</span>, <span class="st">"contextual"</span>, <span class="st">"filter"</span>, <span class="st">"multi_hop"</span>]</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">set</span>(preferred_order).issubset(<span class="bu">set</span>(qtypes)):</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>    qtypes <span class="op">=</span> preferred_order</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Build degradation table: (2-bit - 4-bit) * 100 (percentage points)</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> []</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> qt <span class="kw">in</span> qtypes:</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>    rows.append({</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Question Type"</span>: qt.replace(<span class="st">"_"</span>, <span class="st">"-"</span>).title(),  <span class="co"># multi_hop -&gt; Multi-Hop</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Llama 70B"</span>: (llama_2.get(qt, np.nan) <span class="op">-</span> llama_4.get(qt, np.nan)) <span class="op">*</span> <span class="fl">100.0</span>,</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Qwen 32B"</span>:  (qwen_2.get(qt, np.nan)  <span class="op">-</span> qwen_4.get(qt, np.nan))  <span class="op">*</span> <span class="fl">100.0</span>,</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>df_deg <span class="op">=</span> pd.DataFrame(rows)</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt for plotly</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>df_melted <span class="op">=</span> df_deg.melt(id_vars<span class="op">=</span><span class="st">"Question Type"</span>, var_name<span class="op">=</span><span class="st">"Model"</span>, value_name<span class="op">=</span><span class="st">"Degradation"</span>)</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.bar(</span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>    df_melted,</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"Question Type"</span>,</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"Degradation"</span>,</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"Model"</span>,</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>    barmode<span class="op">=</span><span class="st">"group"</span>,</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>    color_discrete_map<span class="op">=</span>{<span class="st">"Llama 70B"</span>: <span class="st">"#C44E52"</span>, <span class="st">"Qwen 32B"</span>: <span class="st">"#55A868"</span>},</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>fig.add_hline(y<span class="op">=</span><span class="dv">0</span>, line_dash<span class="op">=</span><span class="st">"dash"</span>, line_color<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: automatically annotate the two biggest Llama drops (most negative pp)</span></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>llama_rows <span class="op">=</span> df_deg[[<span class="st">"Question Type"</span>, <span class="st">"Llama 70B"</span>]].dropna().sort_values(<span class="st">"Llama 70B"</span>).head(<span class="dv">2</span>)</span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, r <span class="kw">in</span> llama_rows.iterrows():</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>    fig.add_annotation(</span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>r[<span class="st">"Question Type"</span>],</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="bu">float</span>(r[<span class="st">"Llama 70B"</span>]),</span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>r[<span class="st">'Llama 70B'</span>]<span class="sc">:+.0f}</span><span class="ss">pp"</span>,</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>        showarrow<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>        font<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"red"</span>, size<span class="op">=</span><span class="dv">12</span>),</span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>        yshift<span class="op">=-</span><span class="dv">10</span>,</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"Performance Change (pp)"</span>,</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">550</span>,</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.2</span>,</span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="25546acf-ba2f-4100-b07d-2200eb995fc8" class="plotly-graph-div" style="height:550px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("25546acf-ba2f-4100-b07d-2200eb995fc8")) {                    Plotly.newPlot(                        "25546acf-ba2f-4100-b07d-2200eb995fc8",                        [{"alignmentgroup":"True","hovertemplate":"Model=Llama 70B\u003cbr\u003eQuestion Type=%{x}\u003cbr\u003eDegradation=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Llama 70B","marker":{"color":"#C44E52","pattern":{"shape":""}},"name":"Llama 70B","offsetgroup":"Llama 70B","orientation":"v","showlegend":true,"textposition":"auto","x":["Descriptive","Factual","Unanswerable","Contextual","Filter","Multi-Hop"],"xaxis":"x","y":{"dtype":"f8","bdata":"2tMIyz2NEMAFAAAAAAAkQAAAAAAAAEHAS5IkSZIkIcCO4ziO4zgmwAAAAAAAAAAA"},"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"Model=Qwen 32B\u003cbr\u003eQuestion Type=%{x}\u003cbr\u003eDegradation=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Qwen 32B","marker":{"color":"#55A868","pattern":{"shape":""}},"name":"Qwen 32B","offsetgroup":"Qwen 32B","orientation":"v","showlegend":true,"textposition":"auto","x":["Descriptive","Factual","Unanswerable","Contextual","Filter","Multi-Hop"],"xaxis":"x","y":{"dtype":"f8","bdata":"AAAAAAAAAAAAAAAAAAAowAAAAAAAACpAJ0mSJEmSLEAAAAAAAAAAAAAAAAAAACTA"},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Question Type"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Performance Change (pp)"}},"legend":{"title":{"text":"Model"},"tracegroupgap":0,"orientation":"h","yanchor":"top","y":-0.2,"xanchor":"center","x":0.5},"barmode":"group","shapes":[{"line":{"color":"gray","dash":"dash"},"type":"line","x0":0,"x1":1,"xref":"x domain","y0":0,"y1":0,"yref":"y"}],"annotations":[{"font":{"color":"red","size":12},"showarrow":false,"text":"-34pp","x":"Unanswerable","y":-34.0,"yshift":-10},{"font":{"color":"red","size":12},"showarrow":false,"text":"-11pp","x":"Filter","y":-11.11111111111111,"yshift":-10}],"margin":{"l":10,"r":10,"t":30,"b":100},"height":550},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('25546acf-ba2f-4100-b07d-2200eb995fc8');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 14</strong>. Quantization vulnerability by question type. Llama catastrophically fails on descriptive and unanswerable questions.</p>
</div>
<p>The most remarkably underperforming configuration across all experiments were those with System D paired with Llama 3.1 70B-IQ2. As discussed earlier, the degradation in System D using this LLM was hypothesized mainly to arise from the aggressive 2-bit quantization, which is generally understood to introduce calibration error and reduced numerical precision in attention and feed-forward layers of the transformer model. However, is that the whole explanation?</p>
<p>To better isolate the effect of reduced quantization on the degradation of System D, a limited follow-up experiment was conducted using the 4-bit quantized variant of Llama 3.1 70B (the “default”, and the version actually authored by Meta), together with System D and OpenAI-large embeddings, to compare with the 2-bit analog configuration. My local hardware couldn’t hold this system entirely in VRAM, so CPU offloading was required and inference speeds went through the floor; however, the point of interest of this experiment wasn’t speed, it was correctness.</p>
<p>Moving from 2-bit to 4-bit quantization <i>did</i> result in an improvement in correctness for Llama 3.1 70B, but surprisingly not very much. See Figure 13. Because this would’ve been the largest LLM in the study, I was expecting correctness to be at or exceeding 70%, which was the apparent ceiling across all experiments in the study. However, it was 47.7% – only a modest improvement from the performance at 2-bit (40.8%). This difference in performance was compared with the difference between the 4-bit and 2-bit versions of Qwen 2.5 32B, which was virtually non-existent (both at ~63%)</p>
<p>The difference in performance degradation between Llama 3.1 70B and Qwen 2.5 32B was striking. Why is there such a big difference? The different bit-widths certainly contributed to the performance differential in both cases, but this phenomenon alone was insufficient to explain the large performance drop for Llama 3.1 70B in System D.</p>
<p>The difference in differences cannot be attributed solely to quantization. Instead, it is consistent with an interaction between model architecture, post-training quantization behavior, and the demands imposed by System D itself, which introduces several layers of control logic – including iterative retrieval, semantic reranking, and document grading – that amplify small errors in representation or calibration. In such settings, minor degradation at any single step can cascade into disproportionately large downstream failures.</p>
<p>Notably, this effect appears to be architecture-sensitive. Despite its smaller parameter count, Qwen 2.5 32B exhibited substantially greater robustness under increased system complexity and aggressive quantization. This suggests that raw model size alone is not a sufficient predictor of stability in agentic retrieval settings. Instead, architectural characteristics – such as attention behavior, token salience modeling, or sensitivity to distributional shift – may play a decisive role.</p>
<p>It is important to emphasize that Llama 3.1 70B-IQ2 is a community-quantized variant rather than a first-party Meta release. As such, these results should not be interpreted as definitive statements about the intrinsic capabilities of the base Llama 3.1 architecture. Rather, they highlight how quantization choices and architectural sensitivity can interact with system-level design decisions in non-obvious ways.</p>
<p>To summarize, these findings suggest the existence of a fragility threshold in certain large models: beyond a particular level of system complexity, additional control mechanisms may no longer compensate for representational noise, and may instead exacerbate it. This has practical implications for practitioners seeking to deploy highly agentic RAG systems on constrained hardware. In such cases, smaller or more quantization-tolerant models may outperform larger counterparts, not despite their size, but because of their greater stability under iterative control.</p>
</section>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
<p>If I were to design a production system for this database and these types of questions, these would be my recommendations:</p>
<ul>
<li><strong>For Startups (budget-conscious):</strong>
<ul>
<li><strong>System:</strong> C (Agentic)</li>
<li><strong>LLM:</strong> Gemini Flash</li>
<li><strong>Embedding:</strong> Jina-v3</li>
<li><strong>Cost:</strong> ~$0.0005/query</li>
<li><strong>Accuracy:</strong> 70%</li>
</ul></li>
<li><strong>For Enterprise (reliability-focused):</strong>
<ul>
<li><strong>System:</strong> C (Agentic)</li>
<li><strong>LLM:</strong> GPT-4o</li>
<li><strong>Embedding:</strong> OpenAI-large</li>
<li><strong>Cost:</strong> ~$0.005/query</li>
<li><strong>Accuracy:</strong> 70%</li>
</ul></li>
<li><strong>For Local Deployment:</strong>
<ul>
<li><strong>System:</strong> C (Agentic)</li>
<li><strong>LLM:</strong> Qwen 2.5 32B</li>
<li><strong>Embedding:</strong> Jina-v3</li>
<li><strong>Cost:</strong> $0 (after hardware)</li>
<li><strong>Accuracy:</strong> 68%</li>
</ul></li>
<li><strong>What to Avoid:</strong>
<ul>
<li>System D (God Mode) — fragile and expensive</li>
<li>BGE-M3 embeddings — consistently underperform</li>
<li>2-bit quantization with any complex architecture</li>
</ul></li>
</ul>
<p>96 RAG configurations were assembled and tested using questions that could be answered with TV and movie data. The RAG architectures ranged from simple “naive” RAG to agentic systems that included reranking, iterative retrieval, and self-evaluation. The aim was to evaluate whether the complexity in RAG systems would correlate with performance. The tested configurations showed a ~70% peak correctness that was obtained most consistently by the agentic System C. On the other hand, the “God Mode” agentic System D exhibited high variance in performance – it performed very well in some systems, but degraded sharply in others – particularly with the aggressively quantized Llama 3.1 70B-IQ2.</p>
<p>A lackluster performance by 2-bit models like Llama 3.1 70B-IQ2 is perhaps unsurprising. However, when investigating the effects of going from 4-bit to 2-bit, it was shown that the degradation for Llama 3.1 70B was markedly worse than for Qwen 2.5 32B. Therefore, performance appears to be shaped by a complex interplay between model architecture, quantization, and an error-amplifying effect of the complex System D pipeline.</p>
<p>It should be noted that most aggressively quantized model – Llama 3.1 70B-IQ2 – is a community-produced release, rather than an official Meta release. Therefore, these results should not be interpreted as definitive judgments on the Llama architecture itself. Moreover, newer open-source models (e.g., Llama 3.3) were released after the completion of this study and not evaluated here.</p>
<p>Altogether, these findings suggest that “more agentic” is not necessarily better. Moderately agentic designs such as System C appear to strike a favorable balance between retrieval quality, robustness, and cost. The accuracy/latency tradeoffs are summarized in Figure 15 for all systems. More complex pipelines may still be valuable in specific settings, but only in configurations with LLMs and embeddings of sufficient robustness.</p>
<div id="a07149e0" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># --- UPDATE: Point to evals subdirectory ---</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>EVALS_DIR <span class="op">=</span> <span class="st">"evals"</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>files <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(EVALS_DIR) <span class="cf">if</span> f.endswith(<span class="st">'.jsonl'</span>) <span class="kw">and</span> <span class="kw">not</span> <span class="st">'llama3.1_70b_SysG'</span> <span class="kw">in</span> f]</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- UPDATE: Join path with directory ---</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    full_path <span class="op">=</span> os.path.join(EVALS_DIR, <span class="bu">file</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(full_path, <span class="st">'r'</span>,encoding<span class="op">=</span><span class="st">"utf-8"</span>, errors<span class="op">=</span><span class="st">"replace"</span>) <span class="im">as</span> f:</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                data.append(json.loads(line))</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_sys_name(name):</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(name, <span class="bu">str</span>): <span class="cf">return</span> <span class="bu">str</span>(name)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysA"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System A (Naive)"</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysC"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System B (Hybrid)"</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysD"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System C (Agentic)"</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysG"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System D (God Mode)"</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> df.empty <span class="kw">and</span> <span class="st">'experiment_name'</span> <span class="kw">in</span> df.columns:</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'System'</span>] <span class="op">=</span> df[<span class="st">'experiment_name'</span>].<span class="bu">apply</span>(clean_sys_name)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    agg_df <span class="op">=</span> df.groupby(<span class="st">'System'</span>).agg({</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">'correctness_score'</span>: <span class="st">'mean'</span>,</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">'faithfulness_score'</span>: <span class="st">'mean'</span>,</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">'latency_ms'</span>: <span class="st">'mean'</span>,</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">'main_total_tokens'</span>: <span class="st">'mean'</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    }).reset_index()</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    reasoning_df <span class="op">=</span> df[df[<span class="st">'question_type'</span>].isin([<span class="st">'filter'</span>, <span class="st">'multi_hop'</span>, <span class="st">'contextual'</span>])]</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> reasoning_df.empty:</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>        r_score <span class="op">=</span> reasoning_df.groupby(<span class="st">'System'</span>)[<span class="st">'correctness_score'</span>].mean().reset_index()</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>        agg_df <span class="op">=</span> pd.merge(agg_df, r_score.rename(columns<span class="op">=</span>{<span class="st">'correctness_score'</span>: <span class="st">'reasoning_score'</span>}), on<span class="op">=</span><span class="st">'System'</span>)</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>        agg_df[<span class="st">'reasoning_score'</span>] <span class="op">=</span> agg_df[<span class="st">'correctness_score'</span>]</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    agg_df[<span class="st">'Intelligence'</span>] <span class="op">=</span> ((agg_df[<span class="st">'correctness_score'</span>] <span class="op">+</span> agg_df[<span class="st">'reasoning_score'</span>]) <span class="op">/</span> <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>    max_lat <span class="op">=</span> agg_df[<span class="st">'latency_ms'</span>].<span class="bu">max</span>()</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>    max_tok <span class="op">=</span> agg_df[<span class="st">'main_total_tokens'</span>].<span class="bu">max</span>()</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>    agg_df[<span class="st">'Efficiency'</span>] <span class="op">=</span> (((<span class="dv">1</span> <span class="op">-</span> agg_df[<span class="st">'latency_ms'</span>]<span class="op">/</span>max_lat) <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> agg_df[<span class="st">'main_total_tokens'</span>]<span class="op">/</span>max_tok)) <span class="op">/</span> <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_size(sys_name):</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"System C"</span> <span class="kw">in</span> sys_name: <span class="cf">return</span> <span class="dv">45</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">30</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>    agg_df[<span class="st">'MarkerSize'</span>] <span class="op">=</span> agg_df[<span class="st">'System'</span>].<span class="bu">apply</span>(get_size)</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>    fig_quad <span class="op">=</span> px.scatter(</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>        agg_df,</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"Efficiency"</span>,</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Intelligence"</span>,</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"System"</span>,</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span><span class="st">"MarkerSize"</span>,</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="st">"System"</span>,</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>        template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>        color_discrete_map<span class="op">=</span>{</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>            <span class="st">"System A (Naive)"</span>: <span class="st">"#4C72B0"</span>,</span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>            <span class="st">"System B (Hybrid)"</span>: <span class="st">"#DD8452"</span>,</span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>            <span class="st">"System C (Agentic)"</span>: <span class="st">"#55A868"</span>,</span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>            <span class="st">"System D (God Mode)"</span>: <span class="st">"#C44E52"</span></span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>    mean_int <span class="op">=</span> agg_df[<span class="st">'Intelligence'</span>].mean()</span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>    mean_eff <span class="op">=</span> agg_df[<span class="st">'Efficiency'</span>].mean()</span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>    fig_quad.add_hline(y<span class="op">=</span>mean_int, line_width<span class="op">=</span><span class="dv">1</span>, line_dash<span class="op">=</span><span class="st">"dash"</span>, line_color<span class="op">=</span><span class="st">"grey"</span>)</span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>    fig_quad.add_vline(x<span class="op">=</span>mean_eff, line_width<span class="op">=</span><span class="dv">1</span>, line_dash<span class="op">=</span><span class="st">"dash"</span>, line_color<span class="op">=</span><span class="st">"grey"</span>)</span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>    x_min, x_max <span class="op">=</span> agg_df[<span class="st">'Efficiency'</span>].<span class="bu">min</span>(), agg_df[<span class="st">'Efficiency'</span>].<span class="bu">max</span>()</span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>    y_min, y_max <span class="op">=</span> agg_df[<span class="st">'Intelligence'</span>].<span class="bu">min</span>(), agg_df[<span class="st">'Intelligence'</span>].<span class="bu">max</span>()</span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a>    x_range <span class="op">=</span> x_max <span class="op">-</span> x_min</span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a>    y_range <span class="op">=</span> y_max <span class="op">-</span> y_min</span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a>    fig_quad.add_annotation(x<span class="op">=</span>(x_max<span class="op">-</span>x_max<span class="op">*</span><span class="fl">0.093</span>), y<span class="op">=</span>(y_max<span class="op">-</span><span class="fl">0.014</span><span class="op">*</span>y_max), text<span class="op">=</span><span class="st">"&lt;b&gt;The Ideal State&lt;/b&gt;"</span>, showarrow<span class="op">=</span><span class="va">False</span>, font<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"green"</span>, size<span class="op">=</span><span class="dv">12</span>))</span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a>    fig_quad.add_annotation(x<span class="op">=</span>x_min, y<span class="op">=</span>y_min, text<span class="op">=</span><span class="st">"&lt;b&gt;Low Value&lt;/b&gt;"</span>, showarrow<span class="op">=</span><span class="va">False</span>, font<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"red"</span>, size<span class="op">=</span><span class="dv">12</span>))</span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a>    fig_quad.add_annotation(x<span class="op">=</span>(x_max<span class="op">-</span>x_max<span class="op">*</span><span class="fl">0.0093</span>), y<span class="op">=</span>(y_min<span class="op">-</span><span class="fl">0.012</span><span class="op">*</span>y_min), text<span class="op">=</span><span class="st">"&lt;b&gt;Fast but Dumb&lt;/b&gt;"</span>, showarrow<span class="op">=</span><span class="va">False</span>, font<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>))</span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a>    fig_quad.add_annotation(x<span class="op">=</span>x_min, y<span class="op">=</span>y_max, text<span class="op">=</span><span class="st">"&lt;b&gt;Smart but Slow&lt;/b&gt;"</span>, showarrow<span class="op">=</span><span class="va">False</span>, font<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>))</span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a>    fig_quad.update_traces(textposition<span class="op">=</span><span class="st">'top center'</span>)</span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a>    fig_quad.update_layout(</span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a>        xaxis_title<span class="op">=</span><span class="st">"Efficiency Score (Speed + Low Cost)"</span>,</span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a>        yaxis_title<span class="op">=</span><span class="st">"Intelligence Score (Reasoning + Accuracy)"</span>,</span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a>        showlegend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span><span class="dv">600</span>,</span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a>        xaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[x_min <span class="op">-</span> x_range<span class="op">*</span><span class="fl">0.2</span>, x_max <span class="op">+</span> x_range<span class="op">*</span><span class="fl">0.2</span>]),</span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a>        yaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[y_min <span class="op">-</span> y_range<span class="op">*</span><span class="fl">0.2</span>, y_max <span class="op">+</span> y_range<span class="op">*</span><span class="fl">0.2</span>]),</span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a>        <span class="co"># MOBILE FIX: Slightly larger T/B margins for the text annotations</span></span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a>        margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">40</span>, b<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a>    fig_quad.show()</span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"DataFrame empty or missing columns."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="aa96b10e-668b-494b-b45b-ade5c1c22827" class="plotly-graph-div" style="height:600px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("aa96b10e-668b-494b-b45b-ade5c1c22827")) {                    Plotly.newPlot(                        "aa96b10e-668b-494b-b45b-ade5c1c22827",                        [{"hovertemplate":"System=%{text}\u003cbr\u003eEfficiency=%{x}\u003cbr\u003eIntelligence=%{y}\u003cbr\u003eMarkerSize=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"System A (Naive)","marker":{"color":"#4C72B0","size":{"dtype":"i1","bdata":"Hg=="},"sizemode":"area","sizeref":0.1125,"symbol":"circle"},"mode":"markers+text","name":"System A (Naive)","orientation":"v","showlegend":true,"text":["System A (Naive)"],"x":{"dtype":"f8","bdata":"quUzrXJ8P0A="},"xaxis":"x","y":{"dtype":"f8","bdata":"I0w+kOskQUA="},"yaxis":"y","type":"scatter","textposition":"top center"},{"hovertemplate":"System=%{text}\u003cbr\u003eEfficiency=%{x}\u003cbr\u003eIntelligence=%{y}\u003cbr\u003eMarkerSize=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"System B (Hybrid)","marker":{"color":"#DD8452","size":{"dtype":"i1","bdata":"Hg=="},"sizemode":"area","sizeref":0.1125,"symbol":"circle"},"mode":"markers+text","name":"System B (Hybrid)","orientation":"v","showlegend":true,"text":["System B (Hybrid)"],"x":{"dtype":"f8","bdata":"AesHOTxsTEA="},"xaxis":"x","y":{"dtype":"f8","bdata":"dU3XdE1LQEA="},"yaxis":"y","type":"scatter","textposition":"top center"},{"hovertemplate":"System=%{text}\u003cbr\u003eEfficiency=%{x}\u003cbr\u003eIntelligence=%{y}\u003cbr\u003eMarkerSize=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"System C (Agentic)","marker":{"color":"#55A868","size":{"dtype":"i1","bdata":"LQ=="},"sizemode":"area","sizeref":0.1125,"symbol":"circle"},"mode":"markers+text","name":"System C (Agentic)","orientation":"v","showlegend":true,"text":["System C (Agentic)"],"x":{"dtype":"f8","bdata":"Zrtd2OqjSUA="},"xaxis":"x","y":{"dtype":"f8","bdata":"ERERERH5Q0A="},"yaxis":"y","type":"scatter","textposition":"top center"},{"hovertemplate":"System=%{text}\u003cbr\u003eEfficiency=%{x}\u003cbr\u003eIntelligence=%{y}\u003cbr\u003eMarkerSize=%{marker.size}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"System D (God Mode)","marker":{"color":"#C44E52","size":{"dtype":"i1","bdata":"Hg=="},"sizemode":"area","sizeref":0.1125,"symbol":"circle"},"mode":"markers+text","name":"System D (God Mode)","orientation":"v","showlegend":true,"text":["System D (God Mode)"],"x":{"dtype":"f8","bdata":"AAAAAAAAAAA="},"xaxis":"x","y":{"dtype":"f8","bdata":"GI\u002fxGI\u002fRQkA="},"yaxis":"y","type":"scatter","textposition":"top center"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scattermap":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermap"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Efficiency Score (Speed + Low Cost)"},"range":[-11.369117570660821,68.21470542396493]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Intelligence Score (Reasoning + Accuracy)"},"range":[31.116794871794873,41.41733974358974]},"legend":{"title":{"text":"System"},"tracegroupgap":0,"itemsizing":"constant"},"shapes":[{"line":{"color":"grey","dash":"dash","width":1},"type":"line","x0":0,"x1":1,"xref":"x domain","y0":36.11493823214266,"y1":36.11493823214266,"yref":"y"},{"line":{"color":"grey","dash":"dash","width":1},"type":"line","x0":34.903079271269796,"x1":34.903079271269796,"xref":"x","y0":0,"y1":1,"yref":"y domain"}],"annotations":[{"font":{"color":"green","size":12},"showarrow":false,"text":"\u003cb\u003eThe Ideal State\u003c\u002fb\u003e","x":51.55894818294682,"y":39.38659166666667},{"font":{"color":"red","size":12},"showarrow":false,"text":"\u003cb\u003eLow Value\u003c\u002fb\u003e","x":0.0,"y":32.58830128205128},{"font":{"size":12},"showarrow":false,"text":"\u003cb\u003eFast but Dumb\u003c\u002fb\u003e","x":56.31692388626838,"y":32.19724166666667},{"font":{"size":12},"showarrow":false,"text":"\u003cb\u003eSmart but Slow\u003c\u002fb\u003e","x":0.0,"y":39.94583333333333}],"margin":{"l":10,"r":10,"t":40,"b":40},"showlegend":false,"height":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('aa96b10e-668b-494b-b45b-ade5c1c22827');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<div class="fig-caption">
<p><strong>Figure 15</strong>. The RAG architecture quadrant plotting intelligence versus efficiency. System C (Agentic) achieves the optimal position.</p>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "The RAG Complexity Paradox"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Why 20× more spend didn’t beat a ~70% ceiling"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Trevor Seguin</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2026.1.5</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="an">date-format:</span><span class="co"> "MMMM D, YYYY"</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "After evaluating 96 RAG configurations across 4 architectures, 6 LLMs, and 4 embedding models on a 100-question TMDB benchmark, there seems to be no reliable improvement from highly complex agentic systems. The top configurations clustered around ~70% correctness (the practical ceiling for the testing conditions), and several very different configurations tie for best. Moderate agentic control (System C: query rewriting + doc grading) consistently lands on the efficiency frontier of latency and accuracy (e.g. ~70% at 1s with GPT-4o + OpenAI-large embeddings). The most complex architecture -- System D God Mode -- can achieve high performance in correctness and retrieval recall, but turned out to be especially brittle with heavily-quantized models. A follow-up study of God Mode degradation for 2-bit compression showed it's model dependent: Qwen 32B appears to show no substantial degradation from 4-bit to 2-bit, while Llama 3.1 70B degrades much more. All code + raw outputs are in the repo (link)."</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="an">keywords:</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - RAG</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">  - retrieval-augmented generation</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">  - agentic RAG</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - RAG evaluation</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - reranking</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - cross-encoder reranker</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - query rewriting</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">  - document grading</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">  - hybrid search</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">  - vector search</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">  - embeddings</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">  - recall@k</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co">  - MRR</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co">  - pareto frontier</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co">  - latency</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co">  - token cost</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co">  - quantization</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co">  - 2-bit quantization</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co">  - 4-bit quantization</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co">  - local LLM</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co">  - LLMOps</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> abstract_long.png   # social preview card</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="an">twitter-card:</span><span class="co"> true</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co">    include-in-header:</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="co">      - text: |</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="co">          &lt;script defer src="https://cloud.umami.is/script.js" data-website-id="915382e1-9b49-4bc2-848d-365a7baba5b7"&gt;&lt;/script&gt;</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="co">          &lt;style&gt;</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="co">            /* Force tables to scroll on mobile instead of squishing */</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="co">            .cell-output-display {</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="co">              overflow-x: auto;</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="co">              display: block;</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="co">            }</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="co">            /* Ensure Plotly charts take full width */</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="co">            .plotly-graph-div {</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="co">              width: 100% !important;</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="co">            }</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="co">          &lt;/style&gt;</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a><span class="co">    include-after-body:</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a><span class="co">      - text: |</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="co">          &lt;hr&gt;</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a><span class="co">          &lt;div class="d-flex justify-content-between small text-muted"&gt;</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="co">            &lt;div&gt;© Trevor Seguin&lt;/div&gt;</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a><span class="co">            &lt;div&gt;</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="co">              &lt;a href="https://github.com/tseguin715/rag-complexity-paradox"&gt;Repo&lt;/a&gt; ·</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a><span class="co">              &lt;a href="https://www.linkedin.com/in/trevor-seguin"&gt;LinkedIn&lt;/a&gt; ·</span></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="co">              &lt;a href="mailto:tseguin715@gmail.com"&gt;Email&lt;/a&gt;</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="co">            &lt;/div&gt;</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="co">          &lt;/div&gt;</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a><span class="co">    link-external-newwindow: true</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: hide</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-cap-location: margin</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a><span class="co">    tbl-cap-location: margin</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a><span class="co">    lightbox: true</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: full</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a><span class="al">![](abstract_long.png)</span>{width=100%}</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false}</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key takeaways (for builders)</span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Complexity does not necessarily equal accuracy**: Top configs cluster around ~70% correctness, with no improvement from the most complex pipelines.</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Cost gap is real**: Lack of substantial improvement from highly complex RAG architecture despite a 20x increase in compute and tokens. </span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**System C is the sweet spot**: Moderate agentic workflows (grading + rewriting) sit right on the efficiency frontier for latency, cost and accuracy.</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Complex pipelines amplify model weakness.**: Heavy reranking in "God Mode" (System D) caused degradation in aggressively quantized models.</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a><span class="fu"># What this is</span></span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>96 RAG configurations were benchmarked on a fixed TMDB QA task to understand how architecture complexity affects correctness, latency, and cost. The focus was practical tradeoffs and failure modes that could occur in real RAG pipelines.</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>Retrieval Augmented Generation (RAG) has been a standard in external data retrieval for LLMs since approximately the early 2020s. The approach was popularized by Lewis et al. in 2020 and has since been widely adopted in both research and production environments. NotebookLM is perhaps a well-known example: uploaded documents are converted to a vector database as embeddings, and a numerical representation of the user's query is checked against the embeddings for the closest match for retrieval and generation. Other examples are Perplexity, ChatGPT's document and browsing features, and GitHub Copilot Chat with repository indexing.</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>The process of equipping an LLM with knowledge outside of its training data is an ongoing area of research. There are many failure points in the process; for example -- what is the retrieval method? How are the documents encoded?  How many documents should be retrieved? And then, once implemented -- how well does it perform? What's the quality of the responses? How fast is it? Can it be applied at scale?</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>An understandable expectation is that RAG should improve when "agentic" systems enter the picture. Surprisingly, this intuition does not always hold. In this study, we observe cases where additional layers of complexity -- including iterative retrieval, grading, and query rewriting -- can degrade overall system performance, particularly for smaller or aggressively quantized models.</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>About "agentic" RAG: when you think about it, it might sound a little silly. Why does a LLM need to tell itself how to retrieve information? The simplest form of RAG -- a single-pass lookup of documents based on semantic similarity to the input query -- performs well in some contexts, but faces limitations when complex reasoning is required. These include scenarios requiring filtering, aggregation, or query reformulation; 'multi-hop' reasoning (connecting multiple documents with disparate semantic meanings); or cases where a wider understanding of the corpus is necessary. "Agentic" systems attempt to address these situations by involving LLMs in additional steps of the retrieval process. For example -- a LLM might take a user query and ask: does this need to be rewritten to fit the context of the chat history? Does it need to be rewritten to be more "compatible" with the database embeddings? And then: are the retrieved documents actually relevant? </span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>This study aims to be a small investigation in the usability of several modern LLMs and embedding models -- including popular commercial offerings as well as some smaller, open-source models -- in different RAG architectures for retrieval of data for TV and movies. We study structured question answering over a fixed corpus of movie and television data, including titles, metadata, and short plot descriptions. The question consists of simple factual lookups, filtering, aggregation, and multi-hop reasoning. System performance is evaluated in several metrics: retrieval quality (e.g., recall and MRR), answer correctness and faithfulness as judged by a reference LLM, and overall latency. The scope of RAG systems for this study includes simple "naive" RAG and a number of "agentic" systems of increasing complexity. The intent is to find how RAG systems of different complexity interact with model size and architecture in controlled settings to find guidelines for production-scale deployment.</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>Part of the motivation for this study came from my discovery of a 70B model -- Llama 3.1 70B-IQ2 -- that could run entirely on my RTX 4090(!). In the local LLM "world", it seemed to be kind of an informal benchmark to be able to run a 70b model in home hardware (without CPU offloading). However, the lowest commonly accepted quantization for anything useful seems to be 4-bit. The 4-bit quant of Llama 3.1 70b requires about ~40gb of RAM, so even a video card like the RTX 4090 can't hold it without offloading to the CPU and tanking inference speed. After loading up Llama 3.1 70B-IQ2 in Ollama recently, I was excited to see it running at about 50 tokens/second, which is very useable. However, while this was all well and good, it raised an obvious question: what is the hidden cost of such an aggressive quantization? This study aimed to find out whether this and other inexpensive models can be used as more than a "toy" or proof-of-concept, while throwing some high-quality commercial models into the fray for comparison.</span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a><span class="fu"># Methods</span></span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a><span class="fu">### Questions</span></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>Data was extracted from tmdb.org to create 136,788 documents of TV shows and movies released from 1980 to 2025, whose main text was a brief description of the TV show or movie; and metadata for year, rating, votes, genre, language, popularity, and type (TV or movie) were included. </span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>100 questions (the 'Gold' set) were written to test different reasoning and retrieval mechanisms. The question types fell into the following categories:</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen-inset</span></span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>df_data <span class="op">=</span> {<span class="st">'Question Type'</span>: {<span class="dv">0</span>: <span class="st">'descriptive'</span>, <span class="dv">1</span>: <span class="st">'factual'</span>, <span class="dv">2</span>: <span class="st">'unanswerable'</span>, <span class="dv">3</span>: <span class="st">'multi_hop'</span>, <span class="dv">4</span>: <span class="st">'filter'</span>, <span class="dv">5</span>: <span class="st">'contextual'</span>}, <span class="st">'Count'</span>: {<span class="dv">0</span>: <span class="dv">29</span>, <span class="dv">1</span>: <span class="dv">25</span>, <span class="dv">2</span>: <span class="dv">20</span>, <span class="dv">3</span>: <span class="dv">10</span>, <span class="dv">4</span>: <span class="dv">9</span>, <span class="dv">5</span>: <span class="dv">7</span>}}</span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Recreate the DataFrame</span></span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>type_counts <span class="op">=</span> pd.DataFrame.from_dict(df_data, orient<span class="op">=</span><span class="st">'columns'</span>)</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Seaborn 'Deep' Palette Hex Codes manually</span></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>seaborn_deep <span class="op">=</span> [</span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#4C72B0'</span>, <span class="co"># Blue</span></span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#DD8452'</span>, <span class="co"># Orange</span></span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#55A868'</span>, <span class="co"># Green</span></span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#C44E52'</span>, <span class="co"># Red</span></span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#8172B3'</span>, <span class="co"># Purple</span></span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#937860'</span>, <span class="co"># Brown</span></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#DA8BC3'</span>, <span class="co"># Pink</span></span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#8C8C8C'</span>, <span class="co"># Gray</span></span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#CCB974'</span>, <span class="co"># Yellow</span></span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#64B5CD'</span>  <span class="co"># Cyan</span></span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>fig_dist <span class="op">=</span> px.bar(</span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>    type_counts, </span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'Question Type'</span>, </span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Count'</span>,</span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">'Count'</span>,</span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'Question Type'</span>,</span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>    color_discrete_sequence<span class="op">=</span>seaborn_deep</span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a>fig_dist.update_traces(textposition<span class="op">=</span><span class="st">'outside'</span>)</span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a>fig_dist.update_layout(</span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"Correctness Score"</span>,</span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">10</span>),</span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"bottom"</span>,</span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="fl">1.02</span>,</span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"right"</span>,</span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="dv">1</span></span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a>fig_dist.show()</span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a>**Figure 1**. Distribution of question types in the 100-question evaluation set.</span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a>Some examples of each category were:</span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itables <span class="im">import</span> show</span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Prepare Data</span></span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a>sample_questions <span class="op">=</span> [</span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Category'</span>: <span class="st">'Factual'</span>,</span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Question'</span>: <span class="st">'What is the rating of "Bluefin"?'</span>,</span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gold Answer'</span>: <span class="st">'7.2'</span>,</span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Why It's Challenging"</span>: <span class="st">'Simple lookup - tests basic retrieval'</span></span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Category'</span>: <span class="st">'Descriptive'</span>,</span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Question'</span>: <span class="st">'In Sweet Trap (2024), the apprentice falls into whose trap?'</span>,</span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gold Answer'</span>: <span class="st">'Jiang Jie'</span>,</span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Why It's Challenging"</span>: <span class="st">'Requires finding specific plot details'</span></span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Category'</span>: <span class="st">'Filter'</span>,</span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Question'</span>: <span class="st">'How many movies in 2025 allude to the holocaust?'</span>,</span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gold Answer'</span>: <span class="st">'2'</span>,</span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Why It's Challenging"</span>: <span class="st">'Needs metadata filtering + counting'</span></span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Category'</span>: <span class="st">'Multi-hop'</span>,</span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Question'</span>: <span class="st">'What is the 4th oldest Star Wars movie?'</span>,</span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gold Answer'</span>: <span class="st">'Star Wars: Droids - The Great Heep'</span>,</span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Why It's Challenging"</span>: <span class="st">'Requires sorting then selecting nth item'</span></span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Category'</span>: <span class="st">'Contextual'</span>,</span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Question'</span>: <span class="st">'What country is he from?'</span>,</span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gold Answer'</span>: <span class="st">'New Zealand'</span>,</span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Why It's Challenging"</span>: <span class="st">'Depends on conversation history'</span></span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Category'</span>: <span class="st">'Unanswerable'</span>,</span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Question'</span>: <span class="st">'What year was "The Last Pixel" released?'</span>,</span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Gold Answer'</span>: <span class="st">'Movie not in database'</span>,</span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Why It's Challenging"</span>: <span class="st">'Tests ability to say "I don</span><span class="ch">\'</span><span class="st">t know"'</span></span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a>df_sample <span class="op">=</span> pd.DataFrame(sample_questions)</span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Render Table (Default Styling)</span></span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a>show(</span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a>    df_sample,</span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a>    classes<span class="op">=</span><span class="st">"display compact"</span>,</span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a>    style<span class="op">=</span><span class="st">"width:100%; font-size: 16px; white-space: normal;"</span>,</span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a>    scrollX<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a>    columnDefs<span class="op">=</span>[</span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"className"</span>: <span class="st">"dt-left"</span>, <span class="st">"targets"</span>: <span class="st">"_all"</span>},</span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"width"</span>: <span class="st">"10%"</span>, <span class="st">"targets"</span>: <span class="dv">0</span>},</span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"width"</span>: <span class="st">"35%"</span>, <span class="st">"targets"</span>: <span class="dv">1</span>},</span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"width"</span>: <span class="st">"15%"</span>, <span class="st">"targets"</span>: <span class="dv">2</span>},</span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"width"</span>: <span class="st">"40%"</span>, <span class="st">"targets"</span>: <span class="dv">3</span>}</span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a>::: {.tbl-caption}</span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a>**Table 1**. Sample questions from the 100-question evaluation set, showing each category and its associated challenge.</span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a><span class="fu">### RAG Architectures</span></span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>As mentioned, the RAG systems evaluated in this study ranged from a simple "naive" baseline retrieval to complex multi-stage systems. Each represents a different idea on how to improve RAG performance.</span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a>::: {layout-ncol=2 layout-valign="bottom"}</span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a>%%| fig-height: <span class="dv">6</span></span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a>flowchart TD</span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a>    User[User Query]</span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a>    subgraph Retrieval[<span class="ot">"</span><span class="st">Retrieval Phase</span><span class="ot">"</span>]</span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a>        User --&gt; Embed[Embed Query]</span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a>        Embed --&gt; Search[<span class="ot">"</span><span class="st">Vector Search&lt;br/&gt;(k=20)</span><span class="ot">"</span>]</span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a>        Search --&gt; Docs[Retrieved Docs]</span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a>    subgraph Generation[<span class="ot">"</span><span class="st">Generation Phase</span><span class="ot">"</span>]</span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a>        Docs --&gt; Format[Format Context]</span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a>        Format --&gt; Prompt[Construct Prompt]</span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a>        Prompt --&gt; LLM[LLM Generate]</span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a>        LLM --&gt; Output[Answer]</span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a>    style User fill:<span class="co">#e8f4f8,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a>    style LLM fill:<span class="co">#f0e6ff,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a>    style Output fill:<span class="co">#e8f8e8,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a>    style Retrieval fill:<span class="co">#f9f9f9,stroke:#999</span></span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a>    style Generation fill:<span class="co">#f9f9f9,stroke:#999</span></span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a>%%| fig-height: <span class="dv">6</span></span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a>flowchart TD</span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a>User[User Query] --&gt; Extract[Extract Metadata]</span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a>Extract --&gt; Search{Search Type}</span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a>Search --&gt;|Has Filters| Hybrid[<span class="ot">"</span><span class="st">Hybrid Search&lt;br/&gt;(Vector + Metadata)</span><span class="ot">"</span>]</span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>Search --&gt;|No Filters| Vector[<span class="ot">"</span><span class="st">Vector Search&lt;br/&gt;(k=20)</span><span class="ot">"</span>]</span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a>Hybrid --&gt; Docs[Retrieved Docs]</span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a>Vector --&gt; Docs</span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a>Docs --&gt; CoT[<span class="ot">"</span><span class="st">Chain of Thought&lt;br/&gt;Prompt</span><span class="ot">"</span>]</span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a>CoT --&gt; LLM[LLM Generate]</span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a>LLM --&gt; Answer[Answer]</span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a>style User fill:<span class="co">#e8f4f8,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a>style LLM fill:<span class="co">#f0e6ff,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-302"><a href="#cb17-302" aria-hidden="true" tabindex="-1"></a>style Extract fill:<span class="co">#fff9e6,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-303"><a href="#cb17-303" aria-hidden="true" tabindex="-1"></a>style Answer fill:<span class="co">#e8f8e8,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-304"><a href="#cb17-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a>%%| fig-height: <span class="dv">6</span></span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a>flowchart TB</span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a>User[User Query] --&gt; Retrieve[<span class="ot">"</span><span class="st">Vector Search(k=20)</span><span class="ot">"</span>]</span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a>Retrieve --&gt; Grade{Grade Docs}</span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a>Grade --&gt;|Relevant| Keep[Keep Doc]</span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a>Grade --&gt;|Irrelevant| Reject[Reject]</span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a>Keep --&gt; Check{Enough?}</span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a>Reject --&gt; Check</span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-320"><a href="#cb17-320" aria-hidden="true" tabindex="-1"></a>%% Force the YES branch to the left</span>
<span id="cb17-321"><a href="#cb17-321" aria-hidden="true" tabindex="-1"></a>Check --&gt;|Yes| YDummy(( ))</span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a>YDummy --&gt; Generate[<span class="ot">"</span><span class="st">Generate Answer</span><span class="ot">"</span>]</span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a>Check --&gt;|No| Expand[<span class="ot">"</span><span class="st">Expand Search</span><span class="ot">"</span>]</span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a>Expand --&gt; Grade</span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-327"><a href="#cb17-327" aria-hidden="true" tabindex="-1"></a>Generate --&gt; Verify{Confident?}</span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a>Verify --&gt;|Yes| Answer[Final Answer]</span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a>Verify --&gt;|No| Refine[<span class="ot">"</span><span class="st">Refine + Retry</span><span class="ot">"</span>]</span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a>Refine --&gt; Generate</span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a>style User fill:<span class="co">#e8f4f8,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a>style Grade fill:<span class="co">#ffe6e6,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a>style Generate fill:<span class="co">#f0e6ff,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a>style Answer fill:<span class="co">#e8f8e8,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a>style Verify fill:<span class="co">#fff0f0,stroke:#333,stroke-width:1px</span></span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a>style YDummy fill:<span class="co">#ffffff00,stroke:#ffffff00</span></span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a>%%| fig-height: <span class="dv">6</span></span>
<span id="cb17-344"><a href="#cb17-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-345"><a href="#cb17-345" aria-hidden="true" tabindex="-1"></a>flowchart TD</span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a>User[User Query] --&gt; Context[<span class="ot">"</span><span class="st">LLM: Contextualize</span><span class="ot">"</span>]</span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a>Context --&gt; Wide[<span class="ot">"</span><span class="st">Wide Retrieval(k=100)</span><span class="ot">"</span>]</span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a>subgraph Rerank[<span class="ot">"</span><span class="st">Reranking Pipeline</span><span class="ot">"</span>]</span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a>    Wide --&gt; Cross[<span class="ot">"</span><span class="st">Cross-Encoder&lt;br/&gt;Reranker</span><span class="ot">"</span>]</span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a>    Cross --&gt; Top[<span class="ot">"</span><span class="st">Select Top 10</span><span class="ot">"</span>]</span>
<span id="cb17-352"><a href="#cb17-352" aria-hidden="true" tabindex="-1"></a>end</span>
<span id="cb17-353"><a href="#cb17-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a>Top --&gt; Grade[<span class="ot">"</span><span class="st">LLM: Grade Docs</span><span class="ot">"</span>]</span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a>Grade --&gt; Generate[<span class="ot">"</span><span class="st">LLM: Generate&lt;br/&gt;with Citations</span><span class="ot">"</span>]</span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a>Generate --&gt; Output[<span class="ot">"</span><span class="st">Answer + Citations</span><span class="ot">"</span>]</span>
<span id="cb17-357"><a href="#cb17-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-358"><a href="#cb17-358" aria-hidden="true" tabindex="-1"></a>style Context fill:<span class="co">#f0e6ff,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a>style Cross fill:<span class="co">#ffe6e6,stroke:#333,stroke-width:3px</span></span>
<span id="cb17-360"><a href="#cb17-360" aria-hidden="true" tabindex="-1"></a>style Grade fill:<span class="co">#f0e6ff,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-361"><a href="#cb17-361" aria-hidden="true" tabindex="-1"></a>style Generate fill:<span class="co">#f0e6ff,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a>style Output fill:<span class="co">#e8f8e8,stroke:#333,stroke-width:2px</span></span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a>style Rerank fill:<span class="co">#f9f9f9,stroke:#999</span></span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-365"><a href="#cb17-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-366"><a href="#cb17-366" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-369"><a href="#cb17-369" aria-hidden="true" tabindex="-1"></a>**Figure 2**. RAG system architectures evaluated: (a) System A - Baseline RAG with simple retrieval + generation, (b) System B - Hybrid Search with vector + metadata and CoT prompting, (c) System C - Agentic RAG with document grading and adaptive generation, (d) System D - "God Mode" with maximum complexity and reranking.</span>
<span id="cb17-370"><a href="#cb17-370" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-371"><a href="#cb17-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-372"><a href="#cb17-372" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**SysA**: Simple one-shot RAG. No bells or whistles. Retrieves 20 documents by semantic matching and inserts all of them into the context.</span>
<span id="cb17-373"><a href="#cb17-373" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**SysB**: Hybrid Search RAG. Uses metadata filtering in addition to semantic search. Has question-type detection (filtering, multi-hop, etc) with special handling for each.</span>
<span id="cb17-374"><a href="#cb17-374" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**SysC**: Agentic RAG. LLM-based document grading (decides if retrieved docs are relevant), query rewriting for follow-up questions using chat history, and adaptive generation.</span>
<span id="cb17-375"><a href="#cb17-375" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**SysD**: 'God Mode' agentic RAG with reranking. Casts a wide net (100 documents) and selects 10 documents by BGE-reranker-v2-m3 reranking. </span>
<span id="cb17-376"><a href="#cb17-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-377"><a href="#cb17-377" aria-hidden="true" tabindex="-1"></a><span class="fu">### LLMs</span></span>
<span id="cb17-378"><a href="#cb17-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-379"><a href="#cb17-379" aria-hidden="true" tabindex="-1"></a>Generally speaking, the selection of LLMs in this study leaned more towards value options that might be preferable in larger scale production settings. GPT-4o was included as a reference, as well as a couple other inexpensive closed-source models, as well as some smaller open-source models: </span>
<span id="cb17-380"><a href="#cb17-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-381"><a href="#cb17-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-384"><a href="#cb17-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-385"><a href="#cb17-385" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-386"><a href="#cb17-386" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itables <span class="im">import</span> show</span>
<span id="cb17-387"><a href="#cb17-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-388"><a href="#cb17-388" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Prepare Data</span></span>
<span id="cb17-389"><a href="#cb17-389" aria-hidden="true" tabindex="-1"></a>models_data <span class="op">=</span> [</span>
<span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'GPT-4o'</span>, <span class="st">'Provider'</span>: <span class="st">'OpenAI'</span>, <span class="st">'Params'</span>: <span class="st">'~1T*'</span>, <span class="st">'Deployment'</span>: <span class="st">'Cloud API'</span>, </span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$5/1M tokens'</span>, <span class="st">'Speed'</span>: <span class="st">'~100 tok/s'</span>, <span class="st">'Purpose'</span>: <span class="st">'Reference baseline'</span>, <span class="st">'Category'</span>: <span class="st">'Premium'</span>},</span>
<span id="cb17-392"><a href="#cb17-392" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-393"><a href="#cb17-393" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'GPT-4o-mini'</span>, <span class="st">'Provider'</span>: <span class="st">'OpenAI'</span>, <span class="st">'Params'</span>: <span class="st">'~100B*'</span>, <span class="st">'Deployment'</span>: <span class="st">'Cloud API'</span>, </span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0.15/1M tokens'</span>, <span class="st">'Speed'</span>: <span class="st">'~150 tok/s'</span>, <span class="st">'Purpose'</span>: <span class="st">'Cost-optimized'</span>, <span class="st">'Category'</span>: <span class="st">'Budget'</span>},</span>
<span id="cb17-395"><a href="#cb17-395" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-396"><a href="#cb17-396" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'Gemini Flash'</span>, <span class="st">'Provider'</span>: <span class="st">'Google'</span>, <span class="st">'Params'</span>: <span class="st">'~50B*'</span>, <span class="st">'Deployment'</span>: <span class="st">'Cloud API'</span>, </span>
<span id="cb17-397"><a href="#cb17-397" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0.075/1M tokens'</span>, <span class="st">'Speed'</span>: <span class="st">'~200 tok/s'</span>, <span class="st">'Purpose'</span>: <span class="st">'Speed-optimized'</span>, <span class="st">'Category'</span>: <span class="st">'Budget'</span>},</span>
<span id="cb17-398"><a href="#cb17-398" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'Qwen 2.5 32B'</span>, <span class="st">'Provider'</span>: <span class="st">'Alibaba'</span>, <span class="st">'Params'</span>: <span class="st">'32B'</span>, <span class="st">'Deployment'</span>: <span class="st">'Local (4-bit)'</span>, </span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0'</span>, <span class="st">'Speed'</span>: <span class="st">'~60 tok/s'</span>, <span class="st">'Purpose'</span>: <span class="st">'Quality local'</span>, <span class="st">'Category'</span>: <span class="st">'Local'</span>},</span>
<span id="cb17-401"><a href="#cb17-401" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-402"><a href="#cb17-402" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'Qwen 2.5 32B-Q2'</span>, <span class="st">'Provider'</span>: <span class="st">'Alibaba'</span>, <span class="st">'Params'</span>: <span class="st">'32B'</span>, <span class="st">'Deployment'</span>: <span class="st">'Local (2-bit)'</span>, </span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0'</span>, <span class="st">'Speed'</span>: <span class="st">'~80 tok/s'</span>, <span class="st">'Purpose'</span>: <span class="st">'Speed local'</span>, <span class="st">'Category'</span>: <span class="st">'Local'</span>},</span>
<span id="cb17-404"><a href="#cb17-404" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-405"><a href="#cb17-405" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'Llama 3.1 70B-IQ2'</span>, <span class="st">'Provider'</span>: <span class="st">'Meta'</span>, <span class="st">'Params'</span>: <span class="st">'70B'</span>, <span class="st">'Deployment'</span>: <span class="st">'Local (2-bit)'</span>, </span>
<span id="cb17-406"><a href="#cb17-406" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0'</span>, <span class="st">'Speed'</span>: <span class="st">'~50 tok/s'</span>, <span class="st">'Purpose'</span>: <span class="st">'Max params on 4090'</span>, <span class="st">'Category'</span>: <span class="st">'Local'</span>}</span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-408"><a href="#cb17-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-409"><a href="#cb17-409" aria-hidden="true" tabindex="-1"></a>df_models <span class="op">=</span> pd.DataFrame(models_data)</span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a>df_models.rename(columns<span class="op">=</span>{<span class="st">'Params'</span>: <span class="st">'Size'</span>, <span class="st">'Purpose'</span>: <span class="st">'Test Purpose'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-411"><a href="#cb17-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-412"><a href="#cb17-412" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Define Styling Logic</span></span>
<span id="cb17-413"><a href="#cb17-413" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_by_category(row):</span>
<span id="cb17-414"><a href="#cb17-414" aria-hidden="true" tabindex="-1"></a>    cat <span class="op">=</span> row[<span class="st">'Category'</span>]</span>
<span id="cb17-415"><a href="#cb17-415" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cat <span class="op">==</span> <span class="st">'Premium'</span>:</span>
<span id="cb17-416"><a href="#cb17-416" aria-hidden="true" tabindex="-1"></a>        bg_color <span class="op">=</span> <span class="st">'#e8f4f8'</span></span>
<span id="cb17-417"><a href="#cb17-417" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> cat <span class="op">==</span> <span class="st">'Budget'</span>:</span>
<span id="cb17-418"><a href="#cb17-418" aria-hidden="true" tabindex="-1"></a>        bg_color <span class="op">=</span> <span class="st">'#f0f8e8'</span></span>
<span id="cb17-419"><a href="#cb17-419" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb17-420"><a href="#cb17-420" aria-hidden="true" tabindex="-1"></a>        bg_color <span class="op">=</span> <span class="st">'#fff9e6'</span></span>
<span id="cb17-421"><a href="#cb17-421" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-422"><a href="#cb17-422" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="ss">f'background-color: </span><span class="sc">{</span>bg_color<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> _ <span class="kw">in</span> row]</span>
<span id="cb17-423"><a href="#cb17-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-424"><a href="#cb17-424" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Render Table</span></span>
<span id="cb17-425"><a href="#cb17-425" aria-hidden="true" tabindex="-1"></a>show(</span>
<span id="cb17-426"><a href="#cb17-426" aria-hidden="true" tabindex="-1"></a>    df_models.style.<span class="bu">apply</span>(color_by_category, axis<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb17-427"><a href="#cb17-427" aria-hidden="true" tabindex="-1"></a>    classes<span class="op">=</span><span class="st">"display"</span>, </span>
<span id="cb17-428"><a href="#cb17-428" aria-hidden="true" tabindex="-1"></a>    scrollX<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb17-429"><a href="#cb17-429" aria-hidden="true" tabindex="-1"></a>    columnDefs<span class="op">=</span>[</span>
<span id="cb17-430"><a href="#cb17-430" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"className"</span>: <span class="st">"dt-center"</span>, <span class="st">"targets"</span>: <span class="st">"_all"</span>},</span>
<span id="cb17-431"><a href="#cb17-431" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"visible"</span>: <span class="va">False</span>, <span class="st">"targets"</span>: <span class="dv">7</span>}</span>
<span id="cb17-432"><a href="#cb17-432" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb17-433"><a href="#cb17-433" aria-hidden="true" tabindex="-1"></a>    allow_html<span class="op">=</span><span class="va">True</span></span>
<span id="cb17-434"><a href="#cb17-434" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-435"><a href="#cb17-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-436"><a href="#cb17-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-437"><a href="#cb17-437" aria-hidden="true" tabindex="-1"></a>::: {.tbl-caption}</span>
<span id="cb17-438"><a href="#cb17-438" aria-hidden="true" tabindex="-1"></a>**Table 2**. Test suite of 6 models across 3 deployment scenarios. *Estimated parameters not disclosed by providers.</span>
<span id="cb17-439"><a href="#cb17-439" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-440"><a href="#cb17-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-441"><a href="#cb17-441" aria-hidden="true" tabindex="-1"></a>Qwen 2.5 32B (4-bit quant) and Llama 3.1 70B-IQ2 (2-bit quant) are within the 24GB VRAM limit of the RTX 4090. Because Llama 3.1 70B-IQ2 is 2-bit, I also threw in Qwen 2.5 32B-Q2 to test the degradation, if any, when going from 4 to 2-bit, and get a sense of what might be missing from Llama 3.1 70B-IQ2.</span>
<span id="cb17-442"><a href="#cb17-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-443"><a href="#cb17-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-444"><a href="#cb17-444" aria-hidden="true" tabindex="-1"></a><span class="fu">### Embeddings</span></span>
<span id="cb17-445"><a href="#cb17-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-446"><a href="#cb17-446" aria-hidden="true" tabindex="-1"></a>The embedding models include commercial state of the art and some reputable open source models.</span>
<span id="cb17-447"><a href="#cb17-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-450"><a href="#cb17-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-451"><a href="#cb17-451" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-452"><a href="#cb17-452" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itables <span class="im">import</span> show</span>
<span id="cb17-453"><a href="#cb17-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-454"><a href="#cb17-454" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Prepare Data</span></span>
<span id="cb17-455"><a href="#cb17-455" aria-hidden="true" tabindex="-1"></a>embeddings_data <span class="op">=</span> [</span>
<span id="cb17-456"><a href="#cb17-456" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'OpenAI Large'</span>, <span class="st">'Dimensions'</span>: <span class="dv">3072</span>, <span class="st">'Provider'</span>: <span class="st">'OpenAI'</span>, </span>
<span id="cb17-457"><a href="#cb17-457" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0.13/1M tokens'</span>, <span class="st">'Quality'</span>: <span class="st">'⭐⭐⭐⭐⭐'</span>, <span class="st">'Selection Rationale'</span>: <span class="st">'SOTA baseline'</span>},</span>
<span id="cb17-458"><a href="#cb17-458" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'OpenAI Small'</span>, <span class="st">'Dimensions'</span>: <span class="dv">1536</span>, <span class="st">'Provider'</span>: <span class="st">'OpenAI'</span>, </span>
<span id="cb17-459"><a href="#cb17-459" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'$0.02/1M tokens'</span>, <span class="st">'Quality'</span>: <span class="st">'⭐⭐⭐⭐'</span>, <span class="st">'Selection Rationale'</span>: <span class="st">'Cost/quality balance'</span>},</span>
<span id="cb17-460"><a href="#cb17-460" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'Jina v3'</span>, <span class="st">'Dimensions'</span>: <span class="dv">1024</span>, <span class="st">'Provider'</span>: <span class="st">'Jina AI'</span>, </span>
<span id="cb17-461"><a href="#cb17-461" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'Free (local)'</span>, <span class="st">'Quality'</span>: <span class="st">'⭐⭐⭐⭐'</span>, <span class="st">'Selection Rationale'</span>: <span class="st">'Best open-source'</span>},</span>
<span id="cb17-462"><a href="#cb17-462" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'Model'</span>: <span class="st">'BGE-M3'</span>, <span class="st">'Dimensions'</span>: <span class="dv">1024</span>, <span class="st">'Provider'</span>: <span class="st">'BAAI'</span>, </span>
<span id="cb17-463"><a href="#cb17-463" aria-hidden="true" tabindex="-1"></a>     <span class="st">'Cost'</span>: <span class="st">'Free (local)'</span>, <span class="st">'Quality'</span>: <span class="st">'⭐⭐⭐'</span>, <span class="st">'Selection Rationale'</span>: <span class="st">'Popular baseline'</span>}</span>
<span id="cb17-464"><a href="#cb17-464" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-465"><a href="#cb17-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-466"><a href="#cb17-466" aria-hidden="true" tabindex="-1"></a>df_emb <span class="op">=</span> pd.DataFrame(embeddings_data)</span>
<span id="cb17-467"><a href="#cb17-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-468"><a href="#cb17-468" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Define Styling Logic</span></span>
<span id="cb17-469"><a href="#cb17-469" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_by_provider(row):</span>
<span id="cb17-470"><a href="#cb17-470" aria-hidden="true" tabindex="-1"></a>    bg_color <span class="op">=</span> <span class="st">'#e8f4f8'</span> <span class="cf">if</span> <span class="st">'OpenAI'</span> <span class="kw">in</span> row[<span class="st">'Provider'</span>] <span class="cf">else</span> <span class="st">'#f0f8e8'</span></span>
<span id="cb17-471"><a href="#cb17-471" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="ss">f'background-color: </span><span class="sc">{</span>bg_color<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> _ <span class="kw">in</span> row]</span>
<span id="cb17-472"><a href="#cb17-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-473"><a href="#cb17-473" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Render Table</span></span>
<span id="cb17-474"><a href="#cb17-474" aria-hidden="true" tabindex="-1"></a>show(</span>
<span id="cb17-475"><a href="#cb17-475" aria-hidden="true" tabindex="-1"></a>    df_emb.style.<span class="bu">apply</span>(color_by_provider, axis<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb17-476"><a href="#cb17-476" aria-hidden="true" tabindex="-1"></a>    classes<span class="op">=</span><span class="st">"display"</span>,</span>
<span id="cb17-477"><a href="#cb17-477" aria-hidden="true" tabindex="-1"></a>    scrollX<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb17-478"><a href="#cb17-478" aria-hidden="true" tabindex="-1"></a>    columnDefs<span class="op">=</span>[</span>
<span id="cb17-479"><a href="#cb17-479" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"className"</span>: <span class="st">"dt-center"</span>, <span class="st">"targets"</span>: <span class="st">"_all"</span>},</span>
<span id="cb17-480"><a href="#cb17-480" aria-hidden="true" tabindex="-1"></a>        {<span class="st">"width"</span>: <span class="st">"150px"</span>, <span class="st">"targets"</span>: <span class="dv">5</span>}</span>
<span id="cb17-481"><a href="#cb17-481" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb17-482"><a href="#cb17-482" aria-hidden="true" tabindex="-1"></a>    allow_html<span class="op">=</span><span class="va">True</span></span>
<span id="cb17-483"><a href="#cb17-483" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-484"><a href="#cb17-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-485"><a href="#cb17-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-486"><a href="#cb17-486" aria-hidden="true" tabindex="-1"></a>::: {.tbl-caption}</span>
<span id="cb17-487"><a href="#cb17-487" aria-hidden="true" tabindex="-1"></a>**Table 3**. Embedding models evaluated, showing the cost-quality trade-off landscape.</span>
<span id="cb17-488"><a href="#cb17-488" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-489"><a href="#cb17-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-490"><a href="#cb17-490" aria-hidden="true" tabindex="-1"></a><span class="fu">### LLM-as-judge scoring</span></span>
<span id="cb17-491"><a href="#cb17-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-492"><a href="#cb17-492" aria-hidden="true" tabindex="-1"></a>Answer quality was scored with a fixed judge model (GPT-5.1, temperature 0) to keep evaluations consistent across all 96 configurations. For each question, the judge received the question, the gold answer, and the system’s generated answer, and returned JSON with correctness_score and faithfulness_score in <span class="co">[</span><span class="ot">0,1</span><span class="co">]</span> plus a short justification (single deterministic pass per answer).</span>
<span id="cb17-493"><a href="#cb17-493" aria-hidden="true" tabindex="-1"></a>Interpretation: correctness measures agreement with the gold answer (paraphrases allowed). Faithfulness here is best interpreted as task/constraint adherence (e.g., not fabricating an answer when unsupported). Judging is based on the answer only (the retrieved documents are not part of the judging). Retrieval quality is evaluated separately using recall/MRR against gold document IDs. LLM judging can be style-sensitive, so results should be taken more on a relative rather than absolute basis.</span>
<span id="cb17-494"><a href="#cb17-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-495"><a href="#cb17-495" aria-hidden="true" tabindex="-1"></a>**Note on GPT-5.2 ("During preparation of this manuscript..."): ** After completion of all experiments, and while this article was being prepared, GPT-5.2 was released. A spot-check rerun was performed for the GPT-4o/OpenAI-large/SysD configuration with GPT-5.2 as the judge. The results were similar, so the conclusions appear robust to the judge version.</span>
<span id="cb17-496"><a href="#cb17-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-497"><a href="#cb17-497" aria-hidden="true" tabindex="-1"></a><span class="fu"># Results and Discussion</span></span>
<span id="cb17-498"><a href="#cb17-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-499"><a href="#cb17-499" aria-hidden="true" tabindex="-1"></a><span class="fu">### Top Configurations</span></span>
<span id="cb17-500"><a href="#cb17-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-503"><a href="#cb17-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-504"><a href="#cb17-504" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itables <span class="im">import</span> show</span>
<span id="cb17-505"><a href="#cb17-505" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-506"><a href="#cb17-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-507"><a href="#cb17-507" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">'results_table.csv'</span>)</span>
<span id="cb17-508"><a href="#cb17-508" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Prepare the Data</span></span>
<span id="cb17-509"><a href="#cb17-509" aria-hidden="true" tabindex="-1"></a>cols_to_keep <span class="op">=</span> [</span>
<span id="cb17-510"><a href="#cb17-510" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sys'</span>, <span class="st">'llm'</span>, <span class="st">'db'</span>, </span>
<span id="cb17-511"><a href="#cb17-511" aria-hidden="true" tabindex="-1"></a>    <span class="st">'correctness_score'</span>, <span class="st">'faithfulness_score'</span>, </span>
<span id="cb17-512"><a href="#cb17-512" aria-hidden="true" tabindex="-1"></a>    <span class="st">'latency_ms'</span>, <span class="st">'main_total_tokens'</span>, <span class="st">'retrieval_recall'</span></span>
<span id="cb17-513"><a href="#cb17-513" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-514"><a href="#cb17-514" aria-hidden="true" tabindex="-1"></a>table_df <span class="op">=</span> df[cols_to_keep].copy()</span>
<span id="cb17-515"><a href="#cb17-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-516"><a href="#cb17-516" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename for readability</span></span>
<span id="cb17-517"><a href="#cb17-517" aria-hidden="true" tabindex="-1"></a>table_df.columns <span class="op">=</span> [</span>
<span id="cb17-518"><a href="#cb17-518" aria-hidden="true" tabindex="-1"></a>    <span class="st">'System'</span>, <span class="st">'LLM'</span>, <span class="st">'Embedding'</span>, </span>
<span id="cb17-519"><a href="#cb17-519" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Correctness'</span>, <span class="st">'Faithfulness'</span>, </span>
<span id="cb17-520"><a href="#cb17-520" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Latency (ms)'</span>, <span class="st">'Tokens'</span>, <span class="st">'Recall'</span></span>
<span id="cb17-521"><a href="#cb17-521" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-522"><a href="#cb17-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-523"><a href="#cb17-523" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean System Names</span></span>
<span id="cb17-524"><a href="#cb17-524" aria-hidden="true" tabindex="-1"></a>system_map <span class="op">=</span> {</span>
<span id="cb17-525"><a href="#cb17-525" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysA"</span>: <span class="st">"A (Naive)"</span>, <span class="st">"SysC"</span>: <span class="st">"B (Hybrid)"</span>, </span>
<span id="cb17-526"><a href="#cb17-526" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysD"</span>: <span class="st">"C (Agentic)"</span>, <span class="st">"SysG"</span>: <span class="st">"D (God Mode)"</span></span>
<span id="cb17-527"><a href="#cb17-527" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-528"><a href="#cb17-528" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'System'</span>] <span class="op">=</span> table_df[<span class="st">'System'</span>].<span class="bu">map</span>(<span class="kw">lambda</span> x: system_map.get(x, x))</span>
<span id="cb17-529"><a href="#cb17-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-530"><a href="#cb17-530" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by Correctness (Default view)</span></span>
<span id="cb17-531"><a href="#cb17-531" aria-hidden="true" tabindex="-1"></a>table_df <span class="op">=</span> table_df.sort_values(by<span class="op">=</span><span class="st">'Correctness'</span>, ascending<span class="op">=</span><span class="va">False</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-532"><a href="#cb17-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-533"><a href="#cb17-533" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Format the Values for Display</span></span>
<span id="cb17-534"><a href="#cb17-534" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'Correctness'</span>] <span class="op">=</span> table_df[<span class="st">'Correctness'</span>].<span class="bu">map</span>(<span class="st">'</span><span class="sc">{:.3f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb17-535"><a href="#cb17-535" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'Faithfulness'</span>] <span class="op">=</span> table_df[<span class="st">'Faithfulness'</span>].<span class="bu">map</span>(<span class="st">'</span><span class="sc">{:.3f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb17-536"><a href="#cb17-536" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'Recall'</span>] <span class="op">=</span> table_df[<span class="st">'Recall'</span>].<span class="bu">map</span>(<span class="st">'</span><span class="sc">{:.3f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb17-537"><a href="#cb17-537" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'Latency (ms)'</span>] <span class="op">=</span> table_df[<span class="st">'Latency (ms)'</span>].<span class="bu">map</span>(<span class="st">'</span><span class="sc">{:,.0f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb17-538"><a href="#cb17-538" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'Tokens'</span>] <span class="op">=</span> table_df[<span class="st">'Tokens'</span>].<span class="bu">map</span>(<span class="st">'</span><span class="sc">{:,.0f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb17-539"><a href="#cb17-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-540"><a href="#cb17-540" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'Embedding'</span>]<span class="op">=</span>table_df[<span class="st">'Embedding'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.replace(<span class="st">''</span>,<span class="st">''</span>))</span>
<span id="cb17-541"><a href="#cb17-541" aria-hidden="true" tabindex="-1"></a>table_df[<span class="st">'LLM'</span>]<span class="op">=</span>table_df[<span class="st">'LLM'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.replace(<span class="st">'flash-latest'</span>,<span class="st">'2.5-flash'</span>))</span>
<span id="cb17-542"><a href="#cb17-542" aria-hidden="true" tabindex="-1"></a>show(</span>
<span id="cb17-543"><a href="#cb17-543" aria-hidden="true" tabindex="-1"></a>    table_df, </span>
<span id="cb17-544"><a href="#cb17-544" aria-hidden="true" tabindex="-1"></a>    classes<span class="op">=</span><span class="st">"display compact"</span>,</span>
<span id="cb17-545"><a href="#cb17-545" aria-hidden="true" tabindex="-1"></a>    paging<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb17-546"><a href="#cb17-546" aria-hidden="true" tabindex="-1"></a>    scrollX<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb17-547"><a href="#cb17-547" aria-hidden="true" tabindex="-1"></a>    order<span class="op">=</span>[[<span class="dv">3</span>, <span class="st">'desc'</span>]],</span>
<span id="cb17-548"><a href="#cb17-548" aria-hidden="true" tabindex="-1"></a>    columnDefs<span class="op">=</span>[{<span class="st">"className"</span>: <span class="st">"dt-center"</span>, <span class="st">"targets"</span>: <span class="st">"_all"</span>}]</span>
<span id="cb17-549"><a href="#cb17-549" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-550"><a href="#cb17-550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-551"><a href="#cb17-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-552"><a href="#cb17-552" aria-hidden="true" tabindex="-1"></a>::: {.tbl-caption}</span>
<span id="cb17-553"><a href="#cb17-553" aria-hidden="true" tabindex="-1"></a>**Table 4**. All 96 configurations ranked by correctness score (default sort).</span>
<span id="cb17-554"><a href="#cb17-554" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-555"><a href="#cb17-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-556"><a href="#cb17-556" aria-hidden="true" tabindex="-1"></a>Table 4 shows the raw results for all 96 evaluated configurations, sorted by correctness. Each row corresponds to a unique configuration of RAG system architecture, LLM, and embedding model; with additional columns for metrics such as faithfulness, latency, token usage, and retrieval recall. </span>
<span id="cb17-557"><a href="#cb17-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-558"><a href="#cb17-558" aria-hidden="true" tabindex="-1"></a>A cursory look at the table shows a few high-level patterns. First, there appears to be a relatively narrow band of configurations at around 70% correctness, no model "convincingly" better than the rest. GPT-4o expectedly shows up in many of the top-ranked configurations, but some open-source LLMs and embedding models show up as well, such as Qwen2.5 32B and Jina-V3 for embeddings. </span>
<span id="cb17-559"><a href="#cb17-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-560"><a href="#cb17-560" aria-hidden="true" tabindex="-1"></a>Latency and token usage vary more widely. Some configurations achieve among the highest correctness with relatively low latency (~1000ms), while others suffer a latency penalty with no corresponding gains. Is there a benefit to the lower-ranked configurations in a more comprehensive cost-benefit analysis? This question is examined more in later sections.</span>
<span id="cb17-561"><a href="#cb17-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-562"><a href="#cb17-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-563"><a href="#cb17-563" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb17-564"><a href="#cb17-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-565"><a href="#cb17-565" aria-hidden="true" tabindex="-1"></a><span class="fu">### By Model</span></span>
<span id="cb17-568"><a href="#cb17-568" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-569"><a href="#cb17-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb17-570"><a href="#cb17-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 1</span></span>
<span id="cb17-571"><a href="#cb17-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-572"><a href="#cb17-572" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb17-573"><a href="#cb17-573" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb17-574"><a href="#cb17-574" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-575"><a href="#cb17-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-576"><a href="#cb17-576" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'results_table.csv'</span>)</span>
<span id="cb17-577"><a href="#cb17-577" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'llm'</span>]<span class="op">=</span>df[<span class="st">'llm'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.replace(<span class="st">'gemini-flash-latest'</span>,<span class="st">'gemini-2.5-flash'</span>))</span>
<span id="cb17-578"><a href="#cb17-578" aria-hidden="true" tabindex="-1"></a>nano_colors <span class="op">=</span> [<span class="st">"#636EFA"</span>, <span class="st">"#EF553B"</span>, <span class="st">"#00CC96"</span>, <span class="st">"#AB63FA"</span>, <span class="st">"#FFA15A"</span>]</span>
<span id="cb17-579"><a href="#cb17-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-580"><a href="#cb17-580" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> style_figure(fig, y_title):</span>
<span id="cb17-581"><a href="#cb17-581" aria-hidden="true" tabindex="-1"></a>    fig.update_layout(</span>
<span id="cb17-582"><a href="#cb17-582" aria-hidden="true" tabindex="-1"></a>        yaxis_title<span class="op">=</span>y_title,</span>
<span id="cb17-583"><a href="#cb17-583" aria-hidden="true" tabindex="-1"></a>        template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb17-584"><a href="#cb17-584" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb17-585"><a href="#cb17-585" aria-hidden="true" tabindex="-1"></a>        showlegend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb17-586"><a href="#cb17-586" aria-hidden="true" tabindex="-1"></a>        font<span class="op">=</span><span class="bu">dict</span>(family<span class="op">=</span><span class="st">"Arial"</span>, size<span class="op">=</span><span class="dv">14</span>),</span>
<span id="cb17-587"><a href="#cb17-587" aria-hidden="true" tabindex="-1"></a>        autosize<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb17-588"><a href="#cb17-588" aria-hidden="true" tabindex="-1"></a>        margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">0</span>, r<span class="op">=</span><span class="dv">0</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb17-589"><a href="#cb17-589" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-590"><a href="#cb17-590" aria-hidden="true" tabindex="-1"></a>    fig.update_traces(meanline_visible<span class="op">=</span><span class="va">True</span>, points<span class="op">=</span><span class="st">'all'</span>, jitter<span class="op">=</span><span class="fl">0.05</span>,</span>
<span id="cb17-591"><a href="#cb17-591" aria-hidden="true" tabindex="-1"></a>                      marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">4</span>, opacity<span class="op">=</span><span class="fl">0.6</span>))</span>
<span id="cb17-592"><a href="#cb17-592" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fig</span>
<span id="cb17-593"><a href="#cb17-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-594"><a href="#cb17-594" aria-hidden="true" tabindex="-1"></a>fig_llm <span class="op">=</span> px.violin(</span>
<span id="cb17-595"><a href="#cb17-595" aria-hidden="true" tabindex="-1"></a>    df, x<span class="op">=</span><span class="st">"llm"</span>, y<span class="op">=</span><span class="st">"correctness_score"</span>, color<span class="op">=</span><span class="st">"llm"</span>,</span>
<span id="cb17-596"><a href="#cb17-596" aria-hidden="true" tabindex="-1"></a>    box<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb17-597"><a href="#cb17-597" aria-hidden="true" tabindex="-1"></a>    color_discrete_sequence<span class="op">=</span>nano_colors</span>
<span id="cb17-598"><a href="#cb17-598" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-599"><a href="#cb17-599" aria-hidden="true" tabindex="-1"></a>style_figure(fig_llm, <span class="st">"Correctness Score"</span>)</span>
<span id="cb17-600"><a href="#cb17-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-601"><a href="#cb17-601" aria-hidden="true" tabindex="-1"></a>fig_llm.show(config<span class="op">=</span>{<span class="st">'responsive'</span>: <span class="va">True</span>})</span>
<span id="cb17-602"><a href="#cb17-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-603"><a href="#cb17-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-604"><a href="#cb17-604" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-605"><a href="#cb17-605" aria-hidden="true" tabindex="-1"></a>**Figure 3**. LLM performance distribution shows Llama 70B-IQ2's high variance under 2-bit quantization.</span>
<span id="cb17-606"><a href="#cb17-606" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-607"><a href="#cb17-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-608"><a href="#cb17-608" aria-hidden="true" tabindex="-1"></a><span class="fu">### By Embedding</span></span>
<span id="cb17-611"><a href="#cb17-611" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-612"><a href="#cb17-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb17-613"><a href="#cb17-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-614"><a href="#cb17-614" aria-hidden="true" tabindex="-1"></a>fig_db <span class="op">=</span> px.violin(</span>
<span id="cb17-615"><a href="#cb17-615" aria-hidden="true" tabindex="-1"></a>    df, x<span class="op">=</span><span class="st">"db"</span>, y<span class="op">=</span><span class="st">"correctness_score"</span>, color<span class="op">=</span><span class="st">"db"</span>,</span>
<span id="cb17-616"><a href="#cb17-616" aria-hidden="true" tabindex="-1"></a>    box<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb17-617"><a href="#cb17-617" aria-hidden="true" tabindex="-1"></a>    color_discrete_sequence<span class="op">=</span>nano_colors</span>
<span id="cb17-618"><a href="#cb17-618" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-619"><a href="#cb17-619" aria-hidden="true" tabindex="-1"></a>style_figure(fig_db, <span class="st">"Correctness Score"</span>)</span>
<span id="cb17-620"><a href="#cb17-620" aria-hidden="true" tabindex="-1"></a>fig_db.show(config<span class="op">=</span>{<span class="st">'responsive'</span>: <span class="va">True</span>})</span>
<span id="cb17-621"><a href="#cb17-621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-622"><a href="#cb17-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-623"><a href="#cb17-623" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-624"><a href="#cb17-624" aria-hidden="true" tabindex="-1"></a>**Figure 4**. Embedding model performance shows free Jina-v3 matching paid OpenAI, with BGE-M3 notably worse.</span>
<span id="cb17-625"><a href="#cb17-625" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-626"><a href="#cb17-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-627"><a href="#cb17-627" aria-hidden="true" tabindex="-1"></a><span class="fu">### By System</span></span>
<span id="cb17-630"><a href="#cb17-630" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-631"><a href="#cb17-631" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb17-632"><a href="#cb17-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-633"><a href="#cb17-633" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_sys(name):</span>
<span id="cb17-634"><a href="#cb17-634" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysA"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System A"</span></span>
<span id="cb17-635"><a href="#cb17-635" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysC"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System B"</span></span>
<span id="cb17-636"><a href="#cb17-636" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysD"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System C"</span></span>
<span id="cb17-637"><a href="#cb17-637" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysG"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System D"</span></span>
<span id="cb17-638"><a href="#cb17-638" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name</span>
<span id="cb17-639"><a href="#cb17-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-640"><a href="#cb17-640" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'clean_sys'</span>] <span class="op">=</span> df[<span class="st">'sys'</span>].<span class="bu">apply</span>(clean_sys)</span>
<span id="cb17-641"><a href="#cb17-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-642"><a href="#cb17-642" aria-hidden="true" tabindex="-1"></a>fig_sys <span class="op">=</span> px.violin(</span>
<span id="cb17-643"><a href="#cb17-643" aria-hidden="true" tabindex="-1"></a>    df, x<span class="op">=</span><span class="st">"clean_sys"</span>, y<span class="op">=</span><span class="st">"correctness_score"</span>, color<span class="op">=</span><span class="st">"clean_sys"</span>,</span>
<span id="cb17-644"><a href="#cb17-644" aria-hidden="true" tabindex="-1"></a>    box<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb17-645"><a href="#cb17-645" aria-hidden="true" tabindex="-1"></a>    color_discrete_map<span class="op">=</span>{</span>
<span id="cb17-646"><a href="#cb17-646" aria-hidden="true" tabindex="-1"></a>        <span class="st">"System A"</span>: <span class="st">"#636EFA"</span>, </span>
<span id="cb17-647"><a href="#cb17-647" aria-hidden="true" tabindex="-1"></a>        <span class="st">"System B"</span>: <span class="st">"#EF553B"</span>, </span>
<span id="cb17-648"><a href="#cb17-648" aria-hidden="true" tabindex="-1"></a>        <span class="st">"System C"</span>: <span class="st">"#00CC96"</span>, </span>
<span id="cb17-649"><a href="#cb17-649" aria-hidden="true" tabindex="-1"></a>        <span class="st">"System D"</span>: <span class="st">"#AB63FA"</span></span>
<span id="cb17-650"><a href="#cb17-650" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-651"><a href="#cb17-651" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-652"><a href="#cb17-652" aria-hidden="true" tabindex="-1"></a>style_figure(fig_sys, <span class="st">"Correctness Score"</span>)</span>
<span id="cb17-653"><a href="#cb17-653" aria-hidden="true" tabindex="-1"></a>fig_sys.update_xaxes(categoryorder<span class="op">=</span><span class="st">'array'</span>, categoryarray<span class="op">=</span>[<span class="st">'System A'</span>, <span class="st">'System B'</span>, <span class="st">'System C'</span>, <span class="st">'System D'</span>])</span>
<span id="cb17-654"><a href="#cb17-654" aria-hidden="true" tabindex="-1"></a>fig_sys.show(config<span class="op">=</span>{<span class="st">'responsive'</span>: <span class="va">True</span>})</span>
<span id="cb17-655"><a href="#cb17-655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-656"><a href="#cb17-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-657"><a href="#cb17-657" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-658"><a href="#cb17-658" aria-hidden="true" tabindex="-1"></a>**Figure 5**. System architecture stability. 'God Mode' (System D) exhibits high variance.</span>
<span id="cb17-659"><a href="#cb17-659" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-660"><a href="#cb17-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-661"><a href="#cb17-661" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-662"><a href="#cb17-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-663"><a href="#cb17-663" aria-hidden="true" tabindex="-1"></a>To move beyond ranked averages, Figures 3-5 visualize correctness distributions using violin plots grouped by generator model (LLM), embedding model, and system architecture (use the tabs in Figure 3 to see Figures 4 and 5). </span>
<span id="cb17-664"><a href="#cb17-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-665"><a href="#cb17-665" aria-hidden="true" tabindex="-1"></a>When grouped by generator model, most models exhibit relatively tight distributions centered around the mid-0.6 range. However, Llama 3.1 70B-IQ2 stands out with a much broader variance: while some configurations within this LLM perform competitively, others degrade sharply, producing a long lower tail. This suggests that the model’s performance is highly sensitive to other components of its configuration.</span>
<span id="cb17-666"><a href="#cb17-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-667"><a href="#cb17-667" aria-hidden="true" tabindex="-1"></a>Grouping by embedding model reveals a more modest effect. OpenAI and Jina embeddings produce slightly higher median correctness and tighter distributions, while bge-m3 shows greater variance and a lower median. Importantly, embeddings seem to influence consistency more than peak performance.</span>
<span id="cb17-668"><a href="#cb17-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-669"><a href="#cb17-669" aria-hidden="true" tabindex="-1"></a>The most striking pattern appears when results are grouped by system architecture. Systems A, B, and C exhibit relatively narrow distributions, with gradual improvements from naive retrieval (System A) to hybrid filtering/routing (System B) and light agentic control via rewriting + grading (System C). In contrast, System D (“God Mode”) shows substantially higher variance. It appears among both the highest (approaching the ~70% ceiling) and lowest-scoring configurations across the entire study. Rather than breaking through the ceiling, System D appears to be introducing failure modes with its additional complexity that appear when paired with certain models. In any case, these results suggest that increasing RAG sophistication does not necessarily translate to improved performance.</span>
<span id="cb17-670"><a href="#cb17-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-671"><a href="#cb17-671" aria-hidden="true" tabindex="-1"></a>What are the conditions that lead to System D's underperformance? The following sections examine this.</span>
<span id="cb17-672"><a href="#cb17-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-673"><a href="#cb17-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-674"><a href="#cb17-674" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correctness, Cost, and Latency</span></span>
<span id="cb17-675"><a href="#cb17-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-678"><a href="#cb17-678" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-679"><a href="#cb17-679" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb17-680"><a href="#cb17-680" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb17-681"><a href="#cb17-681" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-682"><a href="#cb17-682" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  <span class="co"># Added for log calculation</span></span>
<span id="cb17-683"><a href="#cb17-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-684"><a href="#cb17-684" aria-hidden="true" tabindex="-1"></a>sys_config <span class="op">=</span> {</span>
<span id="cb17-685"><a href="#cb17-685" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysA"</span>: {<span class="st">"label"</span>: <span class="st">"SysA"</span>,    <span class="st">"color"</span>: <span class="st">"#4C72B0"</span>},</span>
<span id="cb17-686"><a href="#cb17-686" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysC"</span>: {<span class="st">"label"</span>: <span class="st">"SysB"</span>,   <span class="st">"color"</span>: <span class="st">"#DD8452"</span>},</span>
<span id="cb17-687"><a href="#cb17-687" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysD"</span>: {<span class="st">"label"</span>: <span class="st">"SysC"</span>,  <span class="st">"color"</span>: <span class="st">"#55A868"</span>},</span>
<span id="cb17-688"><a href="#cb17-688" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysG"</span>: {<span class="st">"label"</span>: <span class="st">"SysD"</span>, <span class="st">"color"</span>: <span class="st">"#C44E52"</span>}</span>
<span id="cb17-689"><a href="#cb17-689" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-690"><a href="#cb17-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-691"><a href="#cb17-691" aria-hidden="true" tabindex="-1"></a>color_map_final <span class="op">=</span> {v[<span class="st">'label'</span>]: v[<span class="st">'color'</span>] <span class="cf">for</span> k, v <span class="kw">in</span> sys_config.items()}</span>
<span id="cb17-692"><a href="#cb17-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-693"><a href="#cb17-693" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'results_table.csv'</span>)</span>
<span id="cb17-694"><a href="#cb17-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-695"><a href="#cb17-695" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'db'</span>]<span class="op">=</span>df[<span class="st">'db'</span>].replace(<span class="st">'jina-embeddings-v3'</span>,<span class="st">'jina-v3'</span>)</span>
<span id="cb17-696"><a href="#cb17-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-697"><a href="#cb17-697" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_system_label(name):</span>
<span id="cb17-698"><a href="#cb17-698" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key, config <span class="kw">in</span> sys_config.items():</span>
<span id="cb17-699"><a href="#cb17-699" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> key <span class="kw">in</span> name:</span>
<span id="cb17-700"><a href="#cb17-700" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> config[<span class="st">'label'</span>]</span>
<span id="cb17-701"><a href="#cb17-701" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name</span>
<span id="cb17-702"><a href="#cb17-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-703"><a href="#cb17-703" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Article_System'</span>] <span class="op">=</span> df[<span class="st">'experiment_name'</span>].<span class="bu">apply</span>(get_system_label)</span>
<span id="cb17-704"><a href="#cb17-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-705"><a href="#cb17-705" aria-hidden="true" tabindex="-1"></a>fig_main <span class="op">=</span> px.scatter(</span>
<span id="cb17-706"><a href="#cb17-706" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb17-707"><a href="#cb17-707" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"latency_ms"</span>,</span>
<span id="cb17-708"><a href="#cb17-708" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"correctness_score"</span>,</span>
<span id="cb17-709"><a href="#cb17-709" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"Article_System"</span>,</span>
<span id="cb17-710"><a href="#cb17-710" aria-hidden="true" tabindex="-1"></a>    symbol<span class="op">=</span><span class="st">"db"</span>,</span>
<span id="cb17-711"><a href="#cb17-711" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"correctness_score"</span>,</span>
<span id="cb17-712"><a href="#cb17-712" aria-hidden="true" tabindex="-1"></a>    hover_data<span class="op">=</span>[<span class="st">"llm"</span>, <span class="st">"experiment_name"</span>, <span class="st">"main_total_tokens"</span>],</span>
<span id="cb17-713"><a href="#cb17-713" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb17-714"><a href="#cb17-714" aria-hidden="true" tabindex="-1"></a>    color_discrete_map<span class="op">=</span>color_map_final</span>
<span id="cb17-715"><a href="#cb17-715" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-716"><a href="#cb17-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-717"><a href="#cb17-717" aria-hidden="true" tabindex="-1"></a>fig_main.add_vline(x<span class="op">=</span><span class="dv">1000</span>, line_width<span class="op">=</span><span class="dv">1</span>, line_dash<span class="op">=</span><span class="st">"dash"</span>, line_color<span class="op">=</span><span class="st">"grey"</span>, annotation_text<span class="op">=</span><span class="st">"1s UX Target"</span>)</span>
<span id="cb17-718"><a href="#cb17-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-719"><a href="#cb17-719" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Pareto Frontier</span></span>
<span id="cb17-720"><a href="#cb17-720" aria-hidden="true" tabindex="-1"></a>sorted_df <span class="op">=</span> df.sort_values(<span class="st">'latency_ms'</span>)</span>
<span id="cb17-721"><a href="#cb17-721" aria-hidden="true" tabindex="-1"></a>frontier_points <span class="op">=</span> []</span>
<span id="cb17-722"><a href="#cb17-722" aria-hidden="true" tabindex="-1"></a>max_correctness <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb17-723"><a href="#cb17-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-724"><a href="#cb17-724" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> sorted_df.iterrows():</span>
<span id="cb17-725"><a href="#cb17-725" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row[<span class="st">'correctness_score'</span>] <span class="op">&gt;</span> max_correctness:</span>
<span id="cb17-726"><a href="#cb17-726" aria-hidden="true" tabindex="-1"></a>        frontier_points.append(row)</span>
<span id="cb17-727"><a href="#cb17-727" aria-hidden="true" tabindex="-1"></a>        max_correctness <span class="op">=</span> row[<span class="st">'correctness_score'</span>]</span>
<span id="cb17-728"><a href="#cb17-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-729"><a href="#cb17-729" aria-hidden="true" tabindex="-1"></a>frontier_df <span class="op">=</span> pd.DataFrame(frontier_points)</span>
<span id="cb17-730"><a href="#cb17-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-731"><a href="#cb17-731" aria-hidden="true" tabindex="-1"></a>fig_main.add_trace(</span>
<span id="cb17-732"><a href="#cb17-732" aria-hidden="true" tabindex="-1"></a>    go.Scatter(</span>
<span id="cb17-733"><a href="#cb17-733" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>frontier_df[<span class="st">'latency_ms'</span>],</span>
<span id="cb17-734"><a href="#cb17-734" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>frontier_df[<span class="st">'correctness_score'</span>],</span>
<span id="cb17-735"><a href="#cb17-735" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb17-736"><a href="#cb17-736" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="st">'Efficiency Frontier'</span>,</span>
<span id="cb17-737"><a href="#cb17-737" aria-hidden="true" tabindex="-1"></a>        line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>, width<span class="op">=</span><span class="dv">2</span>, dash<span class="op">=</span><span class="st">'dash'</span>)</span>
<span id="cb17-738"><a href="#cb17-738" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-739"><a href="#cb17-739" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-740"><a href="#cb17-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-741"><a href="#cb17-741" aria-hidden="true" tabindex="-1"></a><span class="co"># --- NEW: Calculate ranges dynamically ---</span></span>
<span id="cb17-742"><a href="#cb17-742" aria-hidden="true" tabindex="-1"></a>min_lat <span class="op">=</span> df[<span class="st">'latency_ms'</span>].<span class="bu">min</span>()</span>
<span id="cb17-743"><a href="#cb17-743" aria-hidden="true" tabindex="-1"></a>max_lat <span class="op">=</span> df[<span class="st">'latency_ms'</span>].<span class="bu">max</span>()</span>
<span id="cb17-744"><a href="#cb17-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-745"><a href="#cb17-745" aria-hidden="true" tabindex="-1"></a><span class="co"># Log Range (Plotly expects log10 values for range when type='log')</span></span>
<span id="cb17-746"><a href="#cb17-746" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding ~5% padding so bubbles don't get cut off</span></span>
<span id="cb17-747"><a href="#cb17-747" aria-hidden="true" tabindex="-1"></a>log_padding <span class="op">=</span> <span class="fl">0.1</span> </span>
<span id="cb17-748"><a href="#cb17-748" aria-hidden="true" tabindex="-1"></a>range_log <span class="op">=</span> [np.log10(min_lat) <span class="op">-</span> log_padding, np.log10(max_lat) <span class="op">+</span> log_padding]</span>
<span id="cb17-749"><a href="#cb17-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-750"><a href="#cb17-750" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear Range (Plotly expects absolute values)</span></span>
<span id="cb17-751"><a href="#cb17-751" aria-hidden="true" tabindex="-1"></a>lin_padding <span class="op">=</span> (max_lat <span class="op">-</span> min_lat) <span class="op">*</span> <span class="fl">0.05</span></span>
<span id="cb17-752"><a href="#cb17-752" aria-hidden="true" tabindex="-1"></a>range_linear <span class="op">=</span> [min_lat <span class="op">-</span> lin_padding, max_lat <span class="op">+</span> lin_padding]</span>
<span id="cb17-753"><a href="#cb17-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-754"><a href="#cb17-754" aria-hidden="true" tabindex="-1"></a><span class="co"># Define buttons with explicit ranges</span></span>
<span id="cb17-755"><a href="#cb17-755" aria-hidden="true" tabindex="-1"></a>updatemenus <span class="op">=</span> [</span>
<span id="cb17-756"><a href="#cb17-756" aria-hidden="true" tabindex="-1"></a>    <span class="bu">dict</span>(</span>
<span id="cb17-757"><a href="#cb17-757" aria-hidden="true" tabindex="-1"></a>        <span class="bu">type</span><span class="op">=</span><span class="st">"buttons"</span>,</span>
<span id="cb17-758"><a href="#cb17-758" aria-hidden="true" tabindex="-1"></a>        direction<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb17-759"><a href="#cb17-759" aria-hidden="true" tabindex="-1"></a>        buttons<span class="op">=</span><span class="bu">list</span>([</span>
<span id="cb17-760"><a href="#cb17-760" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(</span>
<span id="cb17-761"><a href="#cb17-761" aria-hidden="true" tabindex="-1"></a>                args<span class="op">=</span>[{</span>
<span id="cb17-762"><a href="#cb17-762" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"xaxis.type"</span>: <span class="st">"log"</span>, </span>
<span id="cb17-763"><a href="#cb17-763" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"xaxis.range"</span>: range_log</span>
<span id="cb17-764"><a href="#cb17-764" aria-hidden="true" tabindex="-1"></a>                }],</span>
<span id="cb17-765"><a href="#cb17-765" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">"Log Scale"</span>,</span>
<span id="cb17-766"><a href="#cb17-766" aria-hidden="true" tabindex="-1"></a>                method<span class="op">=</span><span class="st">"relayout"</span></span>
<span id="cb17-767"><a href="#cb17-767" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb17-768"><a href="#cb17-768" aria-hidden="true" tabindex="-1"></a>            <span class="bu">dict</span>(</span>
<span id="cb17-769"><a href="#cb17-769" aria-hidden="true" tabindex="-1"></a>                args<span class="op">=</span>[{</span>
<span id="cb17-770"><a href="#cb17-770" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"xaxis.type"</span>: <span class="st">"linear"</span>, </span>
<span id="cb17-771"><a href="#cb17-771" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"xaxis.range"</span>: range_linear</span>
<span id="cb17-772"><a href="#cb17-772" aria-hidden="true" tabindex="-1"></a>                }],</span>
<span id="cb17-773"><a href="#cb17-773" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">"Linear Scale"</span>,</span>
<span id="cb17-774"><a href="#cb17-774" aria-hidden="true" tabindex="-1"></a>                method<span class="op">=</span><span class="st">"relayout"</span></span>
<span id="cb17-775"><a href="#cb17-775" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb17-776"><a href="#cb17-776" aria-hidden="true" tabindex="-1"></a>        ]),</span>
<span id="cb17-777"><a href="#cb17-777" aria-hidden="true" tabindex="-1"></a>        pad<span class="op">=</span>{<span class="st">"r"</span>: <span class="dv">10</span>, <span class="st">"t"</span>: <span class="dv">10</span>},</span>
<span id="cb17-778"><a href="#cb17-778" aria-hidden="true" tabindex="-1"></a>        showactive<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb17-779"><a href="#cb17-779" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.0</span>,</span>
<span id="cb17-780"><a href="#cb17-780" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb17-781"><a href="#cb17-781" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="fl">1.15</span>,</span>
<span id="cb17-782"><a href="#cb17-782" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb17-783"><a href="#cb17-783" aria-hidden="true" tabindex="-1"></a>        bgcolor<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb17-784"><a href="#cb17-784" aria-hidden="true" tabindex="-1"></a>        bordercolor<span class="op">=</span><span class="st">"#c7c7c7"</span></span>
<span id="cb17-785"><a href="#cb17-785" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb17-786"><a href="#cb17-786" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-787"><a href="#cb17-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-788"><a href="#cb17-788" aria-hidden="true" tabindex="-1"></a><span class="co"># Set default start to log</span></span>
<span id="cb17-789"><a href="#cb17-789" aria-hidden="true" tabindex="-1"></a>fig_main.update_xaxes(<span class="bu">type</span><span class="op">=</span><span class="st">"log"</span>, <span class="bu">range</span><span class="op">=</span>range_log, title<span class="op">=</span><span class="st">"Latency (ms)"</span>)</span>
<span id="cb17-790"><a href="#cb17-790" aria-hidden="true" tabindex="-1"></a>fig_main.update_yaxes(title<span class="op">=</span><span class="st">"Correctness Score"</span>)</span>
<span id="cb17-791"><a href="#cb17-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-792"><a href="#cb17-792" aria-hidden="true" tabindex="-1"></a>fig_main.update_layout(</span>
<span id="cb17-793"><a href="#cb17-793" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">700</span>, <span class="co"># Good height for mobile</span></span>
<span id="cb17-794"><a href="#cb17-794" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MARGINS:</span></span>
<span id="cb17-795"><a href="#cb17-795" aria-hidden="true" tabindex="-1"></a>    <span class="co"># t=100: Extra room at top for Title + Buttons</span></span>
<span id="cb17-796"><a href="#cb17-796" aria-hidden="true" tabindex="-1"></a>    <span class="co"># b=100: Extra room at bottom for the Legend</span></span>
<span id="cb17-797"><a href="#cb17-797" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">100</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb17-798"><a href="#cb17-798" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-799"><a href="#cb17-799" aria-hidden="true" tabindex="-1"></a>    legend_title_text<span class="op">=</span><span class="st">"Architecture"</span>,</span>
<span id="cb17-800"><a href="#cb17-800" aria-hidden="true" tabindex="-1"></a>    updatemenus<span class="op">=</span>updatemenus,</span>
<span id="cb17-801"><a href="#cb17-801" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-802"><a href="#cb17-802" aria-hidden="true" tabindex="-1"></a>    <span class="co"># LEGEND CONFIGURATION</span></span>
<span id="cb17-803"><a href="#cb17-803" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We place it horizontally at the very bottom. </span></span>
<span id="cb17-804"><a href="#cb17-804" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Since labels are short ("SysA"), they fit in one row on mobile.</span></span>
<span id="cb17-805"><a href="#cb17-805" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-806"><a href="#cb17-806" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,      <span class="co"># Horizontal (The "columns" you wanted)</span></span>
<span id="cb17-807"><a href="#cb17-807" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb17-808"><a href="#cb17-808" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.15</span>,              <span class="co"># Push it below the X-axis</span></span>
<span id="cb17-809"><a href="#cb17-809" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-810"><a href="#cb17-810" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span>                 <span class="co"># Center it</span></span>
<span id="cb17-811"><a href="#cb17-811" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-812"><a href="#cb17-812" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-813"><a href="#cb17-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-814"><a href="#cb17-814" aria-hidden="true" tabindex="-1"></a>fig_main.show()</span>
<span id="cb17-815"><a href="#cb17-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-816"><a href="#cb17-816" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-817"><a href="#cb17-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-818"><a href="#cb17-818" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-819"><a href="#cb17-819" aria-hidden="true" tabindex="-1"></a>**Figure 6**. RAG performance trade-off between correctness and latency. The efficiency frontier shows optimal configurations.</span>
<span id="cb17-820"><a href="#cb17-820" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-821"><a href="#cb17-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-822"><a href="#cb17-822" aria-hidden="true" tabindex="-1"></a>Figure 6 shows the trade-off between correctness and latency across all evaluated RAG configurations. Results are shown on a logarithmic scale for latency, to accommodate for the wide variance in latencies that appear in some of the more complex configurations.</span>
<span id="cb17-823"><a href="#cb17-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-824"><a href="#cb17-824" aria-hidden="true" tabindex="-1"></a>Several patterns are immediately apparent: first, there's a cluster of configurations in the upper left of the plot, near ~70% correctness and the 1 s threshold for latency. The configurations in these points are predominately Systems A, B, and C paired with Jina-v3 and OpenAI embeddings.</span>
<span id="cb17-825"><a href="#cb17-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-826"><a href="#cb17-826" aria-hidden="true" tabindex="-1"></a>System C in particular exhibits a favorable balance between performance and speed. Across multiple embedding choices, its configurations populate the efficiency frontier (dotted line), showing that query rewriting and relatively light agentic control can improve retrieval performance at low cost. This observation is consistent across different System C configurations.</span>
<span id="cb17-827"><a href="#cb17-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-828"><a href="#cb17-828" aria-hidden="true" tabindex="-1"></a>In contrast, System D ("God Mode") displays markedly higher variance. While some System D configurations nearly reach the efficiency frontier, others suffer severe degradation -- both in latency and accuracy -- resulting in a wide spread in both dimensions. This spread is especially pronounced for smaller or aggressively quantized models, where additional complexity appears to suffer from rather than compensate for their simplicity. </span>
<span id="cb17-829"><a href="#cb17-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-830"><a href="#cb17-830" aria-hidden="true" tabindex="-1"></a>The dashed line indicates the empirical efficiency frontier, showing that beyond a certain point, increases in system complexity do not reliably translate into improved performance. Notably, System D rarely sits on the frontier. </span>
<span id="cb17-831"><a href="#cb17-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-832"><a href="#cb17-832" aria-hidden="true" tabindex="-1"></a>Altogether, these results show an overarching finding of the study: that increased complexity does not necessarily translate to increased performance -- and can instead become a liability in certain conditions. </span>
<span id="cb17-833"><a href="#cb17-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-836"><a href="#cb17-836" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-837"><a href="#cb17-837" aria-hidden="true" tabindex="-1"></a>fig_retrieval <span class="op">=</span> px.scatter(</span>
<span id="cb17-838"><a href="#cb17-838" aria-hidden="true" tabindex="-1"></a>    df,</span>
<span id="cb17-839"><a href="#cb17-839" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"retrieval_recall"</span>,</span>
<span id="cb17-840"><a href="#cb17-840" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"retrieval_mrr"</span>,</span>
<span id="cb17-841"><a href="#cb17-841" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"Article_System"</span>,</span>
<span id="cb17-842"><a href="#cb17-842" aria-hidden="true" tabindex="-1"></a>    symbol<span class="op">=</span><span class="st">"db"</span>,</span>
<span id="cb17-843"><a href="#cb17-843" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"correctness_score"</span>,</span>
<span id="cb17-844"><a href="#cb17-844" aria-hidden="true" tabindex="-1"></a>    opacity<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb17-845"><a href="#cb17-845" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb17-846"><a href="#cb17-846" aria-hidden="true" tabindex="-1"></a>    color_discrete_map<span class="op">=</span>color_map_final,</span>
<span id="cb17-847"><a href="#cb17-847" aria-hidden="true" tabindex="-1"></a>    labels<span class="op">=</span>{</span>
<span id="cb17-848"><a href="#cb17-848" aria-hidden="true" tabindex="-1"></a>        <span class="st">"retrieval_recall"</span>: <span class="st">"Recall (Did we find it?)"</span>,</span>
<span id="cb17-849"><a href="#cb17-849" aria-hidden="true" tabindex="-1"></a>        <span class="st">"retrieval_mrr"</span>: <span class="st">"MRR (Was it at the top?)"</span>,</span>
<span id="cb17-850"><a href="#cb17-850" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Article_System"</span>: <span class="st">"Architecture"</span></span>
<span id="cb17-851"><a href="#cb17-851" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-852"><a href="#cb17-852" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-853"><a href="#cb17-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-854"><a href="#cb17-854" aria-hidden="true" tabindex="-1"></a>fig_retrieval.add_annotation(</span>
<span id="cb17-855"><a href="#cb17-855" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">1.0</span>, y<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb17-856"><a href="#cb17-856" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">"&lt;b&gt;Perfect Retrieval"</span>,</span>
<span id="cb17-857"><a href="#cb17-857" aria-hidden="true" tabindex="-1"></a>    showarrow<span class="op">=</span><span class="va">True</span>, arrowhead<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb17-858"><a href="#cb17-858" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=-</span><span class="dv">40</span>, ay<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb17-859"><a href="#cb17-859" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"rgba(255, 255, 255, 0.8)"</span>,</span>
<span id="cb17-860"><a href="#cb17-860" aria-hidden="true" tabindex="-1"></a>    bordercolor<span class="op">=</span><span class="st">"black"</span></span>
<span id="cb17-861"><a href="#cb17-861" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-862"><a href="#cb17-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-863"><a href="#cb17-863" aria-hidden="true" tabindex="-1"></a>fig_retrieval.add_annotation(</span>
<span id="cb17-864"><a href="#cb17-864" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">0.9</span>, y<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb17-865"><a href="#cb17-865" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">"&lt;b&gt;⚠️ No-Go Zone:&lt;br&gt; High Recall, Low MRR"</span>,</span>
<span id="cb17-866"><a href="#cb17-866" aria-hidden="true" tabindex="-1"></a>    showarrow<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb17-867"><a href="#cb17-867" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"rgba(255, 255, 255, 0.8)"</span>,</span>
<span id="cb17-868"><a href="#cb17-868" aria-hidden="true" tabindex="-1"></a>    font<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"orange"</span>)</span>
<span id="cb17-869"><a href="#cb17-869" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-870"><a href="#cb17-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-871"><a href="#cb17-871" aria-hidden="true" tabindex="-1"></a>fig_retrieval.add_annotation(</span>
<span id="cb17-872"><a href="#cb17-872" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">0.7</span>, y<span class="op">=</span><span class="fl">0.75</span>,</span>
<span id="cb17-873"><a href="#cb17-873" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">"&lt;b&gt;Systems C and D (Agentic)&lt;br&gt;Dominate Search&lt;/b&gt;"</span>,</span>
<span id="cb17-874"><a href="#cb17-874" aria-hidden="true" tabindex="-1"></a>    showarrow<span class="op">=</span><span class="va">True</span>, arrowhead<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb17-875"><a href="#cb17-875" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=-</span><span class="dv">35</span>, ay<span class="op">=-</span><span class="dv">40</span>,</span>
<span id="cb17-876"><a href="#cb17-876" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"rgba(255, 255, 255, 0.8)"</span>,</span>
<span id="cb17-877"><a href="#cb17-877" aria-hidden="true" tabindex="-1"></a>    bordercolor<span class="op">=</span><span class="st">"black"</span></span>
<span id="cb17-878"><a href="#cb17-878" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-879"><a href="#cb17-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-880"><a href="#cb17-880" aria-hidden="true" tabindex="-1"></a>fig_retrieval.update_layout(</span>
<span id="cb17-881"><a href="#cb17-881" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">600</span>,</span>
<span id="cb17-882"><a href="#cb17-882" aria-hidden="true" tabindex="-1"></a>    xaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[<span class="op">-</span><span class="fl">0.05</span>, <span class="fl">1.05</span>]),</span>
<span id="cb17-883"><a href="#cb17-883" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[<span class="op">-</span><span class="fl">0.05</span>, <span class="fl">1.05</span>]),</span>
<span id="cb17-884"><a href="#cb17-884" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb17-885"><a href="#cb17-885" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb17-886"><a href="#cb17-886" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-887"><a href="#cb17-887" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb17-888"><a href="#cb17-888" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb17-889"><a href="#cb17-889" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.15</span>,</span>
<span id="cb17-890"><a href="#cb17-890" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-891"><a href="#cb17-891" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb17-892"><a href="#cb17-892" aria-hidden="true" tabindex="-1"></a>        bgcolor<span class="op">=</span><span class="st">"rgba(0,0,0,0)"</span></span>
<span id="cb17-893"><a href="#cb17-893" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-894"><a href="#cb17-894" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-895"><a href="#cb17-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-896"><a href="#cb17-896" aria-hidden="true" tabindex="-1"></a>fig_retrieval.show()</span>
<span id="cb17-897"><a href="#cb17-897" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-898"><a href="#cb17-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-899"><a href="#cb17-899" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-900"><a href="#cb17-900" aria-hidden="true" tabindex="-1"></a>**Figure 7**. Retrieval quality comparing recall (did we find it?) versus MRR (was it ranked first?). Systems C and D dominate.</span>
<span id="cb17-901"><a href="#cb17-901" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-902"><a href="#cb17-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-903"><a href="#cb17-903" aria-hidden="true" tabindex="-1"></a>Figure 7 shows Mean Reciprocal Rank (MRR) vs recall. Recall indicates whether the correct document existed in the retrieved set, while MRR indicates the average reciprocal rank of any relevant document in that retrieved set. An analogy would be: imagine you're trying to find a needle in a haystack. Recall is whether that needle exists in the haystack at all, while MRR indicates how close that needle happened to be near the top of the pile. </span>
<span id="cb17-904"><a href="#cb17-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-905"><a href="#cb17-905" aria-hidden="true" tabindex="-1"></a>The data points in Figure 7 show an almost linear trend. Systems C and D clearly inhabit the "head" of the line and possess the configurations with the highest recall and MRR. It appears as though Systems C and D have complementary advantages and disadvantages: System C has the highest MRR but middling recall, while System D has the highest recall but middling MRR. The performance of each system's retrieval mechanisms are clues that could explain the differences in overall correctness for each RAG architecture, as well as the large variance in System D (see Figure 5). For System C, it seems the good MRR (positioning the relevant documents near the top of the pile) leads to not just good, but remarkably robust performance despite not having the best recall. For System D, the lower MRR seems to introduce errors that are exacerbated by certain LLMs in downstream "agentic" steps, leading to spectacular failures in certain configurations -- notably in those containing Llama 3.1 70B-IQ2. The weaknesses of RAG containing this LLM are explored in detail in later sections.</span>
<span id="cb17-906"><a href="#cb17-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-907"><a href="#cb17-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-910"><a href="#cb17-910" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-911"><a href="#cb17-911" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-912"><a href="#cb17-912" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb17-913"><a href="#cb17-913" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb17-914"><a href="#cb17-914" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-915"><a href="#cb17-915" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">'results_table.csv'</span>)</span>
<span id="cb17-916"><a href="#cb17-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-917"><a href="#cb17-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-918"><a href="#cb17-918" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_and_rename_sys(name):</span>
<span id="cb17-919"><a href="#cb17-919" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysA"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System A (Naive)"</span></span>
<span id="cb17-920"><a href="#cb17-920" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysC"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System B (Hybrid)"</span></span>
<span id="cb17-921"><a href="#cb17-921" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysD"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System C (Agentic)"</span></span>
<span id="cb17-922"><a href="#cb17-922" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysG"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System D (God Mode)"</span></span>
<span id="cb17-923"><a href="#cb17-923" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name</span>
<span id="cb17-924"><a href="#cb17-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-925"><a href="#cb17-925" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Article_System'</span>] <span class="op">=</span> df[<span class="st">'experiment_name'</span>].<span class="bu">apply</span>(clean_and_rename_sys)</span>
<span id="cb17-926"><a href="#cb17-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-927"><a href="#cb17-927" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb17-928"><a href="#cb17-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-929"><a href="#cb17-929" aria-hidden="true" tabindex="-1"></a>system_colors <span class="op">=</span> {</span>
<span id="cb17-930"><a href="#cb17-930" aria-hidden="true" tabindex="-1"></a>    <span class="st">'System A (Naive)'</span>: <span class="st">'#3498db'</span>,</span>
<span id="cb17-931"><a href="#cb17-931" aria-hidden="true" tabindex="-1"></a>    <span class="st">'System B (Hybrid)'</span>: <span class="st">'#f39c12'</span>,</span>
<span id="cb17-932"><a href="#cb17-932" aria-hidden="true" tabindex="-1"></a>    <span class="st">'System C (Agentic)'</span>: <span class="st">'#2ecc71'</span>,</span>
<span id="cb17-933"><a href="#cb17-933" aria-hidden="true" tabindex="-1"></a>    <span class="st">'System D (God Mode)'</span>: <span class="st">'#9b59b6'</span></span>
<span id="cb17-934"><a href="#cb17-934" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-935"><a href="#cb17-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-936"><a href="#cb17-936" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> system <span class="kw">in</span> <span class="bu">sorted</span>(df[<span class="st">'Article_System'</span>].unique()):</span>
<span id="cb17-937"><a href="#cb17-937" aria-hidden="true" tabindex="-1"></a>    system_df <span class="op">=</span> df[df[<span class="st">'Article_System'</span>] <span class="op">==</span> system]</span>
<span id="cb17-938"><a href="#cb17-938" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-939"><a href="#cb17-939" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(go.Scatter(</span>
<span id="cb17-940"><a href="#cb17-940" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>system_df[<span class="st">'main_total_tokens'</span>],</span>
<span id="cb17-941"><a href="#cb17-941" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>system_df[<span class="st">'correctness_score'</span>],</span>
<span id="cb17-942"><a href="#cb17-942" aria-hidden="true" tabindex="-1"></a>        mode<span class="op">=</span><span class="st">'markers'</span>,</span>
<span id="cb17-943"><a href="#cb17-943" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span>system,</span>
<span id="cb17-944"><a href="#cb17-944" aria-hidden="true" tabindex="-1"></a>        marker<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-945"><a href="#cb17-945" aria-hidden="true" tabindex="-1"></a>            size<span class="op">=</span>system_df[<span class="st">'latency_ms'</span>]<span class="op">/</span><span class="dv">200</span>,</span>
<span id="cb17-946"><a href="#cb17-946" aria-hidden="true" tabindex="-1"></a>            sizemode<span class="op">=</span><span class="st">'area'</span>,</span>
<span id="cb17-947"><a href="#cb17-947" aria-hidden="true" tabindex="-1"></a>            sizemin<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb17-948"><a href="#cb17-948" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>system_colors.get(system, <span class="st">'#95a5a6'</span>),</span>
<span id="cb17-949"><a href="#cb17-949" aria-hidden="true" tabindex="-1"></a>            opacity<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb17-950"><a href="#cb17-950" aria-hidden="true" tabindex="-1"></a>            line<span class="op">=</span><span class="bu">dict</span>(width<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb17-951"><a href="#cb17-951" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb17-952"><a href="#cb17-952" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span>[<span class="ss">f"LLM: </span><span class="sc">{</span>row[<span class="st">'llm'</span>]<span class="sc">}</span><span class="ss">&lt;br&gt;Embedding: </span><span class="sc">{</span>row[<span class="st">'db'</span>]<span class="sc">}</span><span class="ss">&lt;br&gt;Latency: </span><span class="sc">{</span>row[<span class="st">'latency_ms'</span>]<span class="sc">:.0f}</span><span class="ss">ms"</span> </span>
<span id="cb17-953"><a href="#cb17-953" aria-hidden="true" tabindex="-1"></a>              <span class="cf">for</span> _, row <span class="kw">in</span> system_df.iterrows()],</span>
<span id="cb17-954"><a href="#cb17-954" aria-hidden="true" tabindex="-1"></a>        hovertemplate<span class="op">=</span><span class="st">'&lt;b&gt;%</span><span class="sc">{text}</span><span class="st">&lt;/b&gt;&lt;br&gt;Tokens: %</span><span class="sc">{x}</span><span class="st">&lt;br&gt;Accuracy: %</span><span class="sc">{y:.2%}</span><span class="st">&lt;extra&gt;&lt;/extra&gt;'</span></span>
<span id="cb17-955"><a href="#cb17-955" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb17-956"><a href="#cb17-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-957"><a href="#cb17-957" aria-hidden="true" tabindex="-1"></a>fig.add_annotation(</span>
<span id="cb17-958"><a href="#cb17-958" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="dv">2050</span>, y<span class="op">=</span><span class="fl">0.73</span>,</span>
<span id="cb17-959"><a href="#cb17-959" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">"System C: High accuracy,&lt;br&gt;Low token usage 👍"</span>,</span>
<span id="cb17-960"><a href="#cb17-960" aria-hidden="true" tabindex="-1"></a>    showarrow<span class="op">=</span><span class="va">True</span>, arrowhead<span class="op">=</span><span class="dv">2</span>, ax<span class="op">=</span><span class="dv">0</span>, ay<span class="op">=-</span><span class="dv">40</span>,</span>
<span id="cb17-961"><a href="#cb17-961" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"rgba(46, 204, 113, 0.1)"</span>,</span>
<span id="cb17-962"><a href="#cb17-962" aria-hidden="true" tabindex="-1"></a>    bordercolor<span class="op">=</span><span class="st">"#2ecc71"</span></span>
<span id="cb17-963"><a href="#cb17-963" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-964"><a href="#cb17-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-965"><a href="#cb17-965" aria-hidden="true" tabindex="-1"></a>fig.add_annotation(</span>
<span id="cb17-966"><a href="#cb17-966" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="dv">4800</span>, y<span class="op">=</span><span class="fl">0.25</span>,</span>
<span id="cb17-967"><a href="#cb17-967" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">"System D with Llama:&lt;br&gt;High cost, low accuracy"</span>,</span>
<span id="cb17-968"><a href="#cb17-968" aria-hidden="true" tabindex="-1"></a>    showarrow<span class="op">=</span><span class="va">False</span>, arrowhead<span class="op">=</span><span class="dv">2</span>, ax<span class="op">=</span><span class="dv">20</span>, ay<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb17-969"><a href="#cb17-969" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"rgba(155, 89, 182, 0.1)"</span>,</span>
<span id="cb17-970"><a href="#cb17-970" aria-hidden="true" tabindex="-1"></a>    bordercolor<span class="op">=</span><span class="st">"#9b59b6"</span></span>
<span id="cb17-971"><a href="#cb17-971" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-972"><a href="#cb17-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-973"><a href="#cb17-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-974"><a href="#cb17-974" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb17-975"><a href="#cb17-975" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"Token Usage (Cost Proxy)"</span>,</span>
<span id="cb17-976"><a href="#cb17-976" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"Accuracy"</span>,</span>
<span id="cb17-977"><a href="#cb17-977" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">650</span>, <span class="co"># Increased height to fit legend</span></span>
<span id="cb17-978"><a href="#cb17-978" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb17-979"><a href="#cb17-979" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb17-980"><a href="#cb17-980" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb17-981"><a href="#cb17-981" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-982"><a href="#cb17-982" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb17-983"><a href="#cb17-983" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb17-984"><a href="#cb17-984" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.15</span>,</span>
<span id="cb17-985"><a href="#cb17-985" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-986"><a href="#cb17-986" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb17-987"><a href="#cb17-987" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-988"><a href="#cb17-988" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-989"><a href="#cb17-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-990"><a href="#cb17-990" aria-hidden="true" tabindex="-1"></a>fig.add_hline(y<span class="op">=</span><span class="fl">0.70</span>, line_dash<span class="op">=</span><span class="st">"dash"</span>, line_color<span class="op">=</span><span class="st">"gray"</span>,</span>
<span id="cb17-991"><a href="#cb17-991" aria-hidden="true" tabindex="-1"></a>              annotation_text<span class="op">=</span><span class="st">"70% Ceiling"</span>, annotation_position<span class="op">=</span><span class="st">"top left"</span>)</span>
<span id="cb17-992"><a href="#cb17-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-993"><a href="#cb17-993" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb17-994"><a href="#cb17-994" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-995"><a href="#cb17-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-996"><a href="#cb17-996" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-997"><a href="#cb17-997" aria-hidden="true" tabindex="-1"></a>**Figure 8**. The economics of RAG showing token usage as a cost proxy versus accuracy. Bubble size indicates latency.</span>
<span id="cb17-998"><a href="#cb17-998" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-999"><a href="#cb17-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1000"><a href="#cb17-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1001"><a href="#cb17-1001" aria-hidden="true" tabindex="-1"></a>Figure 8 shows the relationship between correctness and token count, with latency indicated by bubble size. </span>
<span id="cb17-1002"><a href="#cb17-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1003"><a href="#cb17-1003" aria-hidden="true" tabindex="-1"></a>Across all systems, performance appears to peak near a ~70% accuracy ceiling. System C occupies the most favorable region of the plot, achieving near-peak accuracy with comparatively low token usage and modest latency. This suggests that the right agentic enhancements can potentially improve RAG in the present use case beyond the baseline "naive" system, and not with an unreasonable extra cost.</span>
<span id="cb17-1004"><a href="#cb17-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1005"><a href="#cb17-1005" aria-hidden="true" tabindex="-1"></a>However, System D appears to be split in performance. Some configurations showed near-peak correctness and among the lowest token use (upper left of the plot). When System D works well, it works <span class="dt">&lt;</span><span class="kw">i</span><span class="dt">&gt;</span>really<span class="dt">&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span> well. Other System D configurations showed the <span class="dt">&lt;</span><span class="kw">i</span><span class="dt">&gt;</span>highest<span class="dt">&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span> token use and the <span class="dt">&lt;</span><span class="kw">i</span><span class="dt">&gt;</span>lowest<span class="dt">&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span> correctness (lower right of the plot). These outlying points reflect systematic failure modes that emerge when complex agentic logic is paired with smaller or aggressively quantized models (vide infra).</span>
<span id="cb17-1006"><a href="#cb17-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1007"><a href="#cb17-1007" aria-hidden="true" tabindex="-1"></a>Altogether, this figure highlights an important economic implication of RAG system design: greater architectural complexity does not guarantee improved performance. In practice, increasing control depth can amplify model weaknesses, resulting in higher costs without corresponding gains in accuracy.</span>
<span id="cb17-1008"><a href="#cb17-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1011"><a href="#cb17-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-1012"><a href="#cb17-1012" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-1013"><a href="#cb17-1013" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-1014"><a href="#cb17-1014" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb17-1015"><a href="#cb17-1015" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb17-1016"><a href="#cb17-1016" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb17-1017"><a href="#cb17-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1018"><a href="#cb17-1018" aria-hidden="true" tabindex="-1"></a><span class="co"># --- UPDATE: Point to evals subdirectory ---</span></span>
<span id="cb17-1019"><a href="#cb17-1019" aria-hidden="true" tabindex="-1"></a>EVALS_DIR <span class="op">=</span> <span class="st">"evals"</span></span>
<span id="cb17-1020"><a href="#cb17-1020" aria-hidden="true" tabindex="-1"></a>results_files <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> os.listdir(EVALS_DIR) <span class="cf">if</span> i.endswith(<span class="st">'jsonl'</span>) <span class="kw">and</span> <span class="kw">not</span> i.startswith(<span class="st">'gold'</span>) <span class="kw">and</span> <span class="kw">not</span> <span class="st">'llama3.1_70b_SysG'</span> <span class="kw">in</span> i]</span>
<span id="cb17-1021"><a href="#cb17-1021" aria-hidden="true" tabindex="-1"></a>all_records <span class="op">=</span> []</span>
<span id="cb17-1022"><a href="#cb17-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1023"><a href="#cb17-1023" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> results_files:</span>
<span id="cb17-1024"><a href="#cb17-1024" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- UPDATE: Join path with directory ---</span></span>
<span id="cb17-1025"><a href="#cb17-1025" aria-hidden="true" tabindex="-1"></a>    full_path <span class="op">=</span> os.path.join(EVALS_DIR, f)</span>
<span id="cb17-1026"><a href="#cb17-1026" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(full_path, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>, errors<span class="op">=</span><span class="st">"replace"</span>) <span class="im">as</span> infile:</span>
<span id="cb17-1027"><a href="#cb17-1027" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> infile:</span>
<span id="cb17-1028"><a href="#cb17-1028" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb17-1029"><a href="#cb17-1029" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.loads(line)</span>
<span id="cb17-1030"><a href="#cb17-1030" aria-hidden="true" tabindex="-1"></a>                exp_name <span class="op">=</span> data.get(<span class="st">'experiment_name'</span>, <span class="st">''</span>)</span>
<span id="cb17-1031"><a href="#cb17-1031" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">'SysA'</span> <span class="kw">in</span> exp_name: sys_name <span class="op">=</span> <span class="st">'SysA'</span></span>
<span id="cb17-1032"><a href="#cb17-1032" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="st">'SysC'</span> <span class="kw">in</span> exp_name: sys_name <span class="op">=</span> <span class="st">'SysC'</span></span>
<span id="cb17-1033"><a href="#cb17-1033" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="st">'SysD'</span> <span class="kw">in</span> exp_name: sys_name <span class="op">=</span> <span class="st">'SysD'</span></span>
<span id="cb17-1034"><a href="#cb17-1034" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="st">'SysG'</span> <span class="kw">in</span> exp_name: sys_name <span class="op">=</span> <span class="st">'SysG'</span></span>
<span id="cb17-1035"><a href="#cb17-1035" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: sys_name <span class="op">=</span> <span class="st">'Other'</span></span>
<span id="cb17-1036"><a href="#cb17-1036" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb17-1037"><a href="#cb17-1037" aria-hidden="true" tabindex="-1"></a>                all_records.append({</span>
<span id="cb17-1038"><a href="#cb17-1038" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'System'</span>: sys_name,</span>
<span id="cb17-1039"><a href="#cb17-1039" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Question Type'</span>: data.get(<span class="st">'question_type'</span>, <span class="st">'unknown'</span>),</span>
<span id="cb17-1040"><a href="#cb17-1040" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Correctness'</span>: data.get(<span class="st">'correctness_score'</span>, <span class="dv">0</span>),</span>
<span id="cb17-1041"><a href="#cb17-1041" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Latency'</span>: data.get(<span class="st">'latency_ms'</span>, <span class="dv">0</span>),</span>
<span id="cb17-1042"><a href="#cb17-1042" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'QID'</span>: data.get(<span class="st">'question_id'</span>, <span class="va">None</span>)</span>
<span id="cb17-1043"><a href="#cb17-1043" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb17-1044"><a href="#cb17-1044" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb17-1045"><a href="#cb17-1045" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb17-1046"><a href="#cb17-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1047"><a href="#cb17-1047" aria-hidden="true" tabindex="-1"></a>df_qtype <span class="op">=</span> pd.DataFrame(all_records)</span>
<span id="cb17-1048"><a href="#cb17-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1049"><a href="#cb17-1049" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb17-1050"><a href="#cb17-1050" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Map raw system names</span></span>
<span id="cb17-1051"><a href="#cb17-1051" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb17-1052"><a href="#cb17-1052" aria-hidden="true" tabindex="-1"></a>SYSTEM_MAP <span class="op">=</span> {</span>
<span id="cb17-1053"><a href="#cb17-1053" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysA"</span>: <span class="st">"A"</span>,</span>
<span id="cb17-1054"><a href="#cb17-1054" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysC"</span>: <span class="st">"B"</span>,</span>
<span id="cb17-1055"><a href="#cb17-1055" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysD"</span>: <span class="st">"C"</span>,</span>
<span id="cb17-1056"><a href="#cb17-1056" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysG"</span>: <span class="st">"D"</span>,</span>
<span id="cb17-1057"><a href="#cb17-1057" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-1058"><a href="#cb17-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1059"><a href="#cb17-1059" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_qtype.copy()</span>
<span id="cb17-1060"><a href="#cb17-1060" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"System_Article"</span>] <span class="op">=</span> df[<span class="st">"System"</span>].<span class="bu">map</span>(SYSTEM_MAP)</span>
<span id="cb17-1061"><a href="#cb17-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1062"><a href="#cb17-1062" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop rows with missing QID or unmapped system</span></span>
<span id="cb17-1063"><a href="#cb17-1063" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[df[<span class="st">"QID"</span>].notna() <span class="op">&amp;</span> df[<span class="st">"System_Article"</span>].notna()].copy()</span>
<span id="cb17-1064"><a href="#cb17-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1065"><a href="#cb17-1065" aria-hidden="true" tabindex="-1"></a><span class="co"># If you have multiple rows per (QID, System) from multiple configs/runs,</span></span>
<span id="cb17-1066"><a href="#cb17-1066" aria-hidden="true" tabindex="-1"></a><span class="co"># collapse to a single correctness per question per system.</span></span>
<span id="cb17-1067"><a href="#cb17-1067" aria-hidden="true" tabindex="-1"></a>df_collapsed <span class="op">=</span> (</span>
<span id="cb17-1068"><a href="#cb17-1068" aria-hidden="true" tabindex="-1"></a>    df.groupby([<span class="st">"QID"</span>, <span class="st">"System_Article"</span>], as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">"Correctness"</span>]</span>
<span id="cb17-1069"><a href="#cb17-1069" aria-hidden="true" tabindex="-1"></a>      .mean()</span>
<span id="cb17-1070"><a href="#cb17-1070" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1071"><a href="#cb17-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1072"><a href="#cb17-1072" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot to wide: columns A/B/C/D, index QID</span></span>
<span id="cb17-1073"><a href="#cb17-1073" aria-hidden="true" tabindex="-1"></a>wide <span class="op">=</span> df_collapsed.pivot(index<span class="op">=</span><span class="st">"QID"</span>, columns<span class="op">=</span><span class="st">"System_Article"</span>, values<span class="op">=</span><span class="st">"Correctness"</span>)</span>
<span id="cb17-1074"><a href="#cb17-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1075"><a href="#cb17-1075" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb17-1076"><a href="#cb17-1076" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Bootstrap helper</span></span>
<span id="cb17-1077"><a href="#cb17-1077" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb17-1078"><a href="#cb17-1078" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bootstrap_ci(data, n_boot<span class="op">=</span><span class="dv">10000</span>, ci<span class="op">=</span><span class="dv">95</span>, seed<span class="op">=</span><span class="dv">42</span>):</span>
<span id="cb17-1079"><a href="#cb17-1079" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> np.asarray(data)</span>
<span id="cb17-1080"><a href="#cb17-1080" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(data) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb17-1081"><a href="#cb17-1081" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan, np.nan, np.nan</span>
<span id="cb17-1082"><a href="#cb17-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1083"><a href="#cb17-1083" aria-hidden="true" tabindex="-1"></a>    rng <span class="op">=</span> np.random.default_rng(seed)</span>
<span id="cb17-1084"><a href="#cb17-1084" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bootstrap means</span></span>
<span id="cb17-1085"><a href="#cb17-1085" aria-hidden="true" tabindex="-1"></a>    boot_means <span class="op">=</span> np.empty(n_boot, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb17-1086"><a href="#cb17-1086" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_boot):</span>
<span id="cb17-1087"><a href="#cb17-1087" aria-hidden="true" tabindex="-1"></a>        sample <span class="op">=</span> rng.choice(data, size<span class="op">=</span><span class="bu">len</span>(data), replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-1088"><a href="#cb17-1088" aria-hidden="true" tabindex="-1"></a>        boot_means[i] <span class="op">=</span> sample.mean()</span>
<span id="cb17-1089"><a href="#cb17-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1090"><a href="#cb17-1090" aria-hidden="true" tabindex="-1"></a>    alpha <span class="op">=</span> (<span class="dv">100</span> <span class="op">-</span> ci) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb17-1091"><a href="#cb17-1091" aria-hidden="true" tabindex="-1"></a>    lower <span class="op">=</span> np.percentile(boot_means, alpha)</span>
<span id="cb17-1092"><a href="#cb17-1092" aria-hidden="true" tabindex="-1"></a>    upper <span class="op">=</span> np.percentile(boot_means, <span class="dv">100</span> <span class="op">-</span> alpha)</span>
<span id="cb17-1093"><a href="#cb17-1093" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data.mean(), lower, upper</span>
<span id="cb17-1094"><a href="#cb17-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1095"><a href="#cb17-1095" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb17-1096"><a href="#cb17-1096" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Compare C vs others</span></span>
<span id="cb17-1097"><a href="#cb17-1097" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb17-1098"><a href="#cb17-1098" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="st">"C"</span></span>
<span id="cb17-1099"><a href="#cb17-1099" aria-hidden="true" tabindex="-1"></a>comparators <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"D"</span>]</span>
<span id="cb17-1100"><a href="#cb17-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1101"><a href="#cb17-1101" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> []</span>
<span id="cb17-1102"><a href="#cb17-1102" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> comp <span class="kw">in</span> comparators:</span>
<span id="cb17-1103"><a href="#cb17-1103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep only QIDs where both systems exist</span></span>
<span id="cb17-1104"><a href="#cb17-1104" aria-hidden="true" tabindex="-1"></a>    pair <span class="op">=</span> wide[[target, comp]].dropna()</span>
<span id="cb17-1105"><a href="#cb17-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1106"><a href="#cb17-1106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Per-question paired delta</span></span>
<span id="cb17-1107"><a href="#cb17-1107" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> pair[target] <span class="op">-</span> pair[comp]</span>
<span id="cb17-1108"><a href="#cb17-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1109"><a href="#cb17-1109" aria-hidden="true" tabindex="-1"></a>    mean_delta, ci_low, ci_high <span class="op">=</span> bootstrap_ci(delta.values)</span>
<span id="cb17-1110"><a href="#cb17-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1111"><a href="#cb17-1111" aria-hidden="true" tabindex="-1"></a>    rows.append({</span>
<span id="cb17-1112"><a href="#cb17-1112" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Comparison"</span>: <span class="ss">f"</span><span class="sc">{</span>target<span class="sc">}</span><span class="ss"> − </span><span class="sc">{</span>comp<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb17-1113"><a href="#cb17-1113" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Paired_Qs"</span>: <span class="bu">len</span>(delta),</span>
<span id="cb17-1114"><a href="#cb17-1114" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mean_Delta"</span>: mean_delta,</span>
<span id="cb17-1115"><a href="#cb17-1115" aria-hidden="true" tabindex="-1"></a>        <span class="st">"CI_Low"</span>: ci_low,</span>
<span id="cb17-1116"><a href="#cb17-1116" aria-hidden="true" tabindex="-1"></a>        <span class="st">"CI_High"</span>: ci_high,</span>
<span id="cb17-1117"><a href="#cb17-1117" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb17-1118"><a href="#cb17-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1119"><a href="#cb17-1119" aria-hidden="true" tabindex="-1"></a>summary <span class="op">=</span> pd.DataFrame(rows)</span>
<span id="cb17-1120"><a href="#cb17-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1121"><a href="#cb17-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1122"><a href="#cb17-1122" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb17-1123"><a href="#cb17-1123" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Plot all comparisons in one figure</span></span>
<span id="cb17-1124"><a href="#cb17-1124" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb17-1125"><a href="#cb17-1125" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb17-1126"><a href="#cb17-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1127"><a href="#cb17-1127" aria-hidden="true" tabindex="-1"></a>y_labels <span class="op">=</span> [<span class="ss">f"System </span><span class="sc">{</span>r[<span class="st">'Comparison'</span>]<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> _, r <span class="kw">in</span> summary.iterrows()]</span>
<span id="cb17-1128"><a href="#cb17-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1129"><a href="#cb17-1129" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb17-1130"><a href="#cb17-1130" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>summary[<span class="st">"Mean_Delta"</span>],</span>
<span id="cb17-1131"><a href="#cb17-1131" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>y_labels,</span>
<span id="cb17-1132"><a href="#cb17-1132" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">"markers"</span>,</span>
<span id="cb17-1133"><a href="#cb17-1133" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">"black"</span>),</span>
<span id="cb17-1134"><a href="#cb17-1134" aria-hidden="true" tabindex="-1"></a>    error_x<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-1135"><a href="#cb17-1135" aria-hidden="true" tabindex="-1"></a>        <span class="bu">type</span><span class="op">=</span><span class="st">"data"</span>,</span>
<span id="cb17-1136"><a href="#cb17-1136" aria-hidden="true" tabindex="-1"></a>        symmetric<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb17-1137"><a href="#cb17-1137" aria-hidden="true" tabindex="-1"></a>        array<span class="op">=</span>(summary[<span class="st">"CI_High"</span>] <span class="op">-</span> summary[<span class="st">"Mean_Delta"</span>]).to_list(),</span>
<span id="cb17-1138"><a href="#cb17-1138" aria-hidden="true" tabindex="-1"></a>        arrayminus<span class="op">=</span>(summary[<span class="st">"Mean_Delta"</span>] <span class="op">-</span> summary[<span class="st">"CI_Low"</span>]).to_list(),</span>
<span id="cb17-1139"><a href="#cb17-1139" aria-hidden="true" tabindex="-1"></a>        thickness<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb17-1140"><a href="#cb17-1140" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="dv">8</span></span>
<span id="cb17-1141"><a href="#cb17-1141" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb17-1142"><a href="#cb17-1142" aria-hidden="true" tabindex="-1"></a>    hovertemplate<span class="op">=</span>(</span>
<span id="cb17-1143"><a href="#cb17-1143" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;b&gt;%</span><span class="sc">{y}</span><span class="st">&lt;/b&gt;&lt;br&gt;"</span> <span class="op">+</span></span>
<span id="cb17-1144"><a href="#cb17-1144" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Mean Δ: %</span><span class="sc">{x:.4f}</span><span class="st">&lt;br&gt;"</span> <span class="op">+</span></span>
<span id="cb17-1145"><a href="#cb17-1145" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;extra&gt;&lt;/extra&gt;"</span></span>
<span id="cb17-1146"><a href="#cb17-1146" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb17-1147"><a href="#cb17-1147" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"Mean Δ correctness"</span></span>
<span id="cb17-1148"><a href="#cb17-1148" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-1149"><a href="#cb17-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1150"><a href="#cb17-1150" aria-hidden="true" tabindex="-1"></a>fig.add_vline(</span>
<span id="cb17-1151"><a href="#cb17-1151" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb17-1152"><a href="#cb17-1152" aria-hidden="true" tabindex="-1"></a>    line_dash<span class="op">=</span><span class="st">"dash"</span>,</span>
<span id="cb17-1153"><a href="#cb17-1153" aria-hidden="true" tabindex="-1"></a>    line_color<span class="op">=</span><span class="st">"gray"</span>,</span>
<span id="cb17-1154"><a href="#cb17-1154" aria-hidden="true" tabindex="-1"></a>    annotation_text<span class="op">=</span><span class="st">"No difference"</span>,</span>
<span id="cb17-1155"><a href="#cb17-1155" aria-hidden="true" tabindex="-1"></a>    annotation_position<span class="op">=</span><span class="st">"top"</span></span>
<span id="cb17-1156"><a href="#cb17-1156" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1157"><a href="#cb17-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1158"><a href="#cb17-1158" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb17-1159"><a href="#cb17-1159" aria-hidden="true" tabindex="-1"></a>    <span class="co"># title="Per-question correctness difference vs System C&lt;br&gt;&lt;sup&gt;95% bootstrap confidence intervals (paired by QID)&lt;/sup&gt;",</span></span>
<span id="cb17-1160"><a href="#cb17-1160" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"Δ Correctness (C − comparator)"</span>,</span>
<span id="cb17-1161"><a href="#cb17-1161" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb17-1162"><a href="#cb17-1162" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb17-1163"><a href="#cb17-1163" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">320</span> <span class="op">+</span> <span class="dv">40</span> <span class="op">*</span> <span class="bu">len</span>(comparators),</span>
<span id="cb17-1164"><a href="#cb17-1164" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">60</span>, r<span class="op">=</span><span class="dv">40</span>, t<span class="op">=</span><span class="dv">70</span>, b<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb17-1165"><a href="#cb17-1165" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1166"><a href="#cb17-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1167"><a href="#cb17-1167" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb17-1168"><a href="#cb17-1168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-1169"><a href="#cb17-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1170"><a href="#cb17-1170" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-1171"><a href="#cb17-1171" aria-hidden="true" tabindex="-1"></a>**Figure 9**. 95% bootstrap confidence intervals for mean correctness differences between pairs of RAG architectures. The difference in correctness is statistically insignficant between System C and Systems A and B, but statistically significant between Systems C and D.  </span>
<span id="cb17-1172"><a href="#cb17-1172" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-1173"><a href="#cb17-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1174"><a href="#cb17-1174" aria-hidden="true" tabindex="-1"></a>Is System C the best in terms of correctness? With only 100 questions, there's not enough power at present to distinguish small differences among the top systems. To assess uncertainty, paired, per-question 95% bootstrap confidence intervals were calculated for the mean correctness difference between System C and the rest.</span>
<span id="cb17-1175"><a href="#cb17-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1176"><a href="#cb17-1176" aria-hidden="true" tabindex="-1"></a>Figure 9 shows that System C is not clearly superior to Systems A or B because their confidence intervals overlap zero. This raises the question: do moderately agentic routines really improve correctness over strong naive or hybrid baselines, or do they mostly impact cost, latency, and robustness? A larger, more thorough, more expensive benchmark is necessary to answer that question definitively.</span>
<span id="cb17-1177"><a href="#cb17-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1178"><a href="#cb17-1178" aria-hidden="true" tabindex="-1"></a>However, Figure 9 <span class="dt">&lt;</span><span class="kw">i</span><span class="dt">&gt;</span>does<span class="dt">&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span> show System C confidently outperforming System D, because the interval doesn't reach zero. However, this is mainly driven by brittle System D configurations -- the “high token, low accuracy” outliers in Figure 8. Added complexity can unintentionally introduce unexpected and spectacular points of failure. In practice, that means any new "agentic" functionality should be introduced to RAG pipelines cautiously and with rigorous testing.</span>
<span id="cb17-1179"><a href="#cb17-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1182"><a href="#cb17-1182" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-1183"><a href="#cb17-1183" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb17-1184"><a href="#cb17-1184" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-1185"><a href="#cb17-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1186"><a href="#cb17-1186" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">'results_table.csv'</span>)</span>
<span id="cb17-1187"><a href="#cb17-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1188"><a href="#cb17-1188" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_and_rename_sys(name):</span>
<span id="cb17-1189"><a href="#cb17-1189" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(name, <span class="bu">str</span>): <span class="cf">return</span> <span class="bu">str</span>(name)</span>
<span id="cb17-1190"><a href="#cb17-1190" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysA"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System A (Naive)"</span></span>
<span id="cb17-1191"><a href="#cb17-1191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysC"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System B (Hybrid)"</span></span>
<span id="cb17-1192"><a href="#cb17-1192" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysD"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System C (Agentic)"</span></span>
<span id="cb17-1193"><a href="#cb17-1193" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysG"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System D (God Mode)"</span></span>
<span id="cb17-1194"><a href="#cb17-1194" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name</span>
<span id="cb17-1195"><a href="#cb17-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1196"><a href="#cb17-1196" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'experiment_name'</span> <span class="kw">in</span> df.columns:</span>
<span id="cb17-1197"><a href="#cb17-1197" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Article_System'</span>] <span class="op">=</span> df[<span class="st">'experiment_name'</span>].<span class="bu">apply</span>(clean_and_rename_sys)</span>
<span id="cb17-1198"><a href="#cb17-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1199"><a href="#cb17-1199" aria-hidden="true" tabindex="-1"></a>gap_df <span class="op">=</span> df.groupby(<span class="st">'Article_System'</span>)[[<span class="st">'correctness_score'</span>, <span class="st">'faithfulness_score'</span>]].mean().reset_index()</span>
<span id="cb17-1200"><a href="#cb17-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1201"><a href="#cb17-1201" aria-hidden="true" tabindex="-1"></a>gap_melted <span class="op">=</span> gap_df.melt(id_vars<span class="op">=</span><span class="st">'Article_System'</span>, </span>
<span id="cb17-1202"><a href="#cb17-1202" aria-hidden="true" tabindex="-1"></a>                         value_vars<span class="op">=</span>[<span class="st">'correctness_score'</span>, <span class="st">'faithfulness_score'</span>],</span>
<span id="cb17-1203"><a href="#cb17-1203" aria-hidden="true" tabindex="-1"></a>                         var_name<span class="op">=</span><span class="st">'Metric'</span>, value_name<span class="op">=</span><span class="st">'Score'</span>)</span>
<span id="cb17-1204"><a href="#cb17-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1205"><a href="#cb17-1205" aria-hidden="true" tabindex="-1"></a>gap_melted[<span class="st">'Metric'</span>] <span class="op">=</span> gap_melted[<span class="st">'Metric'</span>].replace({</span>
<span id="cb17-1206"><a href="#cb17-1206" aria-hidden="true" tabindex="-1"></a>    <span class="st">'correctness_score'</span>: <span class="st">'Correctness (Factuality)'</span>,</span>
<span id="cb17-1207"><a href="#cb17-1207" aria-hidden="true" tabindex="-1"></a>    <span class="st">'faithfulness_score'</span>: <span class="st">'Faithfulness (Instruction Following)'</span></span>
<span id="cb17-1208"><a href="#cb17-1208" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb17-1209"><a href="#cb17-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1210"><a href="#cb17-1210" aria-hidden="true" tabindex="-1"></a>fig_gap <span class="op">=</span> px.bar(</span>
<span id="cb17-1211"><a href="#cb17-1211" aria-hidden="true" tabindex="-1"></a>    gap_melted,</span>
<span id="cb17-1212"><a href="#cb17-1212" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"Article_System"</span>,</span>
<span id="cb17-1213"><a href="#cb17-1213" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"Score"</span>,</span>
<span id="cb17-1214"><a href="#cb17-1214" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"Metric"</span>,</span>
<span id="cb17-1215"><a href="#cb17-1215" aria-hidden="true" tabindex="-1"></a>    barmode<span class="op">=</span><span class="st">"group"</span>,</span>
<span id="cb17-1216"><a href="#cb17-1216" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb17-1217"><a href="#cb17-1217" aria-hidden="true" tabindex="-1"></a>    color_discrete_map<span class="op">=</span>{</span>
<span id="cb17-1218"><a href="#cb17-1218" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Correctness (Factuality)"</span>: <span class="st">"#2c3e50"</span>,</span>
<span id="cb17-1219"><a href="#cb17-1219" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Faithfulness (Instruction Following)"</span>: <span class="st">"#18bc9c"</span></span>
<span id="cb17-1220"><a href="#cb17-1220" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb17-1221"><a href="#cb17-1221" aria-hidden="true" tabindex="-1"></a>    text_auto<span class="op">=</span><span class="st">'.2f'</span></span>
<span id="cb17-1222"><a href="#cb17-1222" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1223"><a href="#cb17-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1224"><a href="#cb17-1224" aria-hidden="true" tabindex="-1"></a>fig_gap.update_layout(</span>
<span id="cb17-1225"><a href="#cb17-1225" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="fl">1.05</span>], title<span class="op">=</span><span class="st">"Score (0-1)"</span>),</span>
<span id="cb17-1226"><a href="#cb17-1226" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb17-1227"><a href="#cb17-1227" aria-hidden="true" tabindex="-1"></a>    width<span class="op">=</span><span class="va">None</span>, <span class="co"># Remove fixed width=800 so it fills screen</span></span>
<span id="cb17-1228"><a href="#cb17-1228" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb17-1229"><a href="#cb17-1229" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb17-1230"><a href="#cb17-1230" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb17-1231"><a href="#cb17-1231" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-1232"><a href="#cb17-1232" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>, </span>
<span id="cb17-1233"><a href="#cb17-1233" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>, </span>
<span id="cb17-1234"><a href="#cb17-1234" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.2</span>, </span>
<span id="cb17-1235"><a href="#cb17-1235" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>, </span>
<span id="cb17-1236"><a href="#cb17-1236" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb17-1237"><a href="#cb17-1237" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-1238"><a href="#cb17-1238" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1239"><a href="#cb17-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1240"><a href="#cb17-1240" aria-hidden="true" tabindex="-1"></a>fig_gap.show()</span>
<span id="cb17-1241"><a href="#cb17-1241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-1242"><a href="#cb17-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1243"><a href="#cb17-1243" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-1244"><a href="#cb17-1244" aria-hidden="true" tabindex="-1"></a>**Figure 10**. The hallucination gap comparing correctness (factuality) versus faithfulness (instruction following) by system.</span>
<span id="cb17-1245"><a href="#cb17-1245" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-1246"><a href="#cb17-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1247"><a href="#cb17-1247" aria-hidden="true" tabindex="-1"></a>Figure 10 compares the average correctness (factual accuracy) and faithfulness (instruction following) in each RAG architecture. The stark variation in correctness has already been discussed, but it contrasts with faithfulness, which is relatively high and constant throughout each of the architectures. </span>
<span id="cb17-1248"><a href="#cb17-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1249"><a href="#cb17-1249" aria-hidden="true" tabindex="-1"></a>Because correctness and faithfulness don't appear to <span class="dt">&lt;</span><span class="kw">i</span><span class="dt">&gt;</span>strongly<span class="dt">&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span> correlate, any failures in the RAG systems studied here are not due to classical "hallucinations". Even in configurations where accuracy degrades, particularly in System D, instructions are still followed faithfully. In practice, this means that the spectacular failures of System D in some configurations are not due to a lack of faithfulness. Any errors in accuracy likely arise early in the RAG chain and then are carried along in the pipeline. This observation reinforces a central theme of the study: improving RAG performance requires not only better language models, but also careful attention to the reliability of the control logic in the pipeline.</span>
<span id="cb17-1250"><a href="#cb17-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1253"><a href="#cb17-1253" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-1254"><a href="#cb17-1254" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb17-1255"><a href="#cb17-1255" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-1256"><a href="#cb17-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1257"><a href="#cb17-1257" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'results_table.csv'</span>)</span>
<span id="cb17-1258"><a href="#cb17-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1259"><a href="#cb17-1259" aria-hidden="true" tabindex="-1"></a>naive_df <span class="op">=</span> df[df[<span class="st">'sys'</span>] <span class="op">==</span> <span class="st">'SysA'</span>]</span>
<span id="cb17-1260"><a href="#cb17-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1261"><a href="#cb17-1261" aria-hidden="true" tabindex="-1"></a>recall_5 <span class="op">=</span> naive_df[<span class="st">'recall_at_5'</span>].mean()</span>
<span id="cb17-1262"><a href="#cb17-1262" aria-hidden="true" tabindex="-1"></a>recall_10 <span class="op">=</span> naive_df[<span class="st">'recall_at_10'</span>].mean()</span>
<span id="cb17-1263"><a href="#cb17-1263" aria-hidden="true" tabindex="-1"></a>recall_20 <span class="op">=</span> naive_df[<span class="st">'retrieval_recall'</span>].mean()</span>
<span id="cb17-1264"><a href="#cb17-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1265"><a href="#cb17-1265" aria-hidden="true" tabindex="-1"></a>k_values <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>]</span>
<span id="cb17-1266"><a href="#cb17-1266" aria-hidden="true" tabindex="-1"></a>recall_scores <span class="op">=</span> [recall_5, recall_10, recall_20]</span>
<span id="cb17-1267"><a href="#cb17-1267" aria-hidden="true" tabindex="-1"></a>token_costs <span class="op">=</span> [<span class="dv">5</span> <span class="op">*</span> <span class="dv">250</span>, <span class="dv">10</span> <span class="op">*</span> <span class="dv">250</span>, <span class="dv">20</span> <span class="op">*</span> <span class="dv">250</span>] </span>
<span id="cb17-1268"><a href="#cb17-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1269"><a href="#cb17-1269" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb17-1270"><a href="#cb17-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1271"><a href="#cb17-1271" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb17-1272"><a href="#cb17-1272" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>k_values, y<span class="op">=</span>recall_scores,</span>
<span id="cb17-1273"><a href="#cb17-1273" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"Recall (Accuracy Ceiling)"</span>,</span>
<span id="cb17-1274"><a href="#cb17-1274" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'lines+markers'</span>,</span>
<span id="cb17-1275"><a href="#cb17-1275" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#2ecc71'</span>, width<span class="op">=</span><span class="dv">4</span>),</span>
<span id="cb17-1276"><a href="#cb17-1276" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>),</span>
<span id="cb17-1277"><a href="#cb17-1277" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="st">'y1'</span></span>
<span id="cb17-1278"><a href="#cb17-1278" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-1279"><a href="#cb17-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1280"><a href="#cb17-1280" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb17-1281"><a href="#cb17-1281" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>k_values, y<span class="op">=</span>token_costs,</span>
<span id="cb17-1282"><a href="#cb17-1282" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"Token Cost (Linear Growth)"</span>,</span>
<span id="cb17-1283"><a href="#cb17-1283" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'lines+markers'</span>,</span>
<span id="cb17-1284"><a href="#cb17-1284" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#e74c3c'</span>, width<span class="op">=</span><span class="dv">3</span>, dash<span class="op">=</span><span class="st">'dot'</span>),</span>
<span id="cb17-1285"><a href="#cb17-1285" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>, symbol<span class="op">=</span><span class="st">'square'</span>),</span>
<span id="cb17-1286"><a href="#cb17-1286" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="st">'y2'</span></span>
<span id="cb17-1287"><a href="#cb17-1287" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-1288"><a href="#cb17-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1289"><a href="#cb17-1289" aria-hidden="true" tabindex="-1"></a>fig.add_annotation(</span>
<span id="cb17-1290"><a href="#cb17-1290" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="dv">20</span>, y<span class="op">=</span>recall_20,</span>
<span id="cb17-1291"><a href="#cb17-1291" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span><span class="st">"&lt;b&gt;Diminishing Returns&lt;/b&gt;&lt;br&gt;4x Cost for &lt;1</span><span class="sc">% G</span><span class="st">ain"</span>,</span>
<span id="cb17-1292"><a href="#cb17-1292" aria-hidden="true" tabindex="-1"></a>    showarrow<span class="op">=</span><span class="va">True</span>, arrowhead<span class="op">=</span><span class="dv">2</span>, ax<span class="op">=</span><span class="dv">0</span>, ay<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb17-1293"><a href="#cb17-1293" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"rgba(255, 255, 255, 0.8)"</span>, bordercolor<span class="op">=</span><span class="st">"orange"</span></span>
<span id="cb17-1294"><a href="#cb17-1294" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1295"><a href="#cb17-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1296"><a href="#cb17-1296" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb17-1297"><a href="#cb17-1297" aria-hidden="true" tabindex="-1"></a>    xaxis<span class="op">=</span><span class="bu">dict</span>(title<span class="op">=</span><span class="st">"Chunks Retrieved (k)"</span>, tickvals<span class="op">=</span>[<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>]),</span>
<span id="cb17-1298"><a href="#cb17-1298" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-1299"><a href="#cb17-1299" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Recall Score"</span>, </span>
<span id="cb17-1300"><a href="#cb17-1300" aria-hidden="true" tabindex="-1"></a>        title_font<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"#2ecc71"</span>),</span>
<span id="cb17-1301"><a href="#cb17-1301" aria-hidden="true" tabindex="-1"></a>        tickfont<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"#2ecc71"</span>),</span>
<span id="cb17-1302"><a href="#cb17-1302" aria-hidden="true" tabindex="-1"></a>        <span class="bu">range</span><span class="op">=</span>[<span class="fl">0.6</span>, <span class="fl">0.75</span>]</span>
<span id="cb17-1303"><a href="#cb17-1303" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb17-1304"><a href="#cb17-1304" aria-hidden="true" tabindex="-1"></a>    yaxis2<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-1305"><a href="#cb17-1305" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Est. Tokens"</span>,</span>
<span id="cb17-1306"><a href="#cb17-1306" aria-hidden="true" tabindex="-1"></a>        title_font<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"#e74c3c"</span>),</span>
<span id="cb17-1307"><a href="#cb17-1307" aria-hidden="true" tabindex="-1"></a>        tickfont<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"#e74c3c"</span>),</span>
<span id="cb17-1308"><a href="#cb17-1308" aria-hidden="true" tabindex="-1"></a>        overlaying<span class="op">=</span><span class="st">'y'</span>,</span>
<span id="cb17-1309"><a href="#cb17-1309" aria-hidden="true" tabindex="-1"></a>        side<span class="op">=</span><span class="st">'right'</span>,</span>
<span id="cb17-1310"><a href="#cb17-1310" aria-hidden="true" tabindex="-1"></a>        <span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="dv">6000</span>]</span>
<span id="cb17-1311"><a href="#cb17-1311" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb17-1312"><a href="#cb17-1312" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb17-1313"><a href="#cb17-1313" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">550</span>,</span>
<span id="cb17-1314"><a href="#cb17-1314" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb17-1315"><a href="#cb17-1315" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb17-1316"><a href="#cb17-1316" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-1317"><a href="#cb17-1317" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb17-1318"><a href="#cb17-1318" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb17-1319"><a href="#cb17-1319" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.2</span>,</span>
<span id="cb17-1320"><a href="#cb17-1320" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-1321"><a href="#cb17-1321" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb17-1322"><a href="#cb17-1322" aria-hidden="true" tabindex="-1"></a>        bgcolor<span class="op">=</span><span class="st">"rgba(0,0,0,0)"</span></span>
<span id="cb17-1323"><a href="#cb17-1323" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-1324"><a href="#cb17-1324" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1325"><a href="#cb17-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1326"><a href="#cb17-1326" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb17-1327"><a href="#cb17-1327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-1328"><a href="#cb17-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1329"><a href="#cb17-1329" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-1330"><a href="#cb17-1330" aria-hidden="true" tabindex="-1"></a>**Figure 11**. The diminishing returns of increasing context size (k) in naive RAG—costs grow linearly while recall saturates.</span>
<span id="cb17-1331"><a href="#cb17-1331" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-1332"><a href="#cb17-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1333"><a href="#cb17-1333" aria-hidden="true" tabindex="-1"></a>Figure 11 examines the effect of k -- the number of documents retrieved -- on recall and token usage in the naive RAG baseline (System A). This analysis was motivated by an observation, after completing all experiments, that token use by System A was relatively high among the different RAG systems in this study (see Figure 8). This raised the possibility that the value chosen for k (20) was a little too high. Figure 11 shows that recall rapidly improves up to about k=5 to 10, but only modestly improves beyond that, while token use continues to grow linearly. While similar performance in System A in the experiments of this study would have probably been observed with a lower k and incurred smaller token costs, this highlight a general pattern that recurs through this study: retrieval recall often saturates well before system costs do. </span>
<span id="cb17-1334"><a href="#cb17-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1335"><a href="#cb17-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1338"><a href="#cb17-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-1339"><a href="#cb17-1339" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb17-1340"><a href="#cb17-1340" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb17-1341"><a href="#cb17-1341" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-1342"><a href="#cb17-1342" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb17-1343"><a href="#cb17-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1344"><a href="#cb17-1344" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw -&gt; paper naming</span></span>
<span id="cb17-1345"><a href="#cb17-1345" aria-hidden="true" tabindex="-1"></a>SYSTEM_MAP <span class="op">=</span> {</span>
<span id="cb17-1346"><a href="#cb17-1346" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysA"</span>: <span class="st">"A"</span>,</span>
<span id="cb17-1347"><a href="#cb17-1347" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysC"</span>: <span class="st">"B"</span>,</span>
<span id="cb17-1348"><a href="#cb17-1348" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysD"</span>: <span class="st">"C"</span>,</span>
<span id="cb17-1349"><a href="#cb17-1349" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SysG"</span>: <span class="st">"D"</span>,  <span class="co"># God Mode</span></span>
<span id="cb17-1350"><a href="#cb17-1350" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-1351"><a href="#cb17-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1352"><a href="#cb17-1352" aria-hidden="true" tabindex="-1"></a><span class="co"># --- UPDATE: Point to evals subdirectory ---</span></span>
<span id="cb17-1353"><a href="#cb17-1353" aria-hidden="true" tabindex="-1"></a>EVALS_DIR <span class="op">=</span> <span class="st">"evals"</span></span>
<span id="cb17-1354"><a href="#cb17-1354" aria-hidden="true" tabindex="-1"></a>results_files <span class="op">=</span> [</span>
<span id="cb17-1355"><a href="#cb17-1355" aria-hidden="true" tabindex="-1"></a>    f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(EVALS_DIR)</span>
<span id="cb17-1356"><a href="#cb17-1356" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> f.startswith(<span class="st">"evaluation_results"</span>) <span class="kw">and</span> f.endswith(<span class="st">".jsonl"</span>) <span class="kw">and</span> <span class="kw">not</span> f.startswith(<span class="st">"gold"</span>) <span class="kw">and</span> <span class="kw">not</span> <span class="st">'llama3.1_70b_SysG'</span> <span class="kw">in</span> f</span>
<span id="cb17-1357"><a href="#cb17-1357" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-1358"><a href="#cb17-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1359"><a href="#cb17-1359" aria-hidden="true" tabindex="-1"></a>all_records <span class="op">=</span> []</span>
<span id="cb17-1360"><a href="#cb17-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1361"><a href="#cb17-1361" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> infer_raw_system(exp_name: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb17-1362"><a href="#cb17-1362" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check longer/more specific tokens first</span></span>
<span id="cb17-1363"><a href="#cb17-1363" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> raw <span class="kw">in</span> [<span class="st">"SysG"</span>, <span class="st">"SysD"</span>, <span class="st">"SysC"</span>, <span class="st">"SysA"</span>]:</span>
<span id="cb17-1364"><a href="#cb17-1364" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> raw <span class="kw">in</span> exp_name:</span>
<span id="cb17-1365"><a href="#cb17-1365" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> raw</span>
<span id="cb17-1366"><a href="#cb17-1366" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"Other"</span></span>
<span id="cb17-1367"><a href="#cb17-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1368"><a href="#cb17-1368" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> results_files:</span>
<span id="cb17-1369"><a href="#cb17-1369" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- UPDATE: Join path with directory ---</span></span>
<span id="cb17-1370"><a href="#cb17-1370" aria-hidden="true" tabindex="-1"></a>    full_path <span class="op">=</span> os.path.join(EVALS_DIR, f)</span>
<span id="cb17-1371"><a href="#cb17-1371" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(full_path, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>,errors<span class="op">=</span><span class="st">"replace"</span>) <span class="im">as</span> infile:</span>
<span id="cb17-1372"><a href="#cb17-1372" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> infile:</span>
<span id="cb17-1373"><a href="#cb17-1373" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb17-1374"><a href="#cb17-1374" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.loads(line)</span>
<span id="cb17-1375"><a href="#cb17-1375" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb17-1376"><a href="#cb17-1376" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb17-1377"><a href="#cb17-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1378"><a href="#cb17-1378" aria-hidden="true" tabindex="-1"></a>            exp_name <span class="op">=</span> data.get(<span class="st">"experiment_name"</span>, <span class="st">""</span>)</span>
<span id="cb17-1379"><a href="#cb17-1379" aria-hidden="true" tabindex="-1"></a>            raw_sys <span class="op">=</span> infer_raw_system(exp_name)</span>
<span id="cb17-1380"><a href="#cb17-1380" aria-hidden="true" tabindex="-1"></a>            paper_sys <span class="op">=</span> SYSTEM_MAP.get(raw_sys, raw_sys)</span>
<span id="cb17-1381"><a href="#cb17-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1382"><a href="#cb17-1382" aria-hidden="true" tabindex="-1"></a>            all_records.append({</span>
<span id="cb17-1383"><a href="#cb17-1383" aria-hidden="true" tabindex="-1"></a>                <span class="st">"System"</span>: paper_sys,</span>
<span id="cb17-1384"><a href="#cb17-1384" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Question Type"</span>: data.get(<span class="st">"question_type"</span>, <span class="st">"unknown"</span>),</span>
<span id="cb17-1385"><a href="#cb17-1385" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Correctness"</span>: data.get(<span class="st">"correctness_score"</span>, <span class="dv">0</span>),</span>
<span id="cb17-1386"><a href="#cb17-1386" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Latency"</span>: data.get(<span class="st">"latency_ms"</span>, <span class="dv">0</span>),</span>
<span id="cb17-1387"><a href="#cb17-1387" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb17-1388"><a href="#cb17-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1389"><a href="#cb17-1389" aria-hidden="true" tabindex="-1"></a>df_qtype <span class="op">=</span> pd.DataFrame(all_records)</span>
<span id="cb17-1390"><a href="#cb17-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1391"><a href="#cb17-1391" aria-hidden="true" tabindex="-1"></a>summary_df <span class="op">=</span> (</span>
<span id="cb17-1392"><a href="#cb17-1392" aria-hidden="true" tabindex="-1"></a>    df_qtype</span>
<span id="cb17-1393"><a href="#cb17-1393" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"System"</span>, <span class="st">"Question Type"</span>], as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">"Correctness"</span>]</span>
<span id="cb17-1394"><a href="#cb17-1394" aria-hidden="true" tabindex="-1"></a>    .mean()</span>
<span id="cb17-1395"><a href="#cb17-1395" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1396"><a href="#cb17-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1397"><a href="#cb17-1397" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.bar(</span>
<span id="cb17-1398"><a href="#cb17-1398" aria-hidden="true" tabindex="-1"></a>    summary_df,</span>
<span id="cb17-1399"><a href="#cb17-1399" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"Question Type"</span>,</span>
<span id="cb17-1400"><a href="#cb17-1400" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"Correctness"</span>,</span>
<span id="cb17-1401"><a href="#cb17-1401" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"System"</span>,</span>
<span id="cb17-1402"><a href="#cb17-1402" aria-hidden="true" tabindex="-1"></a>    barmode<span class="op">=</span><span class="st">"group"</span>,</span>
<span id="cb17-1403"><a href="#cb17-1403" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb17-1404"><a href="#cb17-1404" aria-hidden="true" tabindex="-1"></a>    color_discrete_map<span class="op">=</span>{</span>
<span id="cb17-1405"><a href="#cb17-1405" aria-hidden="true" tabindex="-1"></a>        <span class="st">"A"</span>: <span class="st">"#4C72B0"</span>,</span>
<span id="cb17-1406"><a href="#cb17-1406" aria-hidden="true" tabindex="-1"></a>        <span class="st">"B"</span>: <span class="st">"#DD8452"</span>,</span>
<span id="cb17-1407"><a href="#cb17-1407" aria-hidden="true" tabindex="-1"></a>        <span class="st">"C"</span>: <span class="st">"#55A868"</span>,</span>
<span id="cb17-1408"><a href="#cb17-1408" aria-hidden="true" tabindex="-1"></a>        <span class="st">"D"</span>: <span class="st">"#C44E52"</span>,</span>
<span id="cb17-1409"><a href="#cb17-1409" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1410"><a href="#cb17-1410" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1411"><a href="#cb17-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1412"><a href="#cb17-1412" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb17-1413"><a href="#cb17-1413" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="fl">1.05</span>], title<span class="op">=</span><span class="st">"Avg Correctness Score"</span>),</span>
<span id="cb17-1414"><a href="#cb17-1414" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"Question Category"</span>,</span>
<span id="cb17-1415"><a href="#cb17-1415" aria-hidden="true" tabindex="-1"></a>    legend_title<span class="op">=</span><span class="st">"Sys"</span>,</span>
<span id="cb17-1416"><a href="#cb17-1416" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">550</span>,</span>
<span id="cb17-1417"><a href="#cb17-1417" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb17-1418"><a href="#cb17-1418" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb17-1419"><a href="#cb17-1419" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-1420"><a href="#cb17-1420" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb17-1421"><a href="#cb17-1421" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb17-1422"><a href="#cb17-1422" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.25</span>, <span class="co"># Push further down because x-axis labels (categories) might wrap</span></span>
<span id="cb17-1423"><a href="#cb17-1423" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-1424"><a href="#cb17-1424" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb17-1425"><a href="#cb17-1425" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-1426"><a href="#cb17-1426" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1427"><a href="#cb17-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1428"><a href="#cb17-1428" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb17-1429"><a href="#cb17-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1430"><a href="#cb17-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1431"><a href="#cb17-1431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-1432"><a href="#cb17-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1433"><a href="#cb17-1433" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-1434"><a href="#cb17-1434" aria-hidden="true" tabindex="-1"></a>**Figure 12**. System competency profile showing correctness by question type. Complex systems excel at filter and multi-hop categories.</span>
<span id="cb17-1435"><a href="#cb17-1435" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-1436"><a href="#cb17-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1437"><a href="#cb17-1437" aria-hidden="true" tabindex="-1"></a>It can be quickly observed from Figure 12 that System C is the most robust performer across nearly all question types. Particularly, it clearly exceeds all other systems in descriptive, factual, contextual, and unanswerable categories. It's also significantly better than System D, despite System D's increased complexity. This suggests possible failure modes resulting from interaction between System D's architectural complexity and the robustness of other system components. </span>
<span id="cb17-1438"><a href="#cb17-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1439"><a href="#cb17-1439" aria-hidden="true" tabindex="-1"></a>Figure 12 also shows that only the agentic systems (Systems C and D) are capable of answering the "contextual" questions. This is because only these systems contain a rudimentary "agentic" function of rewriting follow-up user queries -- using the conversation history as the context -- to create queries that works better for the semantic retrieval step. E.g., a vague question of "what year was it released?" gets transformed to "what year was the second Star Wars movie released?", etc.</span>
<span id="cb17-1440"><a href="#cb17-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1441"><a href="#cb17-1441" aria-hidden="true" tabindex="-1"></a>Finally, Figure 12 shows that filter and multi-hop questions are only solved reliably by Systems A (Naive) and D (God Mode). In the naive system, these questions succeed mainly due to "context stuffing" -- the large k used for this system (20) increased the chance of finding the correct document. In contrast, System D attempts to solve these questions through explicit decomposition and reranking -- an approach that is theoretically more principled, but, as shown below, can be a liability in configurations with spotty model robustness.</span>
<span id="cb17-1442"><a href="#cb17-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1443"><a href="#cb17-1443" aria-hidden="true" tabindex="-1"></a>Altogether, these results motivate a closer examination of System D's failures in cases where the simpler System C succeeds. The following case studies analyze certain “God Mode” failures to illustrate how aspects of its complex architecture interact to undermine otherwise correct retrieval.</span>
<span id="cb17-1444"><a href="#cb17-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1445"><a href="#cb17-1445" aria-hidden="true" tabindex="-1"></a>::: {.callout-important icon=false}</span>
<span id="cb17-1446"><a href="#cb17-1446" aria-hidden="true" tabindex="-1"></a><span class="fu">## When and why did "God Mode" not work?</span></span>
<span id="cb17-1447"><a href="#cb17-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1448"><a href="#cb17-1448" aria-hidden="true" tabindex="-1"></a>Why did the complex System D fail where the simpler System C succeeded? Failure analysis showed that the semantic reranker often discarded "boring" but correct metadata in favor of "rich" but irrelevant plot summaries, or simply overwhelmed the model with noise.</span>
<span id="cb17-1449"><a href="#cb17-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1450"><a href="#cb17-1450" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Question <span class="pp">|</span> System C (Agentic) <span class="pp">|</span> System D (GodMode) <span class="pp">|</span> What happened? <span class="pp">|</span></span>
<span id="cb17-1451"><a href="#cb17-1451" aria-hidden="true" tabindex="-1"></a><span class="pp">|:---|:---|:---|:---|</span></span>
<span id="cb17-1452"><a href="#cb17-1452" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **"What is the popularity score of Armageddon (1998)?"** | **"7.838"** (Correct) | *"The popularity score of Armageddon (1998) is 6.4/10 [Doc 20603]."* (Incorrect) | **Metric confusion under noise:** God Mode returned a rating-style number for a popularity field. It grabbed a number from the metadata that looked plausible but wasn't the correct one. <span class="pp">|</span></span>
<span id="cb17-1453"><a href="#cb17-1453" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **"How much gold was Brink's-Mat holding?"** | **"£26 million"** (Correct) | *"The information is not found in the provided documents."* (Incorrect) | **Retrieval miss / over-filtering:** God Mode simply fails to surface the relevant evidence (its retrieval metrics for this item drop to zero). Generation failed because retrieval failed. <span class="pp">|</span></span>
<span id="cb17-1454"><a href="#cb17-1454" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **"Which movie is about two rival gangs in Munich?"** | **"Nacht der Wölfe"** (Correct) | *"I cannot find the answer..." (Incorrect) | **Wrong retrieval target:** This looks like a straight-up miss -- God Mode doesn’t retrieve the needed doc and instead finds unrelated ones. <span class="pp">|</span></span>
<span id="cb17-1455"><a href="#cb17-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1456"><a href="#cb17-1456" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-1457"><a href="#cb17-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1458"><a href="#cb17-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1461"><a href="#cb17-1461" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-1462"><a href="#cb17-1462" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb17-1463"><a href="#cb17-1463" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb17-1464"><a href="#cb17-1464" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-1465"><a href="#cb17-1465" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb17-1466"><a href="#cb17-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1467"><a href="#cb17-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1468"><a href="#cb17-1468" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mean_correctness(jsonl_path: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb17-1469"><a href="#cb17-1469" aria-hidden="true" tabindex="-1"></a>    vals <span class="op">=</span> []</span>
<span id="cb17-1470"><a href="#cb17-1470" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(jsonl_path, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>,errors<span class="op">=</span><span class="st">"replace"</span>) <span class="im">as</span> f:</span>
<span id="cb17-1471"><a href="#cb17-1471" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb17-1472"><a href="#cb17-1472" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> line.strip():</span>
<span id="cb17-1473"><a href="#cb17-1473" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb17-1474"><a href="#cb17-1474" aria-hidden="true" tabindex="-1"></a>            d <span class="op">=</span> json.loads(line)</span>
<span id="cb17-1475"><a href="#cb17-1475" aria-hidden="true" tabindex="-1"></a>            v <span class="op">=</span> d.get(<span class="st">"correctness_score"</span>)</span>
<span id="cb17-1476"><a href="#cb17-1476" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> v <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb17-1477"><a href="#cb17-1477" aria-hidden="true" tabindex="-1"></a>                vals.append(v)</span>
<span id="cb17-1478"><a href="#cb17-1478" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(np.mean(vals))</span>
<span id="cb17-1479"><a href="#cb17-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1480"><a href="#cb17-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1481"><a href="#cb17-1481" aria-hidden="true" tabindex="-1"></a><span class="co"># --- UPDATE: Added 'evals/' prefix to all paths ---</span></span>
<span id="cb17-1482"><a href="#cb17-1482" aria-hidden="true" tabindex="-1"></a>qwen_4bit <span class="op">=</span> <span class="st">"evals/evaluation_results_qwen2.5_32b_SysG_v4_Reranked_FIXED_1766524393.jsonl"</span></span>
<span id="cb17-1483"><a href="#cb17-1483" aria-hidden="true" tabindex="-1"></a>qwen_2bit <span class="op">=</span> <span class="st">"evals/evaluation_results_qwen2.5_32b-instruct-q2_K_SysG_v4_Reranked_FIXED_1766368890.jsonl"</span></span>
<span id="cb17-1484"><a href="#cb17-1484" aria-hidden="true" tabindex="-1"></a>llama_4bit <span class="op">=</span> <span class="st">"evals/evaluation_results_llama3.1_70b_SysG_v4_Reranked_FIXED_1766501850.jsonl"</span></span>
<span id="cb17-1485"><a href="#cb17-1485" aria-hidden="true" tabindex="-1"></a>llama_2bit <span class="op">=</span> <span class="st">"evals/evaluation_results_llama3.1-70b-iq2_xs_SysG_v4_Reranked_FIXED_1766415472.jsonl"</span></span>
<span id="cb17-1486"><a href="#cb17-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1487"><a href="#cb17-1487" aria-hidden="true" tabindex="-1"></a>qwen_y <span class="op">=</span> [mean_correctness(qwen_4bit), mean_correctness(qwen_2bit)]</span>
<span id="cb17-1488"><a href="#cb17-1488" aria-hidden="true" tabindex="-1"></a>llama_y <span class="op">=</span> [mean_correctness(llama_4bit), mean_correctness(llama_2bit)]</span>
<span id="cb17-1489"><a href="#cb17-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1490"><a href="#cb17-1490" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb17-1491"><a href="#cb17-1491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1492"><a href="#cb17-1492" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb17-1493"><a href="#cb17-1493" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>[<span class="st">'4-Bit'</span>, <span class="st">'2-Bit'</span>],</span>
<span id="cb17-1494"><a href="#cb17-1494" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>qwen_y,</span>
<span id="cb17-1495"><a href="#cb17-1495" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'lines+markers+text'</span>,</span>
<span id="cb17-1496"><a href="#cb17-1496" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'Qwen 2.5 32B'</span>,</span>
<span id="cb17-1497"><a href="#cb17-1497" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#00cc96'</span>, width<span class="op">=</span><span class="dv">4</span>),</span>
<span id="cb17-1498"><a href="#cb17-1498" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>),</span>
<span id="cb17-1499"><a href="#cb17-1499" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span>[<span class="ss">f"</span><span class="sc">{</span>v<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span> <span class="cf">for</span> v <span class="kw">in</span> qwen_y],</span>
<span id="cb17-1500"><a href="#cb17-1500" aria-hidden="true" tabindex="-1"></a>    textposition<span class="op">=</span><span class="st">"top right"</span></span>
<span id="cb17-1501"><a href="#cb17-1501" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-1502"><a href="#cb17-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1503"><a href="#cb17-1503" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb17-1504"><a href="#cb17-1504" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>[<span class="st">'4-Bit'</span>, <span class="st">'2-Bit'</span>],</span>
<span id="cb17-1505"><a href="#cb17-1505" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>llama_y,</span>
<span id="cb17-1506"><a href="#cb17-1506" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">'lines+markers+text'</span>,</span>
<span id="cb17-1507"><a href="#cb17-1507" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'Llama 3.1 70B'</span>,</span>
<span id="cb17-1508"><a href="#cb17-1508" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#ef553b'</span>, width<span class="op">=</span><span class="dv">4</span>, dash<span class="op">=</span><span class="st">'dash'</span>),</span>
<span id="cb17-1509"><a href="#cb17-1509" aria-hidden="true" tabindex="-1"></a>    marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>, symbol<span class="op">=</span><span class="st">'x'</span>),</span>
<span id="cb17-1510"><a href="#cb17-1510" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span>[<span class="ss">f"</span><span class="sc">{</span>v<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span> <span class="cf">for</span> v <span class="kw">in</span> llama_y],</span>
<span id="cb17-1511"><a href="#cb17-1511" aria-hidden="true" tabindex="-1"></a>    textposition<span class="op">=</span><span class="st">"bottom center"</span></span>
<span id="cb17-1512"><a href="#cb17-1512" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb17-1513"><a href="#cb17-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1514"><a href="#cb17-1514" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb17-1515"><a href="#cb17-1515" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"Correctness Score"</span>,</span>
<span id="cb17-1516"><a href="#cb17-1516" aria-hidden="true" tabindex="-1"></a>    yaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[<span class="fl">0.2</span>, <span class="fl">0.75</span>], tickformat<span class="op">=</span><span class="st">".0%"</span>),</span>
<span id="cb17-1517"><a href="#cb17-1517" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">'plotly_white'</span>,</span>
<span id="cb17-1518"><a href="#cb17-1518" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">550</span>,</span>
<span id="cb17-1519"><a href="#cb17-1519" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb17-1520"><a href="#cb17-1520" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb17-1521"><a href="#cb17-1521" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-1522"><a href="#cb17-1522" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb17-1523"><a href="#cb17-1523" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb17-1524"><a href="#cb17-1524" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.2</span>,</span>
<span id="cb17-1525"><a href="#cb17-1525" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-1526"><a href="#cb17-1526" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb17-1527"><a href="#cb17-1527" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-1528"><a href="#cb17-1528" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1529"><a href="#cb17-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1530"><a href="#cb17-1530" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb17-1531"><a href="#cb17-1531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-1532"><a href="#cb17-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1533"><a href="#cb17-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1534"><a href="#cb17-1534" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-1535"><a href="#cb17-1535" aria-hidden="true" tabindex="-1"></a>**Figure 13**. The fragility threshold showing impact of quantization on accuracy. Qwen 2.5 maintains performance while Llama 3.1 degrades rapidly.</span>
<span id="cb17-1536"><a href="#cb17-1536" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-1537"><a href="#cb17-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1540"><a href="#cb17-1540" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-1541"><a href="#cb17-1541" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb17-1542"><a href="#cb17-1542" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb17-1543"><a href="#cb17-1543" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-1544"><a href="#cb17-1544" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-1545"><a href="#cb17-1545" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb17-1546"><a href="#cb17-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1547"><a href="#cb17-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1548"><a href="#cb17-1548" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_jsonl(path: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb17-1549"><a href="#cb17-1549" aria-hidden="true" tabindex="-1"></a>    rows <span class="op">=</span> []</span>
<span id="cb17-1550"><a href="#cb17-1550" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>,errors<span class="op">=</span><span class="st">"replace"</span>) <span class="im">as</span> f:</span>
<span id="cb17-1551"><a href="#cb17-1551" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb17-1552"><a href="#cb17-1552" aria-hidden="true" tabindex="-1"></a>            line <span class="op">=</span> line.strip()</span>
<span id="cb17-1553"><a href="#cb17-1553" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> line:</span>
<span id="cb17-1554"><a href="#cb17-1554" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb17-1555"><a href="#cb17-1555" aria-hidden="true" tabindex="-1"></a>            rows.append(json.loads(line))</span>
<span id="cb17-1556"><a href="#cb17-1556" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(rows)</span>
<span id="cb17-1557"><a href="#cb17-1557" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Normalize types just in case</span></span>
<span id="cb17-1558"><a href="#cb17-1558" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"correctness_score"</span>] <span class="op">=</span> pd.to_numeric(df.get(<span class="st">"correctness_score"</span>), errors<span class="op">=</span><span class="st">"coerce"</span>)</span>
<span id="cb17-1559"><a href="#cb17-1559" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">"question_type"</span>] <span class="op">=</span> df.get(<span class="st">"question_type"</span>).astype(<span class="bu">str</span>)</span>
<span id="cb17-1560"><a href="#cb17-1560" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb17-1561"><a href="#cb17-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1562"><a href="#cb17-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1563"><a href="#cb17-1563" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mean_correctness_by_qtype(path: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.Series:</span>
<span id="cb17-1564"><a href="#cb17-1564" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> load_jsonl(path)</span>
<span id="cb17-1565"><a href="#cb17-1565" aria-hidden="true" tabindex="-1"></a>    <span class="co"># drop rows where correctness missing (should be rare, but safe)</span></span>
<span id="cb17-1566"><a href="#cb17-1566" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df[df[<span class="st">"correctness_score"</span>].notna()].copy()</span>
<span id="cb17-1567"><a href="#cb17-1567" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df.groupby(<span class="st">"question_type"</span>)[<span class="st">"correctness_score"</span>].mean()</span>
<span id="cb17-1568"><a href="#cb17-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1569"><a href="#cb17-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1570"><a href="#cb17-1570" aria-hidden="true" tabindex="-1"></a><span class="co"># --- UPDATE: Added 'evals/' prefix to all paths ---</span></span>
<span id="cb17-1571"><a href="#cb17-1571" aria-hidden="true" tabindex="-1"></a>qwen_4bit <span class="op">=</span> <span class="st">"evals/evaluation_results_qwen2.5_32b_SysG_v4_Reranked_FIXED_1766524393.jsonl"</span></span>
<span id="cb17-1572"><a href="#cb17-1572" aria-hidden="true" tabindex="-1"></a>qwen_2bit <span class="op">=</span> <span class="st">"evals/evaluation_results_qwen2.5_32b-instruct-q2_K_SysG_v4_Reranked_FIXED_1766368890.jsonl"</span></span>
<span id="cb17-1573"><a href="#cb17-1573" aria-hidden="true" tabindex="-1"></a>llama_4bit <span class="op">=</span> <span class="st">"evals/evaluation_results_llama3.1_70b_SysG_v4_Reranked_FIXED_1766501850.jsonl"</span></span>
<span id="cb17-1574"><a href="#cb17-1574" aria-hidden="true" tabindex="-1"></a>llama_2bit <span class="op">=</span> <span class="st">"evals/evaluation_results_llama3.1-70b-iq2_xs_SysG_v4_Reranked_FIXED_1766415472.jsonl"</span></span>
<span id="cb17-1575"><a href="#cb17-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1576"><a href="#cb17-1576" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute mean correctness by question type</span></span>
<span id="cb17-1577"><a href="#cb17-1577" aria-hidden="true" tabindex="-1"></a>qwen_4 <span class="op">=</span> mean_correctness_by_qtype(qwen_4bit)</span>
<span id="cb17-1578"><a href="#cb17-1578" aria-hidden="true" tabindex="-1"></a>qwen_2 <span class="op">=</span> mean_correctness_by_qtype(qwen_2bit)</span>
<span id="cb17-1579"><a href="#cb17-1579" aria-hidden="true" tabindex="-1"></a>llama_4 <span class="op">=</span> mean_correctness_by_qtype(llama_4bit)</span>
<span id="cb17-1580"><a href="#cb17-1580" aria-hidden="true" tabindex="-1"></a>llama_2 <span class="op">=</span> mean_correctness_by_qtype(llama_2bit)</span>
<span id="cb17-1581"><a href="#cb17-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1582"><a href="#cb17-1582" aria-hidden="true" tabindex="-1"></a><span class="co"># Union of question types present across files</span></span>
<span id="cb17-1583"><a href="#cb17-1583" aria-hidden="true" tabindex="-1"></a>qtypes <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(qwen_4.index) <span class="op">|</span> <span class="bu">set</span>(qwen_2.index) <span class="op">|</span> <span class="bu">set</span>(llama_4.index) <span class="op">|</span> <span class="bu">set</span>(llama_2.index))</span>
<span id="cb17-1584"><a href="#cb17-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1585"><a href="#cb17-1585" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: enforce a nicer order if you want it to match the article</span></span>
<span id="cb17-1586"><a href="#cb17-1586" aria-hidden="true" tabindex="-1"></a>preferred_order <span class="op">=</span> [<span class="st">"descriptive"</span>, <span class="st">"factual"</span>, <span class="st">"unanswerable"</span>, <span class="st">"contextual"</span>, <span class="st">"filter"</span>, <span class="st">"multi_hop"</span>]</span>
<span id="cb17-1587"><a href="#cb17-1587" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">set</span>(preferred_order).issubset(<span class="bu">set</span>(qtypes)):</span>
<span id="cb17-1588"><a href="#cb17-1588" aria-hidden="true" tabindex="-1"></a>    qtypes <span class="op">=</span> preferred_order</span>
<span id="cb17-1589"><a href="#cb17-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1590"><a href="#cb17-1590" aria-hidden="true" tabindex="-1"></a><span class="co"># Build degradation table: (2-bit - 4-bit) * 100 (percentage points)</span></span>
<span id="cb17-1591"><a href="#cb17-1591" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> []</span>
<span id="cb17-1592"><a href="#cb17-1592" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> qt <span class="kw">in</span> qtypes:</span>
<span id="cb17-1593"><a href="#cb17-1593" aria-hidden="true" tabindex="-1"></a>    rows.append({</span>
<span id="cb17-1594"><a href="#cb17-1594" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Question Type"</span>: qt.replace(<span class="st">"_"</span>, <span class="st">"-"</span>).title(),  <span class="co"># multi_hop -&gt; Multi-Hop</span></span>
<span id="cb17-1595"><a href="#cb17-1595" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Llama 70B"</span>: (llama_2.get(qt, np.nan) <span class="op">-</span> llama_4.get(qt, np.nan)) <span class="op">*</span> <span class="fl">100.0</span>,</span>
<span id="cb17-1596"><a href="#cb17-1596" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Qwen 32B"</span>:  (qwen_2.get(qt, np.nan)  <span class="op">-</span> qwen_4.get(qt, np.nan))  <span class="op">*</span> <span class="fl">100.0</span>,</span>
<span id="cb17-1597"><a href="#cb17-1597" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb17-1598"><a href="#cb17-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1599"><a href="#cb17-1599" aria-hidden="true" tabindex="-1"></a>df_deg <span class="op">=</span> pd.DataFrame(rows)</span>
<span id="cb17-1600"><a href="#cb17-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1601"><a href="#cb17-1601" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt for plotly</span></span>
<span id="cb17-1602"><a href="#cb17-1602" aria-hidden="true" tabindex="-1"></a>df_melted <span class="op">=</span> df_deg.melt(id_vars<span class="op">=</span><span class="st">"Question Type"</span>, var_name<span class="op">=</span><span class="st">"Model"</span>, value_name<span class="op">=</span><span class="st">"Degradation"</span>)</span>
<span id="cb17-1603"><a href="#cb17-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1604"><a href="#cb17-1604" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.bar(</span>
<span id="cb17-1605"><a href="#cb17-1605" aria-hidden="true" tabindex="-1"></a>    df_melted,</span>
<span id="cb17-1606"><a href="#cb17-1606" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">"Question Type"</span>,</span>
<span id="cb17-1607"><a href="#cb17-1607" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">"Degradation"</span>,</span>
<span id="cb17-1608"><a href="#cb17-1608" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">"Model"</span>,</span>
<span id="cb17-1609"><a href="#cb17-1609" aria-hidden="true" tabindex="-1"></a>    barmode<span class="op">=</span><span class="st">"group"</span>,</span>
<span id="cb17-1610"><a href="#cb17-1610" aria-hidden="true" tabindex="-1"></a>    color_discrete_map<span class="op">=</span>{<span class="st">"Llama 70B"</span>: <span class="st">"#C44E52"</span>, <span class="st">"Qwen 32B"</span>: <span class="st">"#55A868"</span>},</span>
<span id="cb17-1611"><a href="#cb17-1611" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb17-1612"><a href="#cb17-1612" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1613"><a href="#cb17-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1614"><a href="#cb17-1614" aria-hidden="true" tabindex="-1"></a>fig.add_hline(y<span class="op">=</span><span class="dv">0</span>, line_dash<span class="op">=</span><span class="st">"dash"</span>, line_color<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb17-1615"><a href="#cb17-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1616"><a href="#cb17-1616" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: automatically annotate the two biggest Llama drops (most negative pp)</span></span>
<span id="cb17-1617"><a href="#cb17-1617" aria-hidden="true" tabindex="-1"></a>llama_rows <span class="op">=</span> df_deg[[<span class="st">"Question Type"</span>, <span class="st">"Llama 70B"</span>]].dropna().sort_values(<span class="st">"Llama 70B"</span>).head(<span class="dv">2</span>)</span>
<span id="cb17-1618"><a href="#cb17-1618" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, r <span class="kw">in</span> llama_rows.iterrows():</span>
<span id="cb17-1619"><a href="#cb17-1619" aria-hidden="true" tabindex="-1"></a>    fig.add_annotation(</span>
<span id="cb17-1620"><a href="#cb17-1620" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>r[<span class="st">"Question Type"</span>],</span>
<span id="cb17-1621"><a href="#cb17-1621" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="bu">float</span>(r[<span class="st">"Llama 70B"</span>]),</span>
<span id="cb17-1622"><a href="#cb17-1622" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>r[<span class="st">'Llama 70B'</span>]<span class="sc">:+.0f}</span><span class="ss">pp"</span>,</span>
<span id="cb17-1623"><a href="#cb17-1623" aria-hidden="true" tabindex="-1"></a>        showarrow<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb17-1624"><a href="#cb17-1624" aria-hidden="true" tabindex="-1"></a>        font<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"red"</span>, size<span class="op">=</span><span class="dv">12</span>),</span>
<span id="cb17-1625"><a href="#cb17-1625" aria-hidden="true" tabindex="-1"></a>        yshift<span class="op">=-</span><span class="dv">10</span>,</span>
<span id="cb17-1626"><a href="#cb17-1626" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-1627"><a href="#cb17-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1628"><a href="#cb17-1628" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb17-1629"><a href="#cb17-1629" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"Performance Change (pp)"</span>,</span>
<span id="cb17-1630"><a href="#cb17-1630" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">550</span>,</span>
<span id="cb17-1631"><a href="#cb17-1631" aria-hidden="true" tabindex="-1"></a>    <span class="co"># MOBILE FIX:</span></span>
<span id="cb17-1632"><a href="#cb17-1632" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">30</span>, b<span class="op">=</span><span class="dv">100</span>),</span>
<span id="cb17-1633"><a href="#cb17-1633" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-1634"><a href="#cb17-1634" aria-hidden="true" tabindex="-1"></a>        orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb17-1635"><a href="#cb17-1635" aria-hidden="true" tabindex="-1"></a>        yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb17-1636"><a href="#cb17-1636" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=-</span><span class="fl">0.2</span>,</span>
<span id="cb17-1637"><a href="#cb17-1637" aria-hidden="true" tabindex="-1"></a>        xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb17-1638"><a href="#cb17-1638" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb17-1639"><a href="#cb17-1639" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-1640"><a href="#cb17-1640" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-1641"><a href="#cb17-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1642"><a href="#cb17-1642" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb17-1643"><a href="#cb17-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1644"><a href="#cb17-1644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-1645"><a href="#cb17-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1646"><a href="#cb17-1646" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-1647"><a href="#cb17-1647" aria-hidden="true" tabindex="-1"></a>**Figure 14**. Quantization vulnerability by question type. Llama catastrophically fails on descriptive and unanswerable questions.</span>
<span id="cb17-1648"><a href="#cb17-1648" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-1649"><a href="#cb17-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1650"><a href="#cb17-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1651"><a href="#cb17-1651" aria-hidden="true" tabindex="-1"></a>The most remarkably underperforming configuration across all experiments were those with System D paired with Llama 3.1 70B-IQ2. As discussed earlier, the degradation in System D using this LLM was hypothesized mainly to arise from the aggressive 2-bit quantization, which is generally understood to introduce calibration error and reduced numerical precision in attention and feed-forward layers of the transformer model. However, is that the whole explanation?</span>
<span id="cb17-1652"><a href="#cb17-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1653"><a href="#cb17-1653" aria-hidden="true" tabindex="-1"></a>To better isolate the effect of reduced quantization on the degradation of System D, a limited follow-up experiment was conducted using the 4-bit quantized variant of Llama 3.1 70B (the "default", and the version actually authored by Meta), together with System D and OpenAI-large embeddings, to compare with the 2-bit analog configuration. My local hardware couldn't hold this system entirely in VRAM, so CPU offloading was required and inference speeds went through the floor; however, the point of interest of this experiment wasn't speed, it was correctness. </span>
<span id="cb17-1654"><a href="#cb17-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1655"><a href="#cb17-1655" aria-hidden="true" tabindex="-1"></a>Moving from 2-bit to 4-bit quantization <span class="dt">&lt;</span><span class="kw">i</span><span class="dt">&gt;</span>did<span class="dt">&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span> result in an improvement in correctness for Llama 3.1 70B, but surprisingly not very much. See Figure 13. Because this would've been the largest LLM in the study, I was expecting correctness to be at or exceeding 70%, which was the apparent ceiling across all experiments in the study. However, it was 47.7% -- only a modest improvement from the performance at 2-bit (40.8%). This difference in performance was compared with the difference between the 4-bit and 2-bit versions of Qwen 2.5 32B, which was virtually non-existent (both at ~63%)  </span>
<span id="cb17-1656"><a href="#cb17-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1657"><a href="#cb17-1657" aria-hidden="true" tabindex="-1"></a>The difference in performance degradation between Llama 3.1 70B and Qwen 2.5 32B was striking. Why is there such a big difference? The different bit-widths certainly contributed to the performance differential in both cases, but this phenomenon alone was insufficient to explain the large performance drop for Llama 3.1 70B in System D. </span>
<span id="cb17-1658"><a href="#cb17-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1659"><a href="#cb17-1659" aria-hidden="true" tabindex="-1"></a>The difference in differences cannot be attributed solely to quantization. Instead, it is consistent with an interaction between model architecture, post-training quantization behavior, and the demands imposed by System D itself, which introduces several layers of control logic -- including iterative retrieval, semantic reranking, and document grading -- that amplify small errors in representation or calibration. In such settings, minor degradation at any single step can cascade into disproportionately large downstream failures.</span>
<span id="cb17-1660"><a href="#cb17-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1661"><a href="#cb17-1661" aria-hidden="true" tabindex="-1"></a>Notably, this effect appears to be architecture-sensitive. Despite its smaller parameter count, Qwen 2.5 32B exhibited substantially greater robustness under increased system complexity and aggressive quantization. This suggests that raw model size alone is not a sufficient predictor of stability in agentic retrieval settings. Instead, architectural characteristics -- such as attention behavior, token salience modeling, or sensitivity to distributional shift -- may play a decisive role.</span>
<span id="cb17-1662"><a href="#cb17-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1663"><a href="#cb17-1663" aria-hidden="true" tabindex="-1"></a>It is important to emphasize that Llama 3.1 70B-IQ2 is a community-quantized variant rather than a first-party Meta release. As such, these results should not be interpreted as definitive statements about the intrinsic capabilities of the base Llama 3.1 architecture. Rather, they highlight how quantization choices and architectural sensitivity can interact with system-level design decisions in non-obvious ways.</span>
<span id="cb17-1664"><a href="#cb17-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1665"><a href="#cb17-1665" aria-hidden="true" tabindex="-1"></a>To summarize, these findings suggest the existence of a fragility threshold in certain large models: beyond a particular level of system complexity, additional control mechanisms may no longer compensate for representational noise, and may instead exacerbate it. This has practical implications for practitioners seeking to deploy highly agentic RAG systems on constrained hardware. In such cases, smaller or more quantization-tolerant models may outperform larger counterparts, not despite their size, but because of their greater stability under iterative control.</span>
<span id="cb17-1666"><a href="#cb17-1666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1667"><a href="#cb17-1667" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusions</span></span>
<span id="cb17-1668"><a href="#cb17-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1669"><a href="#cb17-1669" aria-hidden="true" tabindex="-1"></a>If I were to design a production system for this database and these types of questions, these would be my recommendations: </span>
<span id="cb17-1670"><a href="#cb17-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1671"><a href="#cb17-1671" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**For Startups (budget-conscious):**</span>
<span id="cb17-1672"><a href="#cb17-1672" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**System:** C (Agentic)</span>
<span id="cb17-1673"><a href="#cb17-1673" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**LLM:** Gemini Flash</span>
<span id="cb17-1674"><a href="#cb17-1674" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Embedding:** Jina-v3</span>
<span id="cb17-1675"><a href="#cb17-1675" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Cost:** ~$0.0005/query</span>
<span id="cb17-1676"><a href="#cb17-1676" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Accuracy:** 70%</span>
<span id="cb17-1677"><a href="#cb17-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1678"><a href="#cb17-1678" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**For Enterprise (reliability-focused):**</span>
<span id="cb17-1679"><a href="#cb17-1679" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**System:** C (Agentic)</span>
<span id="cb17-1680"><a href="#cb17-1680" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**LLM:** GPT-4o</span>
<span id="cb17-1681"><a href="#cb17-1681" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Embedding:** OpenAI-large</span>
<span id="cb17-1682"><a href="#cb17-1682" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Cost:** ~$0.005/query</span>
<span id="cb17-1683"><a href="#cb17-1683" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Accuracy:** 70%</span>
<span id="cb17-1684"><a href="#cb17-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1685"><a href="#cb17-1685" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**For Local Deployment:**</span>
<span id="cb17-1686"><a href="#cb17-1686" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**System:** C (Agentic)</span>
<span id="cb17-1687"><a href="#cb17-1687" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**LLM:** Qwen 2.5 32B</span>
<span id="cb17-1688"><a href="#cb17-1688" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Embedding:** Jina-v3</span>
<span id="cb17-1689"><a href="#cb17-1689" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Cost:** $0 (after hardware)</span>
<span id="cb17-1690"><a href="#cb17-1690" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Accuracy:** 68%</span>
<span id="cb17-1691"><a href="#cb17-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1692"><a href="#cb17-1692" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**What to Avoid:**</span>
<span id="cb17-1693"><a href="#cb17-1693" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>System D (God Mode) — fragile and expensive</span>
<span id="cb17-1694"><a href="#cb17-1694" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>BGE-M3 embeddings — consistently underperform</span>
<span id="cb17-1695"><a href="#cb17-1695" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>2-bit quantization with any complex architecture</span>
<span id="cb17-1696"><a href="#cb17-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1697"><a href="#cb17-1697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1698"><a href="#cb17-1698" aria-hidden="true" tabindex="-1"></a>96 RAG configurations were assembled and tested using questions that could be answered with TV and movie data. The RAG architectures ranged from simple "naive" RAG to agentic systems that included reranking, iterative retrieval, and self-evaluation. The aim was to evaluate whether the complexity in RAG systems would correlate with performance. The tested configurations showed a ~70% peak correctness that was obtained most consistently by the agentic System C. On the other hand, the "God Mode" agentic System D exhibited high variance in performance -- it performed very well in some systems, but degraded sharply in others -- particularly with the aggressively quantized Llama 3.1 70B-IQ2.</span>
<span id="cb17-1699"><a href="#cb17-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1700"><a href="#cb17-1700" aria-hidden="true" tabindex="-1"></a>A lackluster performance by 2-bit models like Llama 3.1 70B-IQ2 is perhaps unsurprising. However, when investigating the effects of going from 4-bit to 2-bit, it was shown that the degradation for Llama 3.1 70B was markedly worse than for Qwen 2.5 32B. Therefore, performance appears to be shaped by a complex interplay between model architecture, quantization, and an error-amplifying effect of the complex System D pipeline.</span>
<span id="cb17-1701"><a href="#cb17-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1702"><a href="#cb17-1702" aria-hidden="true" tabindex="-1"></a>It should be noted that most aggressively quantized model -- Llama 3.1 70B-IQ2 -- is a community-produced release, rather than an official Meta release. Therefore, these results should not be interpreted as definitive judgments on the Llama architecture itself. Moreover, newer open-source models (e.g., Llama 3.3) were released after the completion of this study and not evaluated here. </span>
<span id="cb17-1703"><a href="#cb17-1703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1704"><a href="#cb17-1704" aria-hidden="true" tabindex="-1"></a>Altogether, these findings suggest that “more agentic” is not necessarily better. Moderately agentic designs such as System C appear to strike a favorable balance between retrieval quality, robustness, and cost. The accuracy/latency tradeoffs are summarized in Figure 15 for all systems. More complex pipelines may still be valuable in specific settings, but only in configurations with LLMs and embeddings of sufficient robustness. </span>
<span id="cb17-1705"><a href="#cb17-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1708"><a href="#cb17-1708" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-1709"><a href="#cb17-1709" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb17-1710"><a href="#cb17-1710" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-1711"><a href="#cb17-1711" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb17-1712"><a href="#cb17-1712" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb17-1713"><a href="#cb17-1713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1714"><a href="#cb17-1714" aria-hidden="true" tabindex="-1"></a><span class="co"># --- UPDATE: Point to evals subdirectory ---</span></span>
<span id="cb17-1715"><a href="#cb17-1715" aria-hidden="true" tabindex="-1"></a>EVALS_DIR <span class="op">=</span> <span class="st">"evals"</span></span>
<span id="cb17-1716"><a href="#cb17-1716" aria-hidden="true" tabindex="-1"></a>files <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> os.listdir(EVALS_DIR) <span class="cf">if</span> f.endswith(<span class="st">'.jsonl'</span>) <span class="kw">and</span> <span class="kw">not</span> <span class="st">'llama3.1_70b_SysG'</span> <span class="kw">in</span> f]</span>
<span id="cb17-1717"><a href="#cb17-1717" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb17-1718"><a href="#cb17-1718" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb17-1719"><a href="#cb17-1719" aria-hidden="true" tabindex="-1"></a>    <span class="co"># --- UPDATE: Join path with directory ---</span></span>
<span id="cb17-1720"><a href="#cb17-1720" aria-hidden="true" tabindex="-1"></a>    full_path <span class="op">=</span> os.path.join(EVALS_DIR, <span class="bu">file</span>)</span>
<span id="cb17-1721"><a href="#cb17-1721" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(full_path, <span class="st">'r'</span>,encoding<span class="op">=</span><span class="st">"utf-8"</span>, errors<span class="op">=</span><span class="st">"replace"</span>) <span class="im">as</span> f:</span>
<span id="cb17-1722"><a href="#cb17-1722" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb17-1723"><a href="#cb17-1723" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb17-1724"><a href="#cb17-1724" aria-hidden="true" tabindex="-1"></a>                data.append(json.loads(line))</span>
<span id="cb17-1725"><a href="#cb17-1725" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb17-1726"><a href="#cb17-1726" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb17-1727"><a href="#cb17-1727" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb17-1728"><a href="#cb17-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1729"><a href="#cb17-1729" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_sys_name(name):</span>
<span id="cb17-1730"><a href="#cb17-1730" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(name, <span class="bu">str</span>): <span class="cf">return</span> <span class="bu">str</span>(name)</span>
<span id="cb17-1731"><a href="#cb17-1731" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysA"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System A (Naive)"</span></span>
<span id="cb17-1732"><a href="#cb17-1732" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysC"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System B (Hybrid)"</span></span>
<span id="cb17-1733"><a href="#cb17-1733" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysD"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System C (Agentic)"</span></span>
<span id="cb17-1734"><a href="#cb17-1734" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"SysG"</span> <span class="kw">in</span> name: <span class="cf">return</span> <span class="st">"System D (God Mode)"</span></span>
<span id="cb17-1735"><a href="#cb17-1735" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> name</span>
<span id="cb17-1736"><a href="#cb17-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1737"><a href="#cb17-1737" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> df.empty <span class="kw">and</span> <span class="st">'experiment_name'</span> <span class="kw">in</span> df.columns:</span>
<span id="cb17-1738"><a href="#cb17-1738" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'System'</span>] <span class="op">=</span> df[<span class="st">'experiment_name'</span>].<span class="bu">apply</span>(clean_sys_name)</span>
<span id="cb17-1739"><a href="#cb17-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1740"><a href="#cb17-1740" aria-hidden="true" tabindex="-1"></a>    agg_df <span class="op">=</span> df.groupby(<span class="st">'System'</span>).agg({</span>
<span id="cb17-1741"><a href="#cb17-1741" aria-hidden="true" tabindex="-1"></a>        <span class="st">'correctness_score'</span>: <span class="st">'mean'</span>,</span>
<span id="cb17-1742"><a href="#cb17-1742" aria-hidden="true" tabindex="-1"></a>        <span class="st">'faithfulness_score'</span>: <span class="st">'mean'</span>,</span>
<span id="cb17-1743"><a href="#cb17-1743" aria-hidden="true" tabindex="-1"></a>        <span class="st">'latency_ms'</span>: <span class="st">'mean'</span>,</span>
<span id="cb17-1744"><a href="#cb17-1744" aria-hidden="true" tabindex="-1"></a>        <span class="st">'main_total_tokens'</span>: <span class="st">'mean'</span></span>
<span id="cb17-1745"><a href="#cb17-1745" aria-hidden="true" tabindex="-1"></a>    }).reset_index()</span>
<span id="cb17-1746"><a href="#cb17-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1747"><a href="#cb17-1747" aria-hidden="true" tabindex="-1"></a>    reasoning_df <span class="op">=</span> df[df[<span class="st">'question_type'</span>].isin([<span class="st">'filter'</span>, <span class="st">'multi_hop'</span>, <span class="st">'contextual'</span>])]</span>
<span id="cb17-1748"><a href="#cb17-1748" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> reasoning_df.empty:</span>
<span id="cb17-1749"><a href="#cb17-1749" aria-hidden="true" tabindex="-1"></a>        r_score <span class="op">=</span> reasoning_df.groupby(<span class="st">'System'</span>)[<span class="st">'correctness_score'</span>].mean().reset_index()</span>
<span id="cb17-1750"><a href="#cb17-1750" aria-hidden="true" tabindex="-1"></a>        agg_df <span class="op">=</span> pd.merge(agg_df, r_score.rename(columns<span class="op">=</span>{<span class="st">'correctness_score'</span>: <span class="st">'reasoning_score'</span>}), on<span class="op">=</span><span class="st">'System'</span>)</span>
<span id="cb17-1751"><a href="#cb17-1751" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb17-1752"><a href="#cb17-1752" aria-hidden="true" tabindex="-1"></a>        agg_df[<span class="st">'reasoning_score'</span>] <span class="op">=</span> agg_df[<span class="st">'correctness_score'</span>]</span>
<span id="cb17-1753"><a href="#cb17-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1754"><a href="#cb17-1754" aria-hidden="true" tabindex="-1"></a>    agg_df[<span class="st">'Intelligence'</span>] <span class="op">=</span> ((agg_df[<span class="st">'correctness_score'</span>] <span class="op">+</span> agg_df[<span class="st">'reasoning_score'</span>]) <span class="op">/</span> <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-1755"><a href="#cb17-1755" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-1756"><a href="#cb17-1756" aria-hidden="true" tabindex="-1"></a>    max_lat <span class="op">=</span> agg_df[<span class="st">'latency_ms'</span>].<span class="bu">max</span>()</span>
<span id="cb17-1757"><a href="#cb17-1757" aria-hidden="true" tabindex="-1"></a>    max_tok <span class="op">=</span> agg_df[<span class="st">'main_total_tokens'</span>].<span class="bu">max</span>()</span>
<span id="cb17-1758"><a href="#cb17-1758" aria-hidden="true" tabindex="-1"></a>    agg_df[<span class="st">'Efficiency'</span>] <span class="op">=</span> (((<span class="dv">1</span> <span class="op">-</span> agg_df[<span class="st">'latency_ms'</span>]<span class="op">/</span>max_lat) <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> agg_df[<span class="st">'main_total_tokens'</span>]<span class="op">/</span>max_tok)) <span class="op">/</span> <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-1759"><a href="#cb17-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1760"><a href="#cb17-1760" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_size(sys_name):</span>
<span id="cb17-1761"><a href="#cb17-1761" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"System C"</span> <span class="kw">in</span> sys_name: <span class="cf">return</span> <span class="dv">45</span></span>
<span id="cb17-1762"><a href="#cb17-1762" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">30</span></span>
<span id="cb17-1763"><a href="#cb17-1763" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-1764"><a href="#cb17-1764" aria-hidden="true" tabindex="-1"></a>    agg_df[<span class="st">'MarkerSize'</span>] <span class="op">=</span> agg_df[<span class="st">'System'</span>].<span class="bu">apply</span>(get_size)</span>
<span id="cb17-1765"><a href="#cb17-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1766"><a href="#cb17-1766" aria-hidden="true" tabindex="-1"></a>    fig_quad <span class="op">=</span> px.scatter(</span>
<span id="cb17-1767"><a href="#cb17-1767" aria-hidden="true" tabindex="-1"></a>        agg_df,</span>
<span id="cb17-1768"><a href="#cb17-1768" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"Efficiency"</span>,</span>
<span id="cb17-1769"><a href="#cb17-1769" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">"Intelligence"</span>,</span>
<span id="cb17-1770"><a href="#cb17-1770" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"System"</span>,</span>
<span id="cb17-1771"><a href="#cb17-1771" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span><span class="st">"MarkerSize"</span>,</span>
<span id="cb17-1772"><a href="#cb17-1772" aria-hidden="true" tabindex="-1"></a>        text<span class="op">=</span><span class="st">"System"</span>,</span>
<span id="cb17-1773"><a href="#cb17-1773" aria-hidden="true" tabindex="-1"></a>        template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb17-1774"><a href="#cb17-1774" aria-hidden="true" tabindex="-1"></a>        color_discrete_map<span class="op">=</span>{</span>
<span id="cb17-1775"><a href="#cb17-1775" aria-hidden="true" tabindex="-1"></a>            <span class="st">"System A (Naive)"</span>: <span class="st">"#4C72B0"</span>,</span>
<span id="cb17-1776"><a href="#cb17-1776" aria-hidden="true" tabindex="-1"></a>            <span class="st">"System B (Hybrid)"</span>: <span class="st">"#DD8452"</span>,</span>
<span id="cb17-1777"><a href="#cb17-1777" aria-hidden="true" tabindex="-1"></a>            <span class="st">"System C (Agentic)"</span>: <span class="st">"#55A868"</span>,</span>
<span id="cb17-1778"><a href="#cb17-1778" aria-hidden="true" tabindex="-1"></a>            <span class="st">"System D (God Mode)"</span>: <span class="st">"#C44E52"</span></span>
<span id="cb17-1779"><a href="#cb17-1779" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1780"><a href="#cb17-1780" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-1781"><a href="#cb17-1781" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-1782"><a href="#cb17-1782" aria-hidden="true" tabindex="-1"></a>    mean_int <span class="op">=</span> agg_df[<span class="st">'Intelligence'</span>].mean()</span>
<span id="cb17-1783"><a href="#cb17-1783" aria-hidden="true" tabindex="-1"></a>    mean_eff <span class="op">=</span> agg_df[<span class="st">'Efficiency'</span>].mean()</span>
<span id="cb17-1784"><a href="#cb17-1784" aria-hidden="true" tabindex="-1"></a>    fig_quad.add_hline(y<span class="op">=</span>mean_int, line_width<span class="op">=</span><span class="dv">1</span>, line_dash<span class="op">=</span><span class="st">"dash"</span>, line_color<span class="op">=</span><span class="st">"grey"</span>)</span>
<span id="cb17-1785"><a href="#cb17-1785" aria-hidden="true" tabindex="-1"></a>    fig_quad.add_vline(x<span class="op">=</span>mean_eff, line_width<span class="op">=</span><span class="dv">1</span>, line_dash<span class="op">=</span><span class="st">"dash"</span>, line_color<span class="op">=</span><span class="st">"grey"</span>)</span>
<span id="cb17-1786"><a href="#cb17-1786" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-1787"><a href="#cb17-1787" aria-hidden="true" tabindex="-1"></a>    x_min, x_max <span class="op">=</span> agg_df[<span class="st">'Efficiency'</span>].<span class="bu">min</span>(), agg_df[<span class="st">'Efficiency'</span>].<span class="bu">max</span>()</span>
<span id="cb17-1788"><a href="#cb17-1788" aria-hidden="true" tabindex="-1"></a>    y_min, y_max <span class="op">=</span> agg_df[<span class="st">'Intelligence'</span>].<span class="bu">min</span>(), agg_df[<span class="st">'Intelligence'</span>].<span class="bu">max</span>()</span>
<span id="cb17-1789"><a href="#cb17-1789" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-1790"><a href="#cb17-1790" aria-hidden="true" tabindex="-1"></a>    x_range <span class="op">=</span> x_max <span class="op">-</span> x_min</span>
<span id="cb17-1791"><a href="#cb17-1791" aria-hidden="true" tabindex="-1"></a>    y_range <span class="op">=</span> y_max <span class="op">-</span> y_min</span>
<span id="cb17-1792"><a href="#cb17-1792" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-1793"><a href="#cb17-1793" aria-hidden="true" tabindex="-1"></a>    fig_quad.add_annotation(x<span class="op">=</span>(x_max<span class="op">-</span>x_max<span class="op">*</span><span class="fl">0.093</span>), y<span class="op">=</span>(y_max<span class="op">-</span><span class="fl">0.014</span><span class="op">*</span>y_max), text<span class="op">=</span><span class="st">"&lt;b&gt;The Ideal State&lt;/b&gt;"</span>, showarrow<span class="op">=</span><span class="va">False</span>, font<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"green"</span>, size<span class="op">=</span><span class="dv">12</span>))</span>
<span id="cb17-1794"><a href="#cb17-1794" aria-hidden="true" tabindex="-1"></a>    fig_quad.add_annotation(x<span class="op">=</span>x_min, y<span class="op">=</span>y_min, text<span class="op">=</span><span class="st">"&lt;b&gt;Low Value&lt;/b&gt;"</span>, showarrow<span class="op">=</span><span class="va">False</span>, font<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">"red"</span>, size<span class="op">=</span><span class="dv">12</span>))</span>
<span id="cb17-1795"><a href="#cb17-1795" aria-hidden="true" tabindex="-1"></a>    fig_quad.add_annotation(x<span class="op">=</span>(x_max<span class="op">-</span>x_max<span class="op">*</span><span class="fl">0.0093</span>), y<span class="op">=</span>(y_min<span class="op">-</span><span class="fl">0.012</span><span class="op">*</span>y_min), text<span class="op">=</span><span class="st">"&lt;b&gt;Fast but Dumb&lt;/b&gt;"</span>, showarrow<span class="op">=</span><span class="va">False</span>, font<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>))</span>
<span id="cb17-1796"><a href="#cb17-1796" aria-hidden="true" tabindex="-1"></a>    fig_quad.add_annotation(x<span class="op">=</span>x_min, y<span class="op">=</span>y_max, text<span class="op">=</span><span class="st">"&lt;b&gt;Smart but Slow&lt;/b&gt;"</span>, showarrow<span class="op">=</span><span class="va">False</span>, font<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>))</span>
<span id="cb17-1797"><a href="#cb17-1797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1798"><a href="#cb17-1798" aria-hidden="true" tabindex="-1"></a>    fig_quad.update_traces(textposition<span class="op">=</span><span class="st">'top center'</span>)</span>
<span id="cb17-1799"><a href="#cb17-1799" aria-hidden="true" tabindex="-1"></a>    fig_quad.update_layout(</span>
<span id="cb17-1800"><a href="#cb17-1800" aria-hidden="true" tabindex="-1"></a>        xaxis_title<span class="op">=</span><span class="st">"Efficiency Score (Speed + Low Cost)"</span>,</span>
<span id="cb17-1801"><a href="#cb17-1801" aria-hidden="true" tabindex="-1"></a>        yaxis_title<span class="op">=</span><span class="st">"Intelligence Score (Reasoning + Accuracy)"</span>,</span>
<span id="cb17-1802"><a href="#cb17-1802" aria-hidden="true" tabindex="-1"></a>        showlegend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb17-1803"><a href="#cb17-1803" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span><span class="dv">600</span>,</span>
<span id="cb17-1804"><a href="#cb17-1804" aria-hidden="true" tabindex="-1"></a>        xaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[x_min <span class="op">-</span> x_range<span class="op">*</span><span class="fl">0.2</span>, x_max <span class="op">+</span> x_range<span class="op">*</span><span class="fl">0.2</span>]),</span>
<span id="cb17-1805"><a href="#cb17-1805" aria-hidden="true" tabindex="-1"></a>        yaxis<span class="op">=</span><span class="bu">dict</span>(<span class="bu">range</span><span class="op">=</span>[y_min <span class="op">-</span> y_range<span class="op">*</span><span class="fl">0.2</span>, y_max <span class="op">+</span> y_range<span class="op">*</span><span class="fl">0.2</span>]),</span>
<span id="cb17-1806"><a href="#cb17-1806" aria-hidden="true" tabindex="-1"></a>        <span class="co"># MOBILE FIX: Slightly larger T/B margins for the text annotations</span></span>
<span id="cb17-1807"><a href="#cb17-1807" aria-hidden="true" tabindex="-1"></a>        margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">10</span>, r<span class="op">=</span><span class="dv">10</span>, t<span class="op">=</span><span class="dv">40</span>, b<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb17-1808"><a href="#cb17-1808" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-1809"><a href="#cb17-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1810"><a href="#cb17-1810" aria-hidden="true" tabindex="-1"></a>    fig_quad.show()</span>
<span id="cb17-1811"><a href="#cb17-1811" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb17-1812"><a href="#cb17-1812" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"DataFrame empty or missing columns."</span>)</span>
<span id="cb17-1813"><a href="#cb17-1813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-1814"><a href="#cb17-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1815"><a href="#cb17-1815" aria-hidden="true" tabindex="-1"></a>::: {.fig-caption}</span>
<span id="cb17-1816"><a href="#cb17-1816" aria-hidden="true" tabindex="-1"></a>**Figure 15**. The RAG architecture quadrant plotting intelligence versus efficiency. System C (Agentic) achieves the optimal position.</span>
<span id="cb17-1817"><a href="#cb17-1817" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<hr>
<div class="d-flex justify-content-between small text-muted">
  <div>© Trevor Seguin</div>
  <div>
    <a href="https://github.com/tseguin715/rag-complexity-paradox">Repo</a> ·
    <a href="https://www.linkedin.com/in/trevor-seguin">LinkedIn</a> ·
    <a href="mailto:tseguin715@gmail.com">Email</a>
  </div>
</div>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="index_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>